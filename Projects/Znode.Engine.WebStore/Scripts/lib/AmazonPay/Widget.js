// create OffAmazonPayments Widgets namespace
if (!OffAmazonPayments || typeof (OffAmazonPayments) == "undefined") {
    var OffAmazonPayments = {}; // Make sure the base namespace exists
}
// store time when we start processing our first JS
OffAmazonPayments.ZERO_TIME = (new Date()).getTime();
// zero time marker
try { window.performance.mark('apay-t0'); } catch (e) { }

/*
    http://www.JSON.org/json2.js
    2010-03-20
    Public Domain.
    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
    See http://www.JSON.org/js.html
*/

if (typeof JSON !== 'object') { JSON = {} } (function () { 'use strict'; function f(n) { return n < 10 ? '0' + n : n } if (typeof Date.prototype.toJSON !== 'function') { Date.prototype.toJSON = function () { return isFinite(this.valueOf()) ? this.getUTCFullYear() + '-' + f(this.getUTCMonth() + 1) + '-' + f(this.getUTCDate()) + 'T' + f(this.getUTCHours()) + ':' + f(this.getUTCMinutes()) + ':' + f(this.getUTCSeconds()) + 'Z' : null }; String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () { return this.valueOf() } } var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { '\b': '\\b', '\t': '\\t', '\n': '\\n', '\f': '\\f', '\r': '\\r', '"': '\\"', '\\': '\\\\' }, rep; function quote(string) { escapable.lastIndex = 0; return escapable.test(string) ? '"' + string.replace(escapable, function (a) { var c = meta[a]; return typeof c === 'string' ? c : '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + string + '"' } function str(key, holder) { var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === 'object' && typeof value.toJSON === 'function') { value = value.toJSON(key) } if (typeof rep === 'function') { value = rep.call(holder, key, value) } switch (typeof value) { case 'string': return quote(value); case 'number': return isFinite(value) ? String(value) : 'null'; case 'boolean': case 'null': return String(value); case 'object': if (!value) { return 'null' } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === '[object Array]') { length = value.length; for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || 'null' } v = partial.length === 0 ? '[]' : gap ? '[\n' + gap + partial.join(',\n' + gap) + '\n' + mind + ']' : '[' + partial.join(',') + ']'; gap = mind; return v } if (rep && typeof rep === 'object') { length = rep.length; for (i = 0; i < length; i += 1) { if (typeof rep[i] === 'string') { k = rep[i]; v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ': ' : ':') + v) } } } } else { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ': ' : ':') + v) } } } } v = partial.length === 0 ? '{}' : gap ? '{\n' + gap + partial.join(',\n' + gap) + '\n' + mind + '}' : '{' + partial.join(',') + '}'; gap = mind; return v } } if (typeof JSON.stringify !== 'function') { JSON.stringify = function (value, replacer, space) { var i; gap = ''; indent = ''; if (typeof space === 'number') { for (i = 0; i < space; i += 1) { indent += ' ' } } else if (typeof space === 'string') { indent = space } rep = replacer; if (replacer && typeof replacer !== 'function' && (typeof replacer !== 'object' || typeof replacer.length !== 'number')) { throw new Error('JSON.stringify') } return str('', { '': value }) } } if (typeof JSON.parse !== 'function') { JSON.parse = function (text, reviver) { var j; function walk(holder, key) { var k, v, value = holder[key]; if (value && typeof value === 'object') { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = walk(value, k); if (v !== undefined) { value[k] = v } else { delete value[k] } } } } return reviver.call(holder, key, value) } text = String(text); cx.lastIndex = 0; if (cx.test(text)) { text = text.replace(cx, function (a) { return '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4) }) } if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) { j = eval('(' + text + ')'); return typeof reviver === 'function' ? walk({ '': j }, '') : j } throw new SyntaxError('JSON.parse') } } }());
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

/*!
 * jQuery JavaScript Library v1.4.2
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Sat Feb 13 22:33:48 2010 -0500
 */
(function (aO, I) { function a0() { if (!ai.isReady) { try { M.documentElement.doScroll("left") } catch (c) { setTimeout(a0, 1); return } ai.ready() } } function E(s, c) { c.src ? ai.ajax({ url: c.src, async: false, dataType: "script" }) : ai.globalEval(c.text || c.textContent || c.innerHTML || ""); c.parentNode && c.parentNode.removeChild(c) } function ap(s, c, K, F, G, w) { var A = s.length; if (typeof c === "object") { for (var J in c) { ap(s, J, c[J], F, G, K) } return s } if (K !== I) { F = !w && F && ai.isFunction(K); for (J = 0; J < A; J++) { G(s[J], c, F ? K.call(s[J], J, G(s[J], c)) : K, w) } return s } return A ? G(s[0], c) : I } function aF() { return (new Date).getTime() } function an() { return false } function am() { return true } function aK(s, c, w) { w[0].type = s; return ai.event.handle.apply(c, w) } function ag(O) { var N, L = [], J = [], K = arguments, F, G, s, A, w, c; G = ai.data(this, "events"); if (!(O.liveFired === this || !G || !G.live || O.button && O.type === "click")) { O.liveFired = this; var P = G.live.slice(0); for (A = 0; A < P.length; A++) { G = P[A]; G.origType.replace(ay, "") === O.type ? J.push(G.selector) : P.splice(A--, 1) } F = ai(O.target).closest(J, O.currentTarget); w = 0; for (c = F.length; w < c; w++) { for (A = 0; A < P.length; A++) { G = P[A]; if (F[w].selector === G.selector) { s = F[w].elem; J = null; if (G.preType === "mouseenter" || G.preType === "mouseleave") { J = ai(O.relatedTarget).closest(G.selector)[0] } if (!J || J !== s) { L.push({ elem: s, handleObj: G }) } } } } w = 0; for (c = L.length; w < c; w++) { F = L[w]; O.currentTarget = F.elem; O.data = F.handleObj.data; O.handleObj = F.handleObj; if (F.handleObj.origHandler.apply(F.elem, K) === false) { N = false; break } } return N } } function z(s, c) { return "live." + (s && s !== "*" ? s + "." : "") + c.replace(/\./g, "`").replace(/ /g, "&") } function l(c) { return !c || !c.parentNode || c.parentNode.nodeType === 11 } function bj(s, c) { var w = 0; c.each(function () { if (this.nodeName === (s[w] && s[w].nodeName)) { var G = ai.data(s[w++]), J = ai.data(this, G); if (G = G && G.events) { delete J.handle; J.events = {}; for (var A in G) { for (var F in G[A]) { ai.event.add(this, A, G[A][F], G[A][F].data) } } } } }) } function a3(s, c, G) { var A, F, w; c = c && c[0] ? c[0].ownerDocument || c[0] : M; if (s.length === 1 && typeof s[0] === "string" && s[0].length < 512 && c === M && !aP.test(s[0]) && (ai.support.checkClone || !ak.test(s[0]))) { F = true; if (w = ai.fragments[s[0]]) { if (w !== 1) { A = w } } } if (!A) { A = c.createDocumentFragment(); ai.clean(s, c, A, G) } if (F) { ai.fragments[s[0]] = w ? A : 1 } return { fragment: A, cacheable: F } } function aD(s, c) { var w = {}; ai.each(D.concat.apply([], D.slice(0, c)), function () { w[this] = s }); return w } function o(c) { return "scrollTo" in c && c.document ? c : c.nodeType === 9 ? c.defaultView || c.parentWindow : false } var ai = function (s, c) { return new ai.fn.init(s, c) }, p = aO.jQuery, d = aO.$, M = aO.document, at, a7 = /^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/, aT = /^.[^:#\[\.,]*$/, ao = /\S/, H = /^(\s|\u00A0)+|(\s|\u00A0)+$/g, q = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, aw = navigator.userAgent, b = false, av = [], aB, a1 = Object.prototype.toString, aV = Object.prototype.hasOwnProperty, az = Array.prototype.push, au = Array.prototype.slice, a6 = Array.prototype.indexOf; ai.fn = ai.prototype = { init: function (s, c) { var A, w; if (!s) { return this } if (s.nodeType) { this.context = this[0] = s; this.length = 1; return this } if (s === "body" && !c) { this.context = M; this[0] = M.body; this.selector = "body"; this.length = 1; return this } if (typeof s === "string") { if ((A = a7.exec(s)) && (A[1] || !c)) { if (A[1]) { w = c ? c.ownerDocument || c : M; if (s = q.exec(s)) { if (ai.isPlainObject(c)) { s = [M.createElement(s[1])]; ai.fn.attr.call(s, c, true) } else { s = [w.createElement(s[1])] } } else { s = a3([A[1]], [w]); s = (s.cacheable ? s.fragment.cloneNode(true) : s.fragment).childNodes } return ai.merge(this, s) } else { if (c = M.getElementById(A[2])) { if (c.id !== A[2]) { return at.find(s) } this.length = 1; this[0] = c } this.context = M; this.selector = s; return this } } else { if (!c && /^\w+$/.test(s)) { this.selector = s; this.context = M; s = M.getElementsByTagName(s); return ai.merge(this, s) } else { return !c || c.jquery ? (c || at).find(s) : ai(c).find(s) } } } else { if (ai.isFunction(s)) { return at.ready(s) } } if (s.selector !== I) { this.selector = s.selector; this.context = s.context } return ai.makeArray(s, this) }, selector: "", jquery: "1.4.2", length: 0, size: function () { return this.length }, toArray: function () { return au.call(this, 0) }, get: function (c) { return c == null ? this.toArray() : c < 0 ? this.slice(c)[0] : this[c] }, pushStack: function (s, c, A) { var w = ai(); ai.isArray(s) ? az.apply(w, s) : ai.merge(w, s); w.prevObject = this; w.context = this.context; if (c === "find") { w.selector = this.selector + (this.selector ? " " : "") + A } else { if (c) { w.selector = this.selector + "." + c + "(" + A + ")" } } return w }, each: function (s, c) { return ai.each(this, s, c) }, ready: function (c) { ai.bindReady(); if (ai.isReady) { c.call(M, ai) } else { av && av.push(c) } return this }, eq: function (c) { return c === -1 ? this.slice(c) : this.slice(c, +c + 1) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, slice: function () { return this.pushStack(au.apply(this, arguments), "slice", au.call(arguments).join(",")) }, map: function (c) { return this.pushStack(ai.map(this, function (s, w) { return c.call(s, w, s) })) }, end: function () { return this.prevObject || ai(null) }, push: az, sort: [].sort, splice: [].splice }; ai.fn.init.prototype = ai.fn; ai.extend = ai.fn.extend = function () { var s = arguments[0] || {}, c = 1, K = arguments.length, F = false, G, w, A, J; if (typeof s === "boolean") { F = s; s = arguments[1] || {}; c = 2 } if (typeof s !== "object" && !ai.isFunction(s)) { s = {} } if (K === c) { s = this; --c } for (; c < K; c++) { if ((G = arguments[c]) != null) { for (w in G) { A = s[w]; J = G[w]; if (s !== J) { if (F && J && (ai.isPlainObject(J) || ai.isArray(J))) { A = A && (ai.isPlainObject(A) || ai.isArray(A)) ? A : ai.isArray(J) ? [] : {}; s[w] = ai.extend(F, A, J) } else { if (J !== I) { s[w] = J } } } } } } return s }; ai.extend({ noConflict: function (c) { aO.$ = d; if (c) { aO.jQuery = p } return ai }, isReady: false, ready: function () { if (!ai.isReady) { if (!M.body) { return setTimeout(ai.ready, 13) } ai.isReady = true; if (av) { for (var s, c = 0; s = av[c++];) { s.call(M, ai) } av = null } ai.fn.triggerHandler && ai(M).triggerHandler("ready") } }, bindReady: function () { if (!b) { b = true; if (M.readyState === "complete") { return ai.ready() } if (M.addEventListener) { M.addEventListener("DOMContentLoaded", aB, false); aO.addEventListener("load", ai.ready, false) } else { if (M.attachEvent) { M.attachEvent("onreadystatechange", aB); aO.attachEvent("onload", ai.ready); var s = false; try { s = aO.frameElement == null } catch (c) { } M.documentElement.doScroll && s && a0() } } } }, isFunction: function (c) { return a1.call(c) === "[object Function]" }, isArray: function (c) { return a1.call(c) === "[object Array]" }, isPlainObject: function (s) { if (!s || a1.call(s) !== "[object Object]" || s.nodeType || s.setInterval) { return false } if (s.constructor && !aV.call(s, "constructor") && !aV.call(s.constructor.prototype, "isPrototypeOf")) { return false } var c; for (c in s) { } return c === I || aV.call(s, c) }, isEmptyObject: function (s) { for (var c in s) { return false } return true }, error: function (c) { throw c }, parseJSON: function (c) { if (typeof c !== "string" || !c) { return null } c = ai.trim(c); if (/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) { return aO.JSON && aO.JSON.parse ? aO.JSON.parse(c) : (new Function("return " + c))() } else { ai.error("Invalid JSON: " + c) } }, noop: function () { }, globalEval: function (s) { if (s && ao.test(s)) { var c = M.getElementsByTagName("head")[0] || M.documentElement, w = M.createElement("script"); w.type = "text/javascript"; if (ai.support.scriptEval) { w.appendChild(M.createTextNode(s)) } else { w.text = s } c.insertBefore(w, c.firstChild); c.removeChild(w) } }, nodeName: function (s, c) { return s.nodeName && s.nodeName.toUpperCase() === c.toUpperCase() }, each: function (s, c, J) { var F, G = 0, w = s.length, A = w === I || ai.isFunction(s); if (J) { if (A) { for (F in s) { if (c.apply(s[F], J) === false) { break } } } else { for (; G < w;) { if (c.apply(s[G++], J) === false) { break } } } } else { if (A) { for (F in s) { if (c.call(s[F], F, s[F]) === false) { break } } } else { for (J = s[0]; G < w && c.call(J, G, J) !== false; J = s[++G]) { } } } return s }, trim: function (c) { return (c || "").replace(H, "") }, makeArray: function (s, c) { c = c || []; if (s != null) { s.length == null || typeof s === "string" || ai.isFunction(s) || typeof s !== "function" && s.setInterval ? az.call(c, s) : ai.merge(c, s) } return c }, inArray: function (s, c) { if (c.indexOf) { return c.indexOf(s) } for (var A = 0, w = c.length; A < w; A++) { if (c[A] === s) { return A } } return -1 }, merge: function (s, c) { var F = s.length, w = 0; if (typeof c.length === "number") { for (var A = c.length; w < A; w++) { s[F++] = c[w] } } else { for (; c[w] !== I;) { s[F++] = c[w++] } } s.length = F; return s }, grep: function (s, c, G) { for (var A = [], F = 0, w = s.length; F < w; F++) { !G !== !c(s[F], F) && A.push(s[F]) } return A }, map: function (s, c, J) { for (var F = [], G, w = 0, A = s.length; w < A; w++) { G = c(s[w], w, J); if (G != null) { F[F.length] = G } } return F.concat.apply([], F) }, guid: 1, proxy: function (s, c, w) { if (arguments.length === 2) { if (typeof c === "string") { w = s; s = w[c]; c = I } else { if (c && !ai.isFunction(c)) { w = c; c = I } } } if (!c && s) { c = function () { return s.apply(w || this, arguments) } } if (s) { c.guid = s.guid = s.guid || c.guid || ai.guid++ } return c }, uaMatch: function (c) { c = c.toLowerCase(); c = /(webkit)[ \/]([\w.]+)/.exec(c) || /(opera)(?:.*version)?[ \/]([\w.]+)/.exec(c) || /(msie) ([\w.]+)/.exec(c) || !/compatible/.test(c) && /(mozilla)(?:.*? rv:([\w.]+))?/.exec(c) || []; return { browser: c[1] || "", version: c[2] || "0" } }, browser: {} }); aw = ai.uaMatch(aw); if (aw.browser) { ai.browser[aw.browser] = true; ai.browser.version = aw.version } if (ai.browser.webkit) { ai.browser.safari = true } if (a6) { ai.inArray = function (s, c) { return a6.call(c, s) } } at = ai(M); if (M.addEventListener) { aB = function () { M.removeEventListener("DOMContentLoaded", aB, false); ai.ready() } } else { if (M.attachEvent) { aB = function () { if (M.readyState === "complete") { M.detachEvent("onreadystatechange", aB); ai.ready() } } } } (function () { ai.support = {}; var L = M.documentElement, K = M.createElement("script"), J = M.createElement("div"), F = "script" + aF(); J.style.display = "none"; J.innerHTML = "   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>"; var G = J.getElementsByTagName("*"), w = J.getElementsByTagName("a")[0]; if (!(!G || !G.length || !w)) { ai.support = { leadingWhitespace: J.firstChild.nodeType === 3, tbody: !J.getElementsByTagName("tbody").length, htmlSerialize: !!J.getElementsByTagName("link").length, style: /red/.test(w.getAttribute("style")), hrefNormalized: w.getAttribute("href") === "/a", opacity: /^0.55$/.test(w.style.opacity), cssFloat: !!w.style.cssFloat, checkOn: J.getElementsByTagName("input")[0].value === "on", optSelected: M.createElement("select").appendChild(M.createElement("option")).selected, parentNode: J.removeChild(J.appendChild(M.createElement("div"))).parentNode === null, deleteExpando: true, checkClone: false, scriptEval: false, noCloneEvent: true, boxModel: null }; K.type = "text/javascript"; try { K.appendChild(M.createTextNode("window." + F + "=1;")) } catch (A) { } L.insertBefore(K, L.firstChild); if (aO[F]) { ai.support.scriptEval = true; delete aO[F] } try { delete K.test } catch (c) { ai.support.deleteExpando = false } L.removeChild(K); if (J.attachEvent && J.fireEvent) { J.attachEvent("onclick", function s() { ai.support.noCloneEvent = false; J.detachEvent("onclick", s) }); J.cloneNode(true).fireEvent("onclick") } J = M.createElement("div"); J.innerHTML = "<input type='radio' name='radiotest' checked='checked'/>"; L = M.createDocumentFragment(); L.appendChild(J.firstChild); ai.support.checkClone = L.cloneNode(true).cloneNode(true).lastChild.checked; ai(function () { var N = M.createElement("div"); N.style.width = N.style.paddingLeft = "1px"; M.body.appendChild(N); ai.boxModel = ai.support.boxModel = N.offsetWidth === 2; M.body.removeChild(N).style.display = "none" }); L = function (N) { var P = M.createElement("div"); N = "on" + N; var O = N in P; if (!O) { P.setAttribute(N, "return;"); O = typeof P[N] === "function" } return O }; ai.support.submitBubbles = L("submit"); ai.support.changeBubbles = L("change"); L = K = J = G = w = null } })(); ai.props = { "for": "htmlFor", "class": "className", readonly: "readOnly", maxlength: "maxLength", cellspacing: "cellSpacing", rowspan: "rowSpan", colspan: "colSpan", tabindex: "tabIndex", usemap: "useMap", frameborder: "frameBorder" }; var aH = "jQuery" + aF(), e = 0, aS = {}; ai.extend({ cache: {}, expando: aH, noData: { embed: true, object: true, applet: true }, data: function (s, c, F) { if (!(s.nodeName && ai.noData[s.nodeName.toLowerCase()])) { s = s == aO ? aS : s; var w = s[aH], A = ai.cache; if (!w && typeof c === "string" && F === I) { return null } w || (w = ++e); if (typeof c === "object") { s[aH] = w; A[w] = ai.extend(true, {}, c) } else { if (!A[w]) { s[aH] = w; A[w] = {} } } s = A[w]; if (F !== I) { s[c] = F } return typeof c === "string" ? s[c] : s } }, removeData: function (s, c) { if (!(s.nodeName && ai.noData[s.nodeName.toLowerCase()])) { s = s == aO ? aS : s; var F = s[aH], w = ai.cache, A = w[F]; if (c) { if (A) { delete A[c]; ai.isEmptyObject(A) && ai.removeData(s) } } else { if (ai.support.deleteExpando) { delete s[ai.expando] } else { s.removeAttribute && s.removeAttribute(ai.expando) } delete w[F] } } } }); ai.fn.extend({ data: function (s, c) { if (typeof s === "undefined" && this.length) { return ai.data(this[0]) } else { if (typeof s === "object") { return this.each(function () { ai.data(this, s) }) } } var A = s.split("."); A[1] = A[1] ? "." + A[1] : ""; if (c === I) { var w = this.triggerHandler("getData" + A[1] + "!", [A[0]]); if (w === I && this.length) { w = ai.data(this[0], s) } return w === I && A[1] ? this.data(A[0]) : w } else { return this.trigger("setData" + A[1] + "!", [A[0], c]).each(function () { ai.data(this, s, c) }) } }, removeData: function (c) { return this.each(function () { ai.removeData(this, c) }) } }); ai.extend({ queue: function (s, c, A) { if (s) { c = (c || "fx") + "queue"; var w = ai.data(s, c); if (!A) { return w || [] } if (!w || ai.isArray(A)) { w = ai.data(s, c, ai.makeArray(A)) } else { w.push(A) } return w } }, dequeue: function (s, c) { c = c || "fx"; var A = ai.queue(s, c), w = A.shift(); if (w === "inprogress") { w = A.shift() } if (w) { c === "fx" && A.unshift("inprogress"); w.call(s, function () { ai.dequeue(s, c) }) } } }); ai.fn.extend({ queue: function (s, c) { if (typeof s !== "string") { c = s; s = "fx" } if (c === I) { return ai.queue(this[0], s) } return this.each(function () { var w = ai.queue(this, s, c); s === "fx" && w[0] !== "inprogress" && ai.dequeue(this, s) }) }, dequeue: function (c) { return this.each(function () { ai.dequeue(this, c) }) }, delay: function (s, c) { s = ai.fx ? ai.fx.speeds[s] || s : s; c = c || "fx"; return this.queue(c, function () { var w = this; setTimeout(function () { ai.dequeue(w, c) }, s) }) }, clearQueue: function (c) { return this.queue(c || "fx", []) } }); var be = /[\n\t]/g, U = /\s+/, a8 = /\r/g, aM = /href|src|style/, aU = /(button|input)/i, ax = /(button|input|object|select|textarea)/i, S = /^(a|area)$/i, aY = /radio|checkbox/; ai.fn.extend({ attr: function (s, c) { return ap(this, s, c, true, ai.attr) }, removeAttr: function (c) { return this.each(function () { ai.attr(this, c, ""); this.nodeType === 1 && this.removeAttribute(c) }) }, addClass: function (L) { if (ai.isFunction(L)) { return this.each(function (O) { var N = ai(this); N.addClass(L.call(this, O, N.attr("class"))) }) } if (L && typeof L === "string") { for (var K = (L || "").split(U), J = 0, F = this.length; J < F; J++) { var G = this[J]; if (G.nodeType === 1) { if (G.className) { for (var w = " " + G.className + " ", A = G.className, c = 0, s = K.length; c < s; c++) { if (w.indexOf(" " + K[c] + " ") < 0) { A += " " + K[c] } } G.className = ai.trim(A) } else { G.className = L } } } } return this }, removeClass: function (s) { if (ai.isFunction(s)) { return this.each(function (L) { var N = ai(this); N.removeClass(s.call(this, L, N.attr("class"))) }) } if (s && typeof s === "string" || s === I) { for (var c = (s || "").split(U), K = 0, F = this.length; K < F; K++) { var G = this[K]; if (G.nodeType === 1 && G.className) { if (s) { for (var w = (" " + G.className + " ").replace(be, " "), A = 0, J = c.length; A < J; A++) { w = w.replace(" " + c[A] + " ", " ") } G.className = ai.trim(w) } else { G.className = "" } } } } return this }, toggleClass: function (s, c) { var A = typeof s, w = typeof c === "boolean"; if (ai.isFunction(s)) { return this.each(function (G) { var F = ai(this); F.toggleClass(s.call(this, G, F.attr("class"), c), c) }) } return this.each(function () { if (A === "string") { for (var K, G = 0, J = ai(this), L = c, F = s.split(U); K = F[G++];) { L = w ? L : !J.hasClass(K); J[L ? "addClass" : "removeClass"](K) } } else { if (A === "undefined" || A === "boolean") { this.className && ai.data(this, "__className__", this.className); this.className = this.className || s === false ? "" : ai.data(this, "__className__") || "" } } }) }, hasClass: function (s) { s = " " + s + " "; for (var c = 0, w = this.length; c < w; c++) { if ((" " + this[c].className + " ").replace(be, " ").indexOf(s) > -1) { return true } } return false }, val: function (s) { if (s === I) { var c = this[0]; if (c) { if (ai.nodeName(c, "option")) { return (c.attributes.value || {}).specified ? c.value : c.text } if (ai.nodeName(c, "select")) { var K = c.selectedIndex, F = [], G = c.options; c = c.type === "select-one"; if (K < 0) { return null } var w = c ? K : 0; for (K = c ? K + 1 : G.length; w < K; w++) { var A = G[w]; if (A.selected) { s = ai(A).val(); if (c) { return s } F.push(s) } } return F } if (aY.test(c.type) && !ai.support.checkOn) { return c.getAttribute("value") === null ? "on" : c.value } return (c.value || "").replace(a8, "") } return I } var J = ai.isFunction(s); return this.each(function (L) { var P = ai(this), O = s; if (this.nodeType === 1) { if (J) { O = s.call(this, L, P.val()) } if (typeof O === "number") { O += "" } if (ai.isArray(O) && aY.test(this.type)) { this.checked = ai.inArray(P.val(), O) >= 0 } else { if (ai.nodeName(this, "select")) { var N = ai.makeArray(O); ai("option", this).each(function () { this.selected = ai.inArray(ai(this).val(), N) >= 0 }); if (!N.length) { this.selectedIndex = -1 } } else { this.value = O } } } }) } }); ai.extend({ attrFn: { val: true, css: true, html: true, text: true, data: true, width: true, height: true, offset: true }, attr: function (s, c, G, A) { if (!s || s.nodeType === 3 || s.nodeType === 8) { return I } if (A && c in ai.attrFn) { return ai(s)[c](G) } A = s.nodeType !== 1 || !ai.isXMLDoc(s); var F = G !== I; c = A && ai.props[c] || c; if (s.nodeType === 1) { var w = aM.test(c); if (c in s && A && !w) { if (F) { c === "type" && aU.test(s.nodeName) && s.parentNode && ai.error("type property can't be changed"); s[c] = G } if (ai.nodeName(s, "form") && s.getAttributeNode(c)) { return s.getAttributeNode(c).nodeValue } if (c === "tabIndex") { return (c = s.getAttributeNode("tabIndex")) && c.specified ? c.value : ax.test(s.nodeName) || S.test(s.nodeName) && s.href ? 0 : I } return s[c] } if (!ai.support.style && A && c === "style") { if (F) { s.style.cssText = "" + G } return s.style.cssText } F && s.setAttribute(c, "" + G); s = !ai.support.hrefNormalized && A && w ? s.getAttribute(c, 2) : s.getAttribute(c); return s === null ? I : s } return ai.style(s, c, G) } }); var ay = /\.(.*)$/, r = function (c) { return c.replace(/[^\w\s\.\|`]/g, function (s) { return "\\" + s }) }; ai.event = { add: function (P, O, L, J) { if (!(P.nodeType === 3 || P.nodeType === 8)) { if (P.setInterval && P !== aO && !P.frameElement) { P = aO } var K, F; if (L.handler) { K = L; L = K.handler } if (!L.guid) { L.guid = ai.guid++ } if (F = ai.data(P)) { var G = F.events = F.events || {}, s = F.handle; if (!s) { F.handle = s = function () { return typeof ai !== "undefined" && !ai.event.triggered ? ai.event.handle.apply(s.elem, arguments) : I } } s.elem = P; O = O.split(" "); for (var A, w = 0, c; A = O[w++];) { F = K ? ai.extend({}, K) : { handler: L, data: J }; if (A.indexOf(".") > -1) { c = A.split("."); A = c.shift(); F.namespace = c.slice(0).sort().join(".") } else { c = []; F.namespace = "" } F.type = A; F.guid = L.guid; var Q = G[A], N = ai.event.special[A] || {}; if (!Q) { Q = G[A] = []; if (!N.setup || N.setup.call(P, J, c, s) === false) { if (P.addEventListener) { P.addEventListener(A, s, false) } else { P.attachEvent && P.attachEvent("on" + A, s) } } } if (N.add) { N.add.call(P, F); if (!F.handler.guid) { F.handler.guid = L.guid } } Q.push(F); ai.event.global[A] = true } P = null } } }, global: {}, remove: function (R, Q, O, L) { if (!(R.nodeType === 3 || R.nodeType === 8)) { var N, J = 0, K, A, G, F, c, T, P = ai.data(R), s = P && P.events; if (P && s) { if (Q && Q.type) { O = Q.handler; Q = Q.type } if (!Q || typeof Q === "string" && Q.charAt(0) === ".") { Q = Q || ""; for (N in s) { ai.event.remove(R, N + Q) } } else { for (Q = Q.split(" "); N = Q[J++];) { F = N; K = N.indexOf(".") < 0; A = []; if (!K) { A = N.split("."); N = A.shift(); G = new RegExp("(^|\\.)" + ai.map(A.slice(0).sort(), r).join("\\.(?:.*\\.)?") + "(\\.|$)") } if (c = s[N]) { if (O) { F = ai.event.special[N] || {}; for (w = L || 0; w < c.length; w++) { T = c[w]; if (O.guid === T.guid) { if (K || G.test(T.namespace)) { L == null && c.splice(w--, 1); F.remove && F.remove.call(R, T) } if (L != null) { break } } } if (c.length === 0 || L != null && c.length === 1) { if (!F.teardown || F.teardown.call(R, A) === false) { aG(R, N, P.handle) } delete s[N] } } else { for (var w = 0; w < c.length; w++) { T = c[w]; if (K || G.test(T.namespace)) { ai.event.remove(R, F, T.handler, w); c.splice(w--, 1) } } } } } if (ai.isEmptyObject(s)) { if (Q = P.handle) { Q.elem = null } delete P.events; delete P.handle; ai.isEmptyObject(P) && ai.removeData(R) } } } } }, trigger: function (N, L, K, G) { var J = N.type || N; if (!G) { N = typeof N === "object" ? N[aH] ? N : ai.extend(ai.Event(J), N) : ai.Event(J); if (J.indexOf("!") >= 0) { N.type = J = J.slice(0, -1); N.exclusive = true } if (!K) { N.stopPropagation(); ai.event.global[J] && ai.each(ai.cache, function () { this.events && this.events[J] && ai.event.trigger(N, L, this.handle.elem) }) } if (!K || K.nodeType === 3 || K.nodeType === 8) { return I } N.result = I; N.target = K; L = ai.makeArray(L); L.unshift(N) } N.currentTarget = K; (G = ai.data(K, "handle")) && G.apply(K, L); G = K.parentNode || K.ownerDocument; try { if (!(K && K.nodeName && ai.noData[K.nodeName.toLowerCase()])) { if (K["on" + J] && K["on" + J].apply(K, L) === false) { N.result = false } } } catch (A) { } if (!N.isPropagationStopped() && G) { ai.event.trigger(N, L, G, true) } else { if (!N.isDefaultPrevented()) { G = N.target; var F, c = ai.nodeName(G, "a") && J === "click", w = ai.event.special[J] || {}; if ((!w._default || w._default.call(K, N) === false) && !c && !(G && G.nodeName && ai.noData[G.nodeName.toLowerCase()])) { try { if (G[J]) { if (F = G["on" + J]) { G["on" + J] = null } ai.event.triggered = true; G[J]() } } catch (s) { } if (F) { G["on" + J] = F } ai.event.triggered = false } } } }, handle: function (s) { var c, J, F, G; s = arguments[0] = ai.event.fix(s || aO.event); s.currentTarget = this; c = s.type.indexOf(".") < 0 && !s.exclusive; if (!c) { J = s.type.split("."); s.type = J.shift(); F = new RegExp("(^|\\.)" + J.slice(0).sort().join("\\.(?:.*\\.)?") + "(\\.|$)") } G = ai.data(this, "events"); J = G[s.type]; if (G && J) { J = J.slice(0); G = 0; for (var w = J.length; G < w; G++) { var A = J[G]; if (c || F.test(A.namespace)) { s.handler = A.handler; s.data = A.data; s.handleObj = A; A = A.handler.apply(this, arguments); if (A !== I) { s.result = A; if (A === false) { s.preventDefault(); s.stopPropagation() } } if (s.isImmediatePropagationStopped()) { break } } } } return s.result }, props: "altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "), fix: function (s) { if (s[aH]) { return s } var c = s; s = ai.Event(c); for (var A = this.props.length, w; A;) { w = this.props[--A]; s[w] = c[w] } if (!s.target) { s.target = s.srcElement || M } if (s.target.nodeType === 3) { s.target = s.target.parentNode } if (!s.relatedTarget && s.fromElement) { s.relatedTarget = s.fromElement === s.target ? s.toElement : s.fromElement } if (s.pageX == null && s.clientX != null) { c = M.documentElement; A = M.body; s.pageX = s.clientX + (c && c.scrollLeft || A && A.scrollLeft || 0) - (c && c.clientLeft || A && A.clientLeft || 0); s.pageY = s.clientY + (c && c.scrollTop || A && A.scrollTop || 0) - (c && c.clientTop || A && A.clientTop || 0) } if (!s.which && (s.charCode || s.charCode === 0 ? s.charCode : s.keyCode)) { s.which = s.charCode || s.keyCode } if (!s.metaKey && s.ctrlKey) { s.metaKey = s.ctrlKey } if (!s.which && s.button !== I) { s.which = s.button & 1 ? 1 : s.button & 2 ? 3 : s.button & 4 ? 2 : 0 } return s }, guid: 100000000, proxy: ai.proxy, special: { ready: { setup: ai.bindReady, teardown: ai.noop }, live: { add: function (c) { ai.event.add(this, c.origType, ai.extend({}, c, { handler: ag })) }, remove: function (s) { var c = true, w = s.origType.replace(ay, ""); ai.each(ai.data(this, "events").live || [], function () { if (w === this.origType.replace(ay, "")) { return c = false } }); c && ai.event.remove(this, s.origType, ag) } }, beforeunload: { setup: function (s, c, w) { if (this.setInterval) { this.onbeforeunload = w } return false }, teardown: function (s, c) { if (this.onbeforeunload === c) { this.onbeforeunload = null } } } } }; var aG = M.removeEventListener ? function (s, c, w) { s.removeEventListener(c, w, false) } : function (s, c, w) { s.detachEvent("on" + c, w) }; ai.Event = function (c) { if (!this.preventDefault) { return new ai.Event(c) } if (c && c.type) { this.originalEvent = c; this.type = c.type } else { this.type = c } this.timeStamp = aF(); this[aH] = true }; ai.Event.prototype = { preventDefault: function () { this.isDefaultPrevented = am; var c = this.originalEvent; if (c) { c.preventDefault && c.preventDefault(); c.returnValue = false } }, stopPropagation: function () { this.isPropagationStopped = am; var c = this.originalEvent; if (c) { c.stopPropagation && c.stopPropagation(); c.cancelBubble = true } }, stopImmediatePropagation: function () { this.isImmediatePropagationStopped = am; this.stopPropagation() }, isDefaultPrevented: an, isPropagationStopped: an, isImmediatePropagationStopped: an }; var ae = function (s) { var c = s.relatedTarget; try { for (; c && c !== this;) { c = c.parentNode } if (c !== this) { s.type = s.data; ai.event.handle.apply(this, arguments) } } catch (w) { } }, x = function (c) { c.type = c.data; ai.event.handle.apply(this, arguments) }; ai.each({ mouseenter: "mouseover", mouseleave: "mouseout" }, function (s, c) { ai.event.special[s] = { setup: function (w) { ai.event.add(this, c, w && w.selector ? x : ae, s) }, teardown: function (w) { ai.event.remove(this, c, w && w.selector ? x : ae) } } }); if (!ai.support.submitBubbles) { ai.event.special.submit = { setup: function () { if (this.nodeName.toLowerCase() !== "form") { ai.event.add(this, "click.specialSubmit", function (s) { var c = s.target, w = c.type; if ((w === "submit" || w === "image") && ai(c).closest("form").length) { return aK("submit", this, arguments) } }); ai.event.add(this, "keypress.specialSubmit", function (s) { var c = s.target, w = c.type; if ((w === "text" || w === "password") && ai(c).closest("form").length && s.keyCode === 13) { return aK("submit", this, arguments) } }) } else { return false } }, teardown: function () { ai.event.remove(this, ".specialSubmit") } } } if (!ai.support.changeBubbles) { var t = /textarea|input|select/i, g, j = function (s) { var c = s.type, w = s.value; if (c === "radio" || c === "checkbox") { w = s.checked } else { if (c === "select-multiple") { w = s.selectedIndex > -1 ? ai.map(s.options, function (A) { return A.selected }).join("-") : "" } else { if (s.nodeName.toLowerCase() === "select") { w = s.selectedIndex } } } return w }, bd = function (s, c) { var F = s.target, w, A; if (!(!t.test(F.nodeName) || F.readOnly)) { w = ai.data(F, "_change_data"); A = j(F); if (s.type !== "focusout" || F.type !== "radio") { ai.data(F, "_change_data", A) } if (!(w === I || A === w)) { if (w != null || A) { s.type = "change"; return ai.event.trigger(s, c, F) } } } }; ai.event.special.change = { filters: { focusout: bd, click: function (s) { var c = s.target, w = c.type; if (w === "radio" || w === "checkbox" || c.nodeName.toLowerCase() === "select") { return bd.call(this, s) } }, keydown: function (s) { var c = s.target, w = c.type; if (s.keyCode === 13 && c.nodeName.toLowerCase() !== "textarea" || s.keyCode === 32 && (w === "checkbox" || w === "radio") || w === "select-multiple") { return bd.call(this, s) } }, beforeactivate: function (c) { c = c.target; ai.data(c, "_change_data", j(c)) } }, setup: function () { if (this.type === "file") { return false } for (var c in g) { ai.event.add(this, c + ".specialChange", g[c]) } return t.test(this.nodeName) }, teardown: function () { ai.event.remove(this, ".specialChange"); return t.test(this.nodeName) } }; g = ai.event.special.change.filters } M.addEventListener && ai.each({ focus: "focusin", blur: "focusout" }, function (s, c) { function w(A) { A = ai.event.fix(A); A.type = c; return ai.event.handle.call(this, A) } ai.event.special[c] = { setup: function () { this.addEventListener(s, w, true) }, teardown: function () { this.removeEventListener(s, w, true) } } }); ai.each(["bind", "one"], function (s, c) { ai.fn[c] = function (K, F, G) { if (typeof K === "object") { for (var w in K) { this[c](w, F, K[w], G) } return this } if (ai.isFunction(F)) { G = F; F = I } var A = c === "one" ? ai.proxy(G, function (L) { ai(this).unbind(L, A); return G.apply(this, arguments) }) : G; if (K === "unload" && c !== "one") { this.one(K, F, G) } else { w = 0; for (var J = this.length; w < J; w++) { ai.event.add(this[w], K, A, F) } } return this } }); ai.fn.extend({ unbind: function (s, c) { if (typeof s === "object" && !s.preventDefault) { for (var A in s) { this.unbind(A, s[A]) } } else { A = 0; for (var w = this.length; A < w; A++) { ai.event.remove(this[A], s, c) } } return this }, delegate: function (s, c, A, w) { return this.live(c, A, w, s) }, undelegate: function (s, c, w) { return arguments.length === 0 ? this.unbind("live") : this.die(c, null, w, s) }, trigger: function (s, c) { return this.each(function () { ai.event.trigger(s, c, this) }) }, triggerHandler: function (s, c) { if (this[0]) { s = ai.Event(s); s.preventDefault(); s.stopPropagation(); ai.event.trigger(s, c, this[0]); return s.result } }, toggle: function (s) { for (var c = arguments, w = 1; w < c.length;) { ai.proxy(s, c[w++]) } return this.click(ai.proxy(s, function (A) { var F = (ai.data(this, "lastToggle" + s.guid) || 0) % w; ai.data(this, "lastToggle" + s.guid, F + 1); A.preventDefault(); return c[F].apply(this, arguments) || false })) }, hover: function (s, c) { return this.mouseenter(s).mouseleave(c || s) } }); var bh = { focus: "focusin", blur: "focusout", mouseenter: "mouseover", mouseleave: "mouseout" }; ai.each(["live", "die"], function (s, c) { ai.fn[c] = function (O, L, N, J) { var K, A = 0, G, F, w = J || this.selector, P = J ? this : ai(this.context); if (ai.isFunction(L)) { N = L; L = I } for (O = (O || "").split(" "); (K = O[A++]) != null;) { J = ay.exec(K); G = ""; if (J) { G = J[0]; K = K.replace(ay, "") } if (K === "hover") { O.push("mouseenter" + G, "mouseleave" + G) } else { F = K; if (K === "focus" || K === "blur") { O.push(bh[K] + G); K += G } else { K = (bh[K] || K) + G } c === "live" ? P.each(function () { ai.event.add(this, z(K, w), { data: L, selector: w, handler: N, origType: K, origHandler: N, preType: F }) }) : P.unbind(z(K, w), N) } } return this } }); ai.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "), function (s, c) { ai.fn[c] = function (w) { return w ? this.bind(c, w) : this.trigger(c) }; if (ai.attrFn) { ai.attrFn[c] = true } }); aO.attachEvent && !aO.addEventListener && aO.attachEvent("onunload", function () { for (var s in ai.cache) { if (ai.cache[s].handle) { try { ai.event.remove(ai.cache[s].handle.elem) } catch (c) { } } } }); (function () { function W(ab) { for (var aa = "", Z, Y = 0; ab[Y]; Y++) { Z = ab[Y]; if (Z.nodeType === 3 || Z.nodeType === 4) { aa += Z.nodeValue } else { if (Z.nodeType !== 8) { aa += W(Z.childNodes) } } } return aa } function V(bb, ba, ab, aa, Y, Z) { Y = 0; for (var bm = aa.length; Y < bm; Y++) { var bn = aa[Y]; if (bn) { bn = bn[bb]; for (var bl = false; bn;) { if (bn.sizcache === ab) { bl = aa[bn.sizset]; break } if (bn.nodeType === 1 && !Z) { bn.sizcache = ab; bn.sizset = Y } if (bn.nodeName.toLowerCase() === ba) { bl = bn; break } bn = bn[bb] } aa[Y] = bl } } } function T(bb, ba, ab, aa, Y, Z) { Y = 0; for (var bm = aa.length; Y < bm; Y++) { var bn = aa[Y]; if (bn) { bn = bn[bb]; for (var bl = false; bn;) { if (bn.sizcache === ab) { bl = aa[bn.sizset]; break } if (bn.nodeType === 1) { if (!Z) { bn.sizcache = ab; bn.sizset = Y } if (typeof ba !== "string") { if (bn === ba) { bl = true; break } } else { if (N.filter(ba, [bn]).length > 0) { bl = bn; break } } } bn = bn[bb] } aa[Y] = bl } } } var Q = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, R = 0, O = Object.prototype.toString, P = false, K = true;[0, 0].sort(function () { K = false; return 0 }); var N = function (bm, bl, ba, ab) { ba = ba || []; var Z = bl = bl || M; if (bl.nodeType !== 1 && bl.nodeType !== 9) { return [] } if (!bm || typeof bm !== "string") { return ba } for (var aa = [], br, bs, bo, bb, bq = true, bn = s(bl), bp = bm; (Q.exec(""), br = Q.exec(bp)) !== null;) { bp = br[3]; aa.push(br[1]); if (br[2]) { bb = br[3]; break } } if (aa.length > 1 && F.exec(bm)) { if (aa.length === 2 && L.relative[aa[0]]) { bs = X(aa[0] + aa[1], bl) } else { for (bs = L.relative[aa[0]] ? [bl] : N(aa.shift(), bl); aa.length;) { bm = aa.shift(); if (L.relative[bm]) { bm += aa.shift() } bs = X(bm, bs) } } } else { if (!ab && aa.length > 1 && bl.nodeType === 9 && !bn && L.match.ID.test(aa[0]) && !L.match.ID.test(aa[aa.length - 1])) { br = N.find(aa.shift(), bl, bn); bl = br.expr ? N.filter(br.expr, br.set)[0] : br.set[0] } if (bl) { br = ab ? { expr: aa.pop(), set: c(ab) } : N.find(aa.pop(), aa.length === 1 && (aa[0] === "~" || aa[0] === "+") && bl.parentNode ? bl.parentNode : bl, bn); bs = br.expr ? N.filter(br.expr, br.set) : br.set; if (aa.length > 0) { bo = c(bs) } else { bq = false } for (; aa.length;) { var Y = aa.pop(); br = Y; if (L.relative[Y]) { br = aa.pop() } else { Y = "" } if (br == null) { br = bl } L.relative[Y](bo, br, bn) } } else { bo = [] } } bo || (bo = bs); bo || N.error(Y || bm); if (O.call(bo) === "[object Array]") { if (bq) { if (bl && bl.nodeType === 1) { for (bm = 0; bo[bm] != null; bm++) { if (bo[bm] && (bo[bm] === true || bo[bm].nodeType === 1 && A(bl, bo[bm]))) { ba.push(bs[bm]) } } } else { for (bm = 0; bo[bm] != null; bm++) { bo[bm] && bo[bm].nodeType === 1 && ba.push(bs[bm]) } } } else { ba.push.apply(ba, bo) } } else { c(bo, ba) } if (bb) { N(bb, Z, ba, ab); N.uniqueSort(ba) } return ba }; N.uniqueSort = function (Z) { if (J) { P = K; Z.sort(J); if (P) { for (var Y = 1; Y < Z.length; Y++) { Z[Y] === Z[Y - 1] && Z.splice(Y--, 1) } } } return Z }; N.matches = function (Z, Y) { return N(Z, null, null, Y) }; N.find = function (bb, ba, ab) { var aa, Y; if (!bb) { return [] } for (var Z = 0, bm = L.order.length; Z < bm; Z++) { var bn = L.order[Z]; if (Y = L.leftMatch[bn].exec(bb)) { var bl = Y[1]; Y.splice(1, 1); if (bl.substr(bl.length - 1) !== "\\") { Y[1] = (Y[1] || "").replace(/\\/g, ""); aa = L.find[bn](Y, ba, ab); if (aa != null) { bb = bb.replace(L.match[bn], ""); break } } } } aa || (aa = ba.getElementsByTagName("*")); return { set: aa, expr: bb } }; N.filter = function (bn, bm, bb, ab) { for (var Z = bn, aa = [], bt = bm, bu, bq, bl = bm && bm[0] && s(bm[0]); bn && bm.length;) { for (var bs in L.filter) { if ((bu = L.leftMatch[bs].exec(bn)) != null && bu[2]) { var bo = L.filter[bs], br, Y; Y = bu[1]; bq = false; bu.splice(1, 1); if (Y.substr(Y.length - 1) !== "\\") { if (bt === aa) { aa = [] } if (L.preFilter[bs]) { if (bu = L.preFilter[bs](bu, bt, bb, aa, ab, bl)) { if (bu === true) { continue } } else { bq = br = true } } if (bu) { for (var ba = 0; (Y = bt[ba]) != null; ba++) { if (Y) { br = bo(Y, bu, ba, bt); var bp = ab ^ !!br; if (bb && br != null) { if (bp) { bq = true } else { bt[ba] = false } } else { if (bp) { aa.push(Y); bq = true } } } } } if (br !== I) { bb || (bt = aa); bn = bn.replace(L.match[bs], ""); if (!bq) { return [] } break } } } } if (bn === Z) { if (bq == null) { N.error(bn) } else { break } } Z = bn } return bt }; N.error = function (Y) { throw "Syntax error, unrecognized expression: " + Y }; var L = N.selectors = { order: ["ID", "NAME", "TAG"], match: { ID: /#((?:[\w\u00c0-\uFFFF-]|\\.)+)/, CLASS: /\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/, NAME: /\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/, ATTR: /\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/, TAG: /^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/, CHILD: /:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/, POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/, PSEUDO: /:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/ }, leftMatch: {}, attrMap: { "class": "className", "for": "htmlFor" }, attrHandle: { href: function (Y) { return Y.getAttribute("href") } }, relative: { "+": function (ab, aa) { var Z = typeof aa === "string", Y = Z && !/\W/.test(aa); Z = Z && !Y; if (Y) { aa = aa.toLowerCase() } Y = 0; for (var ba = ab.length, bb; Y < ba; Y++) { if (bb = ab[Y]) { for (; (bb = bb.previousSibling) && bb.nodeType !== 1;) { } ab[Y] = Z || bb && bb.nodeName.toLowerCase() === aa ? bb || false : bb === aa } } Z && N.filter(aa, ab, true) }, ">": function (ab, aa) { var Z = typeof aa === "string"; if (Z && !/\W/.test(aa)) { aa = aa.toLowerCase(); for (var Y = 0, ba = ab.length; Y < ba; Y++) { var bb = ab[Y]; if (bb) { Z = bb.parentNode; ab[Y] = Z.nodeName.toLowerCase() === aa ? Z : false } } } else { Y = 0; for (ba = ab.length; Y < ba; Y++) { if (bb = ab[Y]) { ab[Y] = Z ? bb.parentNode : bb.parentNode === aa } } Z && N.filter(aa, ab, true) } }, "": function (ab, aa, Z) { var Y = R++, ba = T; if (typeof aa === "string" && !/\W/.test(aa)) { var bb = aa = aa.toLowerCase(); ba = V } ba("parentNode", aa, Y, ab, bb, Z) }, "~": function (ab, aa, Z) { var Y = R++, ba = T; if (typeof aa === "string" && !/\W/.test(aa)) { var bb = aa = aa.toLowerCase(); ba = V } ba("previousSibling", aa, Y, ab, bb, Z) } }, find: { ID: function (aa, Z, Y) { if (typeof Z.getElementById !== "undefined" && !Y) { return (aa = Z.getElementById(aa[1])) ? [aa] : [] } }, NAME: function (ab, aa) { if (typeof aa.getElementsByName !== "undefined") { var Z = []; aa = aa.getElementsByName(ab[1]); for (var Y = 0, ba = aa.length; Y < ba; Y++) { aa[Y].getAttribute("name") === ab[1] && Z.push(aa[Y]) } return Z.length === 0 ? null : Z } }, TAG: function (Z, Y) { return Y.getElementsByTagName(Z[1]) } }, preFilter: { CLASS: function (ba, ab, Z, Y, bb, bl) { ba = " " + ba[1].replace(/\\/g, "") + " "; if (bl) { return ba } bl = 0; for (var aa; (aa = ab[bl]) != null; bl++) { if (aa) { if (bb ^ (aa.className && (" " + aa.className + " ").replace(/[\t\n]/g, " ").indexOf(ba) >= 0)) { Z || Y.push(aa) } else { if (Z) { ab[bl] = false } } } } return false }, ID: function (Y) { return Y[1].replace(/\\/g, "") }, TAG: function (Y) { return Y[1].toLowerCase() }, CHILD: function (Z) { if (Z[1] === "nth") { var Y = /(-?)(\d*)n((?:\+|-)?\d*)/.exec(Z[2] === "even" && "2n" || Z[2] === "odd" && "2n+1" || !/\D/.test(Z[2]) && "0n+" + Z[2] || Z[2]); Z[2] = Y[1] + (Y[2] || 1) - 0; Z[3] = Y[3] - 0 } Z[0] = R++; return Z }, ATTR: function (ab, aa, Z, Y, ba, bb) { aa = ab[1].replace(/\\/g, ""); if (!bb && L.attrMap[aa]) { ab[1] = L.attrMap[aa] } if (ab[2] === "~=") { ab[4] = " " + ab[4] + " " } return ab }, PSEUDO: function (ab, aa, Z, Y, ba) { if (ab[1] === "not") { if ((Q.exec(ab[3]) || "").length > 1 || /^\w/.test(ab[3])) { ab[3] = N(ab[3], null, null, aa) } else { ab = N.filter(ab[3], aa, Z, true ^ ba); Z || Y.push.apply(Y, ab); return false } } else { if (L.match.POS.test(ab[0]) || L.match.CHILD.test(ab[0])) { return true } } return ab }, POS: function (Y) { Y.unshift(true); return Y } }, filters: { enabled: function (Y) { return Y.disabled === false && Y.type !== "hidden" }, disabled: function (Y) { return Y.disabled === true }, checked: function (Y) { return Y.checked === true }, selected: function (Y) { return Y.selected === true }, parent: function (Y) { return !!Y.firstChild }, empty: function (Y) { return !Y.firstChild }, has: function (aa, Z, Y) { return !!N(Y[3], aa).length }, header: function (Y) { return /h\d/i.test(Y.nodeName) }, text: function (Y) { return "text" === Y.type }, radio: function (Y) { return "radio" === Y.type }, checkbox: function (Y) { return "checkbox" === Y.type }, file: function (Y) { return "file" === Y.type }, password: function (Y) { return "password" === Y.type }, submit: function (Y) { return "submit" === Y.type }, image: function (Y) { return "image" === Y.type }, reset: function (Y) { return "reset" === Y.type }, button: function (Y) { return "button" === Y.type || Y.nodeName.toLowerCase() === "button" }, input: function (Y) { return /input|select|textarea|button/i.test(Y.nodeName) } }, setFilters: { first: function (Z, Y) { return Y === 0 }, last: function (ab, aa, Z, Y) { return aa === Y.length - 1 }, even: function (Z, Y) { return Y % 2 === 0 }, odd: function (Z, Y) { return Y % 2 === 1 }, lt: function (aa, Z, Y) { return Z < Y[3] - 0 }, gt: function (aa, Z, Y) { return Z > Y[3] - 0 }, nth: function (aa, Z, Y) { return Y[3] - 0 === Z }, eq: function (aa, Z, Y) { return Y[3] - 0 === Z } }, filter: { PSEUDO: function (ab, aa, Z, Y) { var ba = aa[1], bb = L.filters[ba]; if (bb) { return bb(ab, Z, aa, Y) } else { if (ba === "contains") { return (ab.textContent || ab.innerText || W([ab]) || "").indexOf(aa[3]) >= 0 } else { if (ba === "not") { aa = aa[3]; Z = 0; for (Y = aa.length; Z < Y; Z++) { if (aa[Z] === ab) { return false } } return true } else { N.error("Syntax error, unrecognized expression: " + ba) } } } }, CHILD: function (ba, ab) { var Z = ab[1], Y = ba; switch (Z) { case "only": case "first": for (; Y = Y.previousSibling;) { if (Y.nodeType === 1) { return false } } if (Z === "first") { return true } Y = ba; case "last": for (; Y = Y.nextSibling;) { if (Y.nodeType === 1) { return false } } return true; case "nth": Z = ab[2]; var bb = ab[3]; if (Z === 1 && bb === 0) { return true } ab = ab[0]; var bl = ba.parentNode; if (bl && (bl.sizcache !== ab || !ba.nodeIndex)) { var aa = 0; for (Y = bl.firstChild; Y; Y = Y.nextSibling) { if (Y.nodeType === 1) { Y.nodeIndex = ++aa } } bl.sizcache = ab } ba = ba.nodeIndex - bb; return Z === 0 ? ba === 0 : ba % Z === 0 && ba / Z >= 0 } }, ID: function (Z, Y) { return Z.nodeType === 1 && Z.getAttribute("id") === Y }, TAG: function (Z, Y) { return Y === "*" && Z.nodeType === 1 || Z.nodeName.toLowerCase() === Y }, CLASS: function (Z, Y) { return (" " + (Z.className || Z.getAttribute("class")) + " ").indexOf(Y) > -1 }, ATTR: function (ab, aa) { var Z = aa[1]; ab = L.attrHandle[Z] ? L.attrHandle[Z](ab) : ab[Z] != null ? ab[Z] : ab.getAttribute(Z); Z = ab + ""; var Y = aa[2]; aa = aa[4]; return ab == null ? Y === "!=" : Y === "=" ? Z === aa : Y === "*=" ? Z.indexOf(aa) >= 0 : Y === "~=" ? (" " + Z + " ").indexOf(aa) >= 0 : !aa ? Z && ab !== false : Y === "!=" ? Z !== aa : Y === "^=" ? Z.indexOf(aa) === 0 : Y === "$=" ? Z.substr(Z.length - aa.length) === aa : Y === "|=" ? Z === aa || Z.substr(0, aa.length + 1) === aa + "-" : false }, POS: function (ab, aa, Z, Y) { var ba = L.setFilters[aa[2]]; if (ba) { return ba(ab, Z, aa, Y) } } } }, F = L.match.POS; for (var w in L.match) { L.match[w] = new RegExp(L.match[w].source + /(?![^\[]*\])(?![^\(]*\))/.source); L.leftMatch[w] = new RegExp(/(^(?:.|\r|\n)*?)/.source + L.match[w].source.replace(/\\(\d+)/g, function (Z, Y) { return "\\" + (Y - 0 + 1) })) } var c = function (Z, Y) { Z = Array.prototype.slice.call(Z, 0); if (Y) { Y.push.apply(Y, Z); return Y } return Z }; try { Array.prototype.slice.call(M.documentElement.childNodes, 0) } catch (G) { c = function (ab, aa) { aa = aa || []; if (O.call(ab) === "[object Array]") { Array.prototype.push.apply(aa, ab) } else { if (typeof ab.length === "number") { for (var Z = 0, Y = ab.length; Z < Y; Z++) { aa.push(ab[Z]) } } else { for (Z = 0; ab[Z]; Z++) { aa.push(ab[Z]) } } } return aa } } var J; if (M.documentElement.compareDocumentPosition) { J = function (Z, Y) { if (!Z.compareDocumentPosition || !Y.compareDocumentPosition) { if (Z == Y) { P = true } return Z.compareDocumentPosition ? -1 : 1 } Z = Z.compareDocumentPosition(Y) & 4 ? -1 : Z === Y ? 0 : 1; if (Z === 0) { P = true } return Z } } else { if ("sourceIndex" in M.documentElement) { J = function (Z, Y) { if (!Z.sourceIndex || !Y.sourceIndex) { if (Z == Y) { P = true } return Z.sourceIndex ? -1 : 1 } Z = Z.sourceIndex - Y.sourceIndex; if (Z === 0) { P = true } return Z } } else { if (M.createRange) { J = function (ab, aa) { if (!ab.ownerDocument || !aa.ownerDocument) { if (ab == aa) { P = true } return ab.ownerDocument ? -1 : 1 } var Z = ab.ownerDocument.createRange(), Y = aa.ownerDocument.createRange(); Z.setStart(ab, 0); Z.setEnd(ab, 0); Y.setStart(aa, 0); Y.setEnd(aa, 0); ab = Z.compareBoundaryPoints(Range.START_TO_END, Y); if (ab === 0) { P = true } return ab } } } } (function () { var aa = M.createElement("div"), Z = "script" + (new Date).getTime(); aa.innerHTML = "<a name='" + Z + "'/>"; var Y = M.documentElement; Y.insertBefore(aa, Y.firstChild); if (M.getElementById(Z)) { L.find.ID = function (ab, ba, bb) { if (typeof ba.getElementById !== "undefined" && !bb) { return (ba = ba.getElementById(ab[1])) ? ba.id === ab[1] || typeof ba.getAttributeNode !== "undefined" && ba.getAttributeNode("id").nodeValue === ab[1] ? [ba] : I : [] } }; L.filter.ID = function (ab, ba) { var bb = typeof ab.getAttributeNode !== "undefined" && ab.getAttributeNode("id"); return ab.nodeType === 1 && bb && bb.nodeValue === ba } } Y.removeChild(aa); Y = aa = null })(); (function () { var Y = M.createElement("div"); Y.appendChild(M.createComment("")); if (Y.getElementsByTagName("*").length > 0) { L.find.TAG = function (ab, aa) { aa = aa.getElementsByTagName(ab[1]); if (ab[1] === "*") { ab = []; for (var Z = 0; aa[Z]; Z++) { aa[Z].nodeType === 1 && ab.push(aa[Z]) } aa = ab } return aa } } Y.innerHTML = "<a href='#'></a>"; if (Y.firstChild && typeof Y.firstChild.getAttribute !== "undefined" && Y.firstChild.getAttribute("href") !== "#") { L.attrHandle.href = function (Z) { return Z.getAttribute("href", 2) } } Y = null })(); M.querySelectorAll && function () { var aa = N, Z = M.createElement("div"); Z.innerHTML = "<p class='TEST'></p>"; if (!(Z.querySelectorAll && Z.querySelectorAll(".TEST").length === 0)) { N = function (ab, bl, bm, ba) { bl = bl || M; if (!ba && bl.nodeType === 9 && !s(bl)) { try { return c(bl.querySelectorAll(ab), bm) } catch (bb) { } } return aa(ab, bl, bm, ba) }; for (var Y in aa) { N[Y] = aa[Y] } Z = null } }(); (function () { var Y = M.createElement("div"); Y.innerHTML = "<div class='test e'></div><div class='test'></div>"; if (!(!Y.getElementsByClassName || Y.getElementsByClassName("e").length === 0)) { Y.lastChild.className = "e"; if (Y.getElementsByClassName("e").length !== 1) { L.order.splice(1, 0, "CLASS"); L.find.CLASS = function (ab, aa, Z) { if (typeof aa.getElementsByClassName !== "undefined" && !Z) { return aa.getElementsByClassName(ab[1]) } }; Y = null } } })(); var A = M.compareDocumentPosition ? function (Z, Y) { return !!(Z.compareDocumentPosition(Y) & 16) } : function (Z, Y) { return Z !== Y && (Z.contains ? Z.contains(Y) : true) }, s = function (Y) { return (Y = (Y ? Y.ownerDocument || Y : 0).documentElement) ? Y.nodeName !== "HTML" : false }, X = function (ab, aa) { var Z = [], Y = "", ba; for (aa = aa.nodeType ? [aa] : aa; ba = L.match.PSEUDO.exec(ab);) { Y += ba[0]; ab = ab.replace(L.match.PSEUDO, "") } ab = L.relative[ab] ? ab + "*" : ab; ba = 0; for (var bb = aa.length; ba < bb; ba++) { N(ab, aa[ba], Z) } return N.filter(Y, Z) }; ai.find = N; ai.expr = N.selectors; ai.expr[":"] = ai.expr.filters; ai.unique = N.uniqueSort; ai.text = W; ai.isXMLDoc = s; ai.contains = A })(); var f = /Until$/, a9 = /^(?:parents|prevUntil|prevAll)/, aW = /,/; au = Array.prototype.slice; var aL = function (s, c, A) { if (ai.isFunction(c)) { return ai.grep(s, function (G, F) { return !!c.call(G, F, G) === A }) } else { if (c.nodeType) { return ai.grep(s, function (F) { return F === c === A }) } else { if (typeof c === "string") { var w = ai.grep(s, function (F) { return F.nodeType === 1 }); if (aT.test(c)) { return ai.filter(c, w, !A) } else { c = ai.filter(c, w) } } } } return ai.grep(s, function (F) { return ai.inArray(F, c) >= 0 === A }) }; ai.fn.extend({ find: function (s) { for (var c = this.pushStack("", "find", s), J = 0, F = 0, G = this.length; F < G; F++) { J = c.length; ai.find(s, this[F], c); if (F > 0) { for (var w = J; w < c.length; w++) { for (var A = 0; A < J; A++) { if (c[A] === c[w]) { c.splice(w--, 1); break } } } } } return c }, has: function (s) { var c = ai(s); return this.filter(function () { for (var A = 0, w = c.length; A < w; A++) { if (ai.contains(this, c[A])) { return true } } }) }, not: function (c) { return this.pushStack(aL(this, c, false), "not", c) }, filter: function (c) { return this.pushStack(aL(this, c, true), "filter", c) }, is: function (c) { return !!c && ai.filter(c, this).length > 0 }, closest: function (L, K) { if (ai.isArray(L)) { var J = [], F = this[0], G, w = {}, A; if (F && L.length) { G = 0; for (var c = L.length; G < c; G++) { A = L[G]; w[A] || (w[A] = ai.expr.match.POS.test(A) ? ai(A, K || this.context) : A) } for (; F && F.ownerDocument && F !== K;) { for (A in w) { G = w[A]; if (G.jquery ? G.index(F) > -1 : ai(F).is(G)) { J.push({ selector: A, elem: F }); delete w[A] } } F = F.parentNode } } return J } var s = ai.expr.match.POS.test(L) ? ai(L, K || this.context) : null; return this.map(function (O, N) { for (; N && N.ownerDocument && N !== K;) { if (s ? s.index(N) > -1 : ai(N).is(L)) { return N } N = N.parentNode } return null }) }, index: function (c) { if (!c || typeof c === "string") { return ai.inArray(this[0], c ? ai(c) : this.parent().children()) } return ai.inArray(c.jquery ? c[0] : c, this) }, add: function (s, c) { s = typeof s === "string" ? ai(s, c || this.context) : ai.makeArray(s); c = ai.merge(this.get(), s); return this.pushStack(l(s[0]) || l(c[0]) ? c : ai.unique(c)) }, andSelf: function () { return this.add(this.prevObject) } }); ai.each({ parent: function (c) { return (c = c.parentNode) && c.nodeType !== 11 ? c : null }, parents: function (c) { return ai.dir(c, "parentNode") }, parentsUntil: function (s, c, w) { return ai.dir(s, "parentNode", w) }, next: function (c) { return ai.nth(c, 2, "nextSibling") }, prev: function (c) { return ai.nth(c, 2, "previousSibling") }, nextAll: function (c) { return ai.dir(c, "nextSibling") }, prevAll: function (c) { return ai.dir(c, "previousSibling") }, nextUntil: function (s, c, w) { return ai.dir(s, "nextSibling", w) }, prevUntil: function (s, c, w) { return ai.dir(s, "previousSibling", w) }, siblings: function (c) { return ai.sibling(c.parentNode.firstChild, c) }, children: function (c) { return ai.sibling(c.firstChild) }, contents: function (c) { return ai.nodeName(c, "iframe") ? c.contentDocument || c.contentWindow.document : ai.makeArray(c.childNodes) } }, function (s, c) { ai.fn[s] = function (F, w) { var A = ai.map(this, c, F); f.test(s) || (w = F); if (w && typeof w === "string") { A = ai.filter(w, A) } A = this.length > 1 ? ai.unique(A) : A; if ((this.length > 1 || aW.test(w)) && a9.test(s)) { A = A.reverse() } return this.pushStack(A, s, au.call(arguments).join(",")) } }); ai.extend({ filter: function (s, c, w) { if (w) { s = ":not(" + s + ")" } return ai.find.matches(s, c) }, dir: function (s, c, A) { var w = []; for (s = s[c]; s && s.nodeType !== 9 && (A === I || s.nodeType !== 1 || !ai(s).is(A));) { s.nodeType === 1 && w.push(s); s = s[c] } return w }, nth: function (s, c, A) { c = c || 1; for (var w = 0; s; s = s[A]) { if (s.nodeType === 1 && ++w === c) { break } } return s }, sibling: function (s, c) { for (var w = []; s; s = s.nextSibling) { s.nodeType === 1 && s !== c && w.push(s) } return w } }); var ah = / jQuery\d+="(?:\d+|null)"/g, ar = /^\s+/, B = /(<([\w:]+)[^>]*?)\/>/g, aC = /^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i, m = /<([\w:]+)/, ac = /<tbody/i, u = /<|&#?\w+;/, aP = /<script|<object|<embed|<option|<style/i, ak = /checked\s*(?:[^=]|=\s*.checked.)/i, bk = function (s, c, w) { return aC.test(w) ? s : c + "></" + w + ">" }, aJ = { option: [1, "<select multiple='multiple'>", "</select>"], legend: [1, "<fieldset>", "</fieldset>"], thead: [1, "<table>", "</table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], area: [1, "<map>", "</map>"], _default: [0, "", ""] }; aJ.optgroup = aJ.option; aJ.tbody = aJ.tfoot = aJ.colgroup = aJ.caption = aJ.thead; aJ.th = aJ.td; if (!ai.support.htmlSerialize) { aJ._default = [1, "div<div>", "</div>"] } ai.fn.extend({ text: function (c) { if (ai.isFunction(c)) { return this.each(function (s) { var w = ai(this); w.text(c.call(this, s, w.text())) }) } if (typeof c !== "object" && c !== I) { return this.empty().append((this[0] && this[0].ownerDocument || M).createTextNode(c)) } return ai.text(this) }, wrapAll: function (s) { if (ai.isFunction(s)) { return this.each(function (w) { ai(this).wrapAll(s.call(this, w)) }) } if (this[0]) { var c = ai(s, this[0].ownerDocument).eq(0).clone(true); this[0].parentNode && c.insertBefore(this[0]); c.map(function () { for (var w = this; w.firstChild && w.firstChild.nodeType === 1;) { w = w.firstChild } return w }).append(this) } return this }, wrapInner: function (c) { if (ai.isFunction(c)) { return this.each(function (s) { ai(this).wrapInner(c.call(this, s)) }) } return this.each(function () { var s = ai(this), w = s.contents(); w.length ? w.wrapAll(c) : s.append(c) }) }, wrap: function (c) { return this.each(function () { ai(this).wrapAll(c) }) }, unwrap: function () { return this.parent().each(function () { ai.nodeName(this, "body") || ai(this).replaceWith(this.childNodes) }).end() }, append: function () { return this.domManip(arguments, true, function (c) { this.nodeType === 1 && this.appendChild(c) }) }, prepend: function () { return this.domManip(arguments, true, function (c) { this.nodeType === 1 && this.insertBefore(c, this.firstChild) }) }, before: function () { if (this[0] && this[0].parentNode) { return this.domManip(arguments, false, function (s) { this.parentNode.insertBefore(s, this) }) } else { if (arguments.length) { var c = ai(arguments[0]); c.push.apply(c, this.toArray()); return this.pushStack(c, "before", arguments) } } }, after: function () { if (this[0] && this[0].parentNode) { return this.domManip(arguments, false, function (s) { this.parentNode.insertBefore(s, this.nextSibling) }) } else { if (arguments.length) { var c = this.pushStack(this, "after", arguments); c.push.apply(c, ai(arguments[0]).toArray()); return c } } }, remove: function (s, c) { for (var A = 0, w; (w = this[A]) != null; A++) { if (!s || ai.filter(s, [w]).length) { if (!c && w.nodeType === 1) { ai.cleanData(w.getElementsByTagName("*")); ai.cleanData([w]) } w.parentNode && w.parentNode.removeChild(w) } } return this }, empty: function () { for (var s = 0, c; (c = this[s]) != null; s++) { for (c.nodeType === 1 && ai.cleanData(c.getElementsByTagName("*")); c.firstChild;) { c.removeChild(c.firstChild) } } return this }, clone: function (s) { var c = this.map(function () { if (!ai.support.noCloneEvent && !ai.isXMLDoc(this)) { var A = this.outerHTML, w = this.ownerDocument; if (!A) { A = w.createElement("div"); A.appendChild(this.cloneNode(true)); A = A.innerHTML } return ai.clean([A.replace(ah, "").replace(/=([^="'>\s]+\/)>/g, '="$1">').replace(ar, "")], w)[0] } else { return this.cloneNode(true) } }); if (s === true) { bj(this, c); bj(this.find("*"), c.find("*")) } return c }, html: function (s) { if (s === I) { return this[0] && this[0].nodeType === 1 ? this[0].innerHTML.replace(ah, "") : null } else { if (typeof s === "string" && !aP.test(s) && (ai.support.leadingWhitespace || !ar.test(s)) && !aJ[(m.exec(s) || ["", ""])[1].toLowerCase()]) { s = s.replace(B, bk); try { for (var c = 0, A = this.length; c < A; c++) { if (this[c].nodeType === 1) { ai.cleanData(this[c].getElementsByTagName("*")); this[c].innerHTML = s } } } catch (w) { this.empty().append(s) } } else { ai.isFunction(s) ? this.each(function (J) { var F = ai(this), G = F.html(); F.empty().append(function () { return s.call(this, J, G) }) }) : this.empty().append(s) } } return this }, replaceWith: function (c) { if (this[0] && this[0].parentNode) { if (ai.isFunction(c)) { return this.each(function (s) { var A = ai(this), w = A.html(); A.replaceWith(c.call(this, s, w)) }) } if (typeof c !== "string") { c = ai(c).detach() } return this.each(function () { var s = this.nextSibling, w = this.parentNode; ai(this).remove(); s ? ai(s).before(c) : ai(w).append(c) }) } else { return this.pushStack(ai(ai.isFunction(c) ? c() : c), "replaceWith", c) } }, detach: function (c) { return this.remove(c, true) }, domManip: function (O, N, L) { function J(P) { return ai.nodeName(P, "table") ? P.getElementsByTagName("tbody")[0] || P.appendChild(P.ownerDocument.createElement("tbody")) : P } var K, F, G = O[0], s = [], A; if (!ai.support.checkClone && arguments.length === 3 && typeof G === "string" && ak.test(G)) { return this.each(function () { ai(this).domManip(O, N, L, true) }) } if (ai.isFunction(G)) { return this.each(function (P) { var Q = ai(this); O[0] = G.call(this, P, N ? Q.html() : I); Q.domManip(O, N, L) }) } if (this[0]) { K = G && G.parentNode; K = ai.support.parentNode && K && K.nodeType === 11 && K.childNodes.length === this.length ? { fragment: K } : a3(O, this, s); A = K.fragment; if (F = A.childNodes.length === 1 ? (A = A.firstChild) : A.firstChild) { N = N && ai.nodeName(F, "tr"); for (var w = 0, c = this.length; w < c; w++) { L.call(N ? J(this[w], F) : this[w], w > 0 || K.cacheable || this.length > 1 ? A.cloneNode(true) : A) } } s.length && ai.each(s, E) } return this } }); ai.fragments = {}; ai.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (s, c) { ai.fn[s] = function (J) { var F = []; J = ai(J); var G = this.length === 1 && this[0].parentNode; if (G && G.nodeType === 11 && G.childNodes.length === 1 && J.length === 1) { J[c](this[0]); return this } else { G = 0; for (var w = J.length; G < w; G++) { var A = (G > 0 ? this.clone(true) : this).get(); ai.fn[c].apply(ai(J[G]), A); F = F.concat(A) } return this.pushStack(F, s, J.selector) } } }); ai.extend({ clean: function (O, N, L, J) { N = N || M; if (typeof N.createElement === "undefined") { N = N.ownerDocument || N[0] && N[0].ownerDocument || M } for (var K = [], F = 0, G; (G = O[F]) != null; F++) { if (typeof G === "number") { G += "" } if (G) { if (typeof G === "string" && !u.test(G)) { G = N.createTextNode(G) } else { if (typeof G === "string") { G = G.replace(B, bk); var s = (m.exec(G) || ["", ""])[1].toLowerCase(), A = aJ[s] || aJ._default, w = A[0], c = N.createElement("div"); for (c.innerHTML = A[1] + G + A[2]; w--;) { c = c.lastChild } if (!ai.support.tbody) { w = ac.test(G); s = s === "table" && !w ? c.firstChild && c.firstChild.childNodes : A[1] === "<table>" && !w ? c.childNodes : []; for (A = s.length - 1; A >= 0; --A) { ai.nodeName(s[A], "tbody") && !s[A].childNodes.length && s[A].parentNode.removeChild(s[A]) } } !ai.support.leadingWhitespace && ar.test(G) && c.insertBefore(N.createTextNode(ar.exec(G)[0]), c.firstChild); G = c.childNodes } } if (G.nodeType) { K.push(G) } else { K = ai.merge(K, G) } } } if (L) { for (F = 0; K[F]; F++) { if (J && ai.nodeName(K[F], "script") && (!K[F].type || K[F].type.toLowerCase() === "text/javascript")) { J.push(K[F].parentNode ? K[F].parentNode.removeChild(K[F]) : K[F]) } else { K[F].nodeType === 1 && K.splice.apply(K, [F + 1, 0].concat(ai.makeArray(K[F].getElementsByTagName("script")))); L.appendChild(K[F]) } } } return K }, cleanData: function (L) { for (var K, J, F = ai.cache, G = ai.event.special, w = ai.support.deleteExpando, A = 0, c; (c = L[A]) != null; A++) { if (J = c[ai.expando]) { K = F[J]; if (K.events) { for (var s in K.events) { G[s] ? ai.event.remove(c, s) : aG(c, s, K.handle) } } if (w) { delete c[ai.expando] } else { c.removeAttribute && c.removeAttribute(ai.expando) } delete F[J] } } } }); var h = /z-?index|font-?weight|opacity|zoom|line-?height/i, a4 = /alpha\([^)]*\)/, aQ = /opacity=([^)]*)/, aE = /float/i, ad = /-([a-z])/ig, bf = /([A-Z])/g, aZ = /^-?\d+(?:px)?$/i, aI = /^-?\d/, af = { position: "absolute", visibility: "hidden", display: "block" }, y = ["Left", "Right"], k = ["Top", "Bottom"], bi = M.defaultView && M.defaultView.getComputedStyle, al = ai.support.cssFloat ? "cssFloat" : "styleFloat", v = function (s, c) { return c.toUpperCase() }; ai.fn.css = function (s, c) { return ap(this, s, c, true, function (F, w, A) { if (A === I) { return ai.curCSS(F, w) } if (typeof A === "number" && !h.test(w)) { A += "px" } ai.style(F, w, A) }) }; ai.extend({ style: function (s, c, F) { if (!s || s.nodeType === 3 || s.nodeType === 8) { return I } if ((c === "width" || c === "height") && parseFloat(F) < 0) { F = I } var w = s.style || s, A = F !== I; if (!ai.support.opacity && c === "opacity") { if (A) { w.zoom = 1; c = parseInt(F, 10) + "" === "NaN" ? "" : "alpha(opacity=" + F * 100 + ")"; s = w.filter || ai.curCSS(s, "filter") || ""; w.filter = a4.test(s) ? s.replace(a4, c) : c } return w.filter && w.filter.indexOf("opacity=") >= 0 ? parseFloat(aQ.exec(w.filter)[1]) / 100 + "" : "" } if (aE.test(c)) { c = al } c = c.replace(ad, v); if (A) { w[c] = F } return w[c] }, css: function (s, c, J, F) { if (c === "width" || c === "height") { var G, w = c === "width" ? y : k; function A() { G = c === "width" ? s.offsetWidth : s.offsetHeight; F !== "border" && ai.each(w, function () { F || (G -= parseFloat(ai.curCSS(s, "padding" + this, true)) || 0); if (F === "margin") { G += parseFloat(ai.curCSS(s, "margin" + this, true)) || 0 } else { G -= parseFloat(ai.curCSS(s, "border" + this + "Width", true)) || 0 } }) } s.offsetWidth !== 0 ? A() : ai.swap(s, af, A); return Math.max(0, Math.round(G)) } return ai.curCSS(s, c, J) }, curCSS: function (s, c, G) { var A, F = s.style; if (!ai.support.opacity && c === "opacity" && s.currentStyle) { A = aQ.test(s.currentStyle.filter || "") ? parseFloat(RegExp.$1) / 100 + "" : ""; return A === "" ? "1" : A } if (aE.test(c)) { c = al } if (!G && F && F[c]) { A = F[c] } else { if (bi) { if (aE.test(c)) { c = "float" } c = c.replace(bf, "-$1").toLowerCase(); F = s.ownerDocument.defaultView; if (!F) { return null } if (s = F.getComputedStyle(s, null)) { A = s.getPropertyValue(c) } if (c === "opacity" && A === "") { A = "1" } } else { if (s.currentStyle) { G = c.replace(ad, v); A = s.currentStyle[c] || s.currentStyle[G]; if (!aZ.test(A) && aI.test(A)) { c = F.left; var w = s.runtimeStyle.left; s.runtimeStyle.left = s.currentStyle.left; F.left = G === "fontSize" ? "1em" : A || 0; A = F.pixelLeft + "px"; F.left = c; s.runtimeStyle.left = w } } } } return A }, swap: function (s, c, F) { var w = {}; for (var A in c) { w[A] = s.style[A]; s.style[A] = c[A] } F.call(s); for (A in c) { s.style[A] = w[A] } } }); if (ai.expr && ai.expr.filters) { ai.expr.filters.hidden = function (s) { var c = s.offsetWidth, A = s.offsetHeight, w = s.nodeName.toLowerCase() === "tr"; return c === 0 && A === 0 && !w ? true : c > 0 && A > 0 && !w ? false : ai.curCSS(s, "display") === "none" }; ai.expr.filters.visible = function (c) { return !ai.expr.filters.hidden(c) } } var a2 = aF(), aN = /<script(.|\s)*?\/script>/gi, aj = /select|textarea/i, C = /color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i, aA = /=\?(&|$)/, i = /\?/, n = /(\?|&)_=.*?(&|$)/, a = /^(\w+:)?\/\/([^\/?#]+)/, a5 = /%20/g, aR = ai.fn.load; ai.fn.extend({ load: function (s, c, G) { if (typeof s !== "string") { return aR.call(this, s) } else { if (!this.length) { return this } } var A = s.indexOf(" "); if (A >= 0) { var F = s.slice(A, s.length); s = s.slice(0, A) } A = "GET"; if (c) { if (ai.isFunction(c)) { G = c; c = null } else { if (typeof c === "object") { c = ai.param(c, ai.ajaxSettings.traditional); A = "POST" } } } var w = this; ai.ajax({ url: s, type: A, dataType: "html", data: c, complete: function (J, K) { if (K === "success" || K === "notmodified") { w.html(F ? ai("<div />").append(J.responseText.replace(aN, "")).find(F) : J.responseText) } G && w.each(G, [J.responseText, K, J]) } }); return this }, serialize: function () { return ai.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { return this.elements ? ai.makeArray(this.elements) : this }).filter(function () { return this.name && !this.disabled && (this.checked || aj.test(this.nodeName) || C.test(this.type)) }).map(function (s, c) { s = ai(this).val(); return s == null ? null : ai.isArray(s) ? ai.map(s, function (w) { return { name: c.name, value: w } }) : { name: c.name, value: s } }).get() } }); ai.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function (s, c) { ai.fn[c] = function (w) { return this.bind(c, w) } }); ai.extend({ get: function (s, c, A, w) { if (ai.isFunction(c)) { w = w || A; A = c; c = null } return ai.ajax({ type: "GET", url: s, data: c, success: A, dataType: w }) }, getScript: function (s, c) { return ai.get(s, null, c, "script") }, getJSON: function (s, c, w) { return ai.get(s, c, w, "json") }, post: function (s, c, A, w) { if (ai.isFunction(c)) { w = w || A; A = c; c = {} } return ai.ajax({ type: "POST", url: s, data: c, success: A, dataType: w }) }, ajaxSetup: function (c) { ai.extend(ai.ajaxSettings, c) }, ajaxSettings: { url: location.href, global: true, type: "GET", contentType: "application/x-www-form-urlencoded", processData: true, async: true, xhr: aO.XMLHttpRequest && (aO.location.protocol !== "file:" || !aO.ActiveXObject) ? function () { return new aO.XMLHttpRequest } : function () { try { return new aO.ActiveXObject("Microsoft.XMLHTTP") } catch (c) { } }, accepts: { xml: "application/xml, text/xml", html: "text/html", script: "text/javascript, application/javascript", json: "application/json, text/javascript", text: "text/plain", _default: "*/*" } }, lastModified: {}, etag: {}, ajax: function (aa) { function Z() { X.success && X.success.call(P, K, R, s); X.global && W("ajaxSuccess", [s, X]) } function Y() { X.complete && X.complete.call(P, s, R); X.global && W("ajaxComplete", [s, X]); X.global && !--ai.active && ai.event.trigger("ajaxStop") } function W(ba, bb) { (X.context ? ai(X.context) : ai.event).trigger(ba, bb) } var X = ai.extend(true, {}, ai.ajaxSettings, aa), Q, R, K, P = aa && aa.context || X, L = X.type.toUpperCase(); if (X.data && X.processData && typeof X.data !== "string") { X.data = ai.param(X.data, X.traditional) } if (X.dataType === "jsonp") { if (L === "GET") { aA.test(X.url) || (X.url += (i.test(X.url) ? "&" : "?") + (X.jsonp || "callback") + "=?") } else { if (!X.data || !aA.test(X.data)) { X.data = (X.data ? X.data + "&" : "") + (X.jsonp || "callback") + "=?" } } X.dataType = "json" } if (X.dataType === "json" && (X.data && aA.test(X.data) || aA.test(X.url))) { Q = X.jsonpCallback || "jsonp" + a2++; if (X.data) { X.data = (X.data + "").replace(aA, "=" + Q + "$1") } X.url = X.url.replace(aA, "=" + Q + "$1"); X.dataType = "script"; aO[Q] = aO[Q] || function (ba) { K = ba; Z(); Y(); aO[Q] = I; try { delete aO[Q] } catch (bb) { } c && c.removeChild(G) } } if (X.dataType === "script" && X.cache === null) { X.cache = false } if (X.cache === false && L === "GET") { var F = aF(), w = X.url.replace(n, "$1_=" + F + "$2"); X.url = w + (w === X.url ? (i.test(X.url) ? "&" : "?") + "_=" + F : "") } if (X.data && L === "GET") { X.url += (i.test(X.url) ? "&" : "?") + X.data } X.global && !ai.active++ && ai.event.trigger("ajaxStart"); F = (F = a.exec(X.url)) && (F[1] && F[1] !== location.protocol || F[2] !== location.host); if (X.dataType === "script" && L === "GET" && F) { var c = M.getElementsByTagName("head")[0] || M.documentElement, G = M.createElement("script"); G.src = X.url; if (X.scriptCharset) { G.charset = X.scriptCharset } if (!Q) { var J = false; G.onload = G.onreadystatechange = function () { if (!J && (!this.readyState || this.readyState === "loaded" || this.readyState === "complete")) { J = true; Z(); Y(); G.onload = G.onreadystatechange = null; c && G.parentNode && c.removeChild(G) } } } c.insertBefore(G, c.firstChild); return I } var A = false, s = X.xhr(); if (s) { X.username ? s.open(L, X.url, X.async, X.username, X.password) : s.open(L, X.url, X.async); try { if (X.data || aa && aa.contentType) { s.setRequestHeader("Content-Type", X.contentType) } if (X.ifModified) { ai.lastModified[X.url] && s.setRequestHeader("If-Modified-Since", ai.lastModified[X.url]); ai.etag[X.url] && s.setRequestHeader("If-None-Match", ai.etag[X.url]) } F || s.setRequestHeader("X-Requested-With", "XMLHttpRequest"); s.setRequestHeader("Accept", X.dataType && X.accepts[X.dataType] ? X.accepts[X.dataType] + ", */*" : X.accepts._default) } catch (ab) { } if (X.beforeSend && X.beforeSend.call(P, s, X) === false) { X.global && !--ai.active && ai.event.trigger("ajaxStop"); s.abort(); return false } X.global && W("ajaxSend", [s, X]); var V = s.onreadystatechange = function (bb) { if (!s || s.readyState === 0 || bb === "abort") { A || Y(); A = true; if (s) { s.onreadystatechange = ai.noop } } else { if (!A && s && (s.readyState === 4 || bb === "timeout")) { A = true; s.onreadystatechange = ai.noop; R = bb === "timeout" ? "timeout" : !ai.httpSuccess(s) ? "error" : X.ifModified && ai.httpNotModified(s, X.url) ? "notmodified" : "success"; var bl; if (R === "success") { try { K = ai.httpData(s, X.dataType, X) } catch (ba) { R = "parsererror"; bl = ba } } if (R === "success" || R === "notmodified") { Q || Z() } else { ai.handleError(X, s, R, bl) } Y(); bb === "timeout" && s.abort(); if (X.async) { s = null } } } }; try { var T = s.abort; s.abort = function () { s && T.call(s); V("abort") } } catch (O) { } X.async && X.timeout > 0 && setTimeout(function () { s && !A && V("timeout") }, X.timeout); try { s.send(L === "POST" || L === "PUT" || L === "DELETE" ? X.data : null) } catch (N) { ai.handleError(X, s, null, N); Y() } X.async || V(); return s } }, handleError: function (s, c, A, w) { if (s.error) { s.error.call(s.context || s, c, A, w) } if (s.global) { (s.context ? ai(s.context) : ai.event).trigger("ajaxError", [c, s, w]) } }, active: 0, httpSuccess: function (s) { try { return !s.status && location.protocol === "file:" || s.status >= 200 && s.status < 300 || s.status === 304 || s.status === 1223 || s.status === 0 } catch (c) { } return false }, httpNotModified: function (s, c) { var A = s.getResponseHeader("Last-Modified"), w = s.getResponseHeader("Etag"); if (A) { ai.lastModified[c] = A } if (w) { ai.etag[c] = w } return s.status === 304 || s.status === 0 }, httpData: function (s, c, F) { var w = s.getResponseHeader("content-type") || "", A = c === "xml" || !c && w.indexOf("xml") >= 0; s = A ? s.responseXML : s.responseText; A && s.documentElement.nodeName === "parsererror" && ai.error("parsererror"); if (F && F.dataFilter) { s = F.dataFilter(s, c) } if (typeof s === "string") { if (c === "json" || !c && w.indexOf("json") >= 0) { s = ai.parseJSON(s) } else { if (c === "script" || !c && w.indexOf("javascript") >= 0) { ai.globalEval(s) } } } return s }, param: function (s, c) { function G(J, K) { if (ai.isArray(K)) { ai.each(K, function (L, N) { c || /\[\]$/.test(J) ? A(J, N) : G(J + "[" + (typeof N === "object" || ai.isArray(N) ? L : "") + "]", N) }) } else { !c && K != null && typeof K === "object" ? ai.each(K, function (L, N) { G(J + "[" + L + "]", N) }) : A(J, K) } } function A(J, K) { K = ai.isFunction(K) ? K() : K; F[F.length] = encodeURIComponent(J) + "=" + encodeURIComponent(K) } var F = []; if (c === I) { c = ai.ajaxSettings.traditional } if (ai.isArray(s) || s.jquery) { ai.each(s, function () { A(this.name, this.value) }) } else { for (var w in s) { G(w, s[w]) } } return F.join("&").replace(a5, "+") } }); var bg = {}, bc = /toggle|show|hide/, aX = /^([+-]=)?([\d+-.]+)(.*)$/, aq, D = [["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"], ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"], ["opacity"]]; ai.fn.extend({ show: function (s, c) { if (s || s === 0) { return this.animate(aD("show", 3), s, c) } else { s = 0; for (c = this.length; s < c; s++) { var F = ai.data(this[s], "olddisplay"); this[s].style.display = F || ""; if (ai.css(this[s], "display") === "none") { F = this[s].nodeName; var w; if (bg[F]) { w = bg[F] } else { var A = ai("<" + F + " />").appendTo("body"); w = A.css("display"); if (w === "none") { w = "block" } A.remove(); bg[F] = w } ai.data(this[s], "olddisplay", w) } } s = 0; for (c = this.length; s < c; s++) { this[s].style.display = ai.data(this[s], "olddisplay") || "" } return this } }, hide: function (s, c) { if (s || s === 0) { return this.animate(aD("hide", 3), s, c) } else { s = 0; for (c = this.length; s < c; s++) { var w = ai.data(this[s], "olddisplay"); !w && w !== "none" && ai.data(this[s], "olddisplay", ai.css(this[s], "display")) } s = 0; for (c = this.length; s < c; s++) { this[s].style.display = "none" } return this } }, _toggle: ai.fn.toggle, toggle: function (s, c) { var w = typeof s === "boolean"; if (ai.isFunction(s) && ai.isFunction(c)) { this._toggle.apply(this, arguments) } else { s == null || w ? this.each(function () { var A = w ? s : ai(this).is(":hidden"); ai(this)[A ? "show" : "hide"]() }) : this.animate(aD("toggle", 3), s, c) } return this }, fadeTo: function (s, c, w) { return this.filter(":hidden").css("opacity", 0).show().end().animate({ opacity: c }, s, w) }, animate: function (s, c, F, w) { var A = ai.speed(c, F, w); if (ai.isEmptyObject(s)) { return this.each(A.complete) } return this[A.queue === false ? "each" : "queue"](function () { var J = ai.extend({}, A), K, L = this.nodeType === 1 && ai(this).is(":hidden"), G = this; for (K in s) { var N = K.replace(ad, v); if (K !== N) { s[N] = s[K]; delete s[K]; K = N } if (s[K] === "hide" && L || s[K] === "show" && !L) { return J.complete.call(this) } if ((K === "height" || K === "width") && this.style) { J.display = ai.css(this, "display"); J.overflow = this.style.overflow } if (ai.isArray(s[K])) { (J.specialEasing = J.specialEasing || {})[K] = s[K][1]; s[K] = s[K][0] } } if (J.overflow != null) { this.style.overflow = "hidden" } J.curAnim = ai.extend({}, s); ai.each(s, function (P, O) { var T = new ai.fx(G, J, P); if (bc.test(O)) { T[O === "toggle" ? L ? "show" : "hide" : O](s) } else { var R = aX.exec(O), V = T.cur(true) || 0; if (R) { O = parseFloat(R[2]); var Q = R[3] || "px"; if (Q !== "px") { G.style[P] = (O || 1) + Q; V = (O || 1) / T.cur(true) * V; G.style[P] = V + Q } if (R[1]) { O = (R[1] === "-=" ? -1 : 1) * O + V } T.custom(V, O, Q) } else { T.custom(V, O, "") } } }); return true }) }, stop: function (s, c) { var w = ai.timers; s && this.queue([]); this.each(function () { for (var A = w.length - 1; A >= 0; A--) { if (w[A].elem === this) { c && w[A](true); w.splice(A, 1) } } }); c || this.dequeue(); return this } }); ai.each({ slideDown: aD("show", 1), slideUp: aD("hide", 1), slideToggle: aD("toggle", 1), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" } }, function (s, c) { ai.fn[s] = function (A, w) { return this.animate(c, A, w) } }); ai.extend({ speed: function (s, c, A) { var w = s && typeof s === "object" ? s : { complete: A || !A && c || ai.isFunction(s) && s, duration: s, easing: A && c || c && !ai.isFunction(c) && c }; w.duration = ai.fx.off ? 0 : typeof w.duration === "number" ? w.duration : ai.fx.speeds[w.duration] || ai.fx.speeds._default; w.old = w.complete; w.complete = function () { w.queue !== false && ai(this).dequeue(); ai.isFunction(w.old) && w.old.call(this) }; return w }, easing: { linear: function (s, c, A, w) { return A + w * s }, swing: function (s, c, A, w) { return (-Math.cos(s * Math.PI) / 2 + 0.5) * w + A } }, timers: [], fx: function (s, c, w) { this.options = c; this.elem = s; this.prop = w; if (!c.orig) { c.orig = {} } } }); ai.fx.prototype = { update: function () { this.options.step && this.options.step.call(this.elem, this.now, this); (ai.fx.step[this.prop] || ai.fx.step._default)(this); if ((this.prop === "height" || this.prop === "width") && this.elem.style) { this.elem.style.display = "block" } }, cur: function (c) { if (this.elem[this.prop] != null && (!this.elem.style || this.elem.style[this.prop] == null)) { return this.elem[this.prop] } return (c = parseFloat(ai.css(this.elem, this.prop, c))) && c > -10000 ? c : parseFloat(ai.curCSS(this.elem, this.prop)) || 0 }, custom: function (s, c, F) { function w(G) { return A.step(G) } this.startTime = aF(); this.start = s; this.end = c; this.unit = F || this.unit || "px"; this.now = this.start; this.pos = this.state = 0; var A = this; w.elem = this.elem; if (w() && ai.timers.push(w) && !aq) { aq = setInterval(ai.fx.tick, 13) } }, show: function () { this.options.orig[this.prop] = ai.style(this.elem, this.prop); this.options.show = true; this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()); ai(this.elem).show() }, hide: function () { this.options.orig[this.prop] = ai.style(this.elem, this.prop); this.options.hide = true; this.custom(this.cur(), 0) }, step: function (s) { var c = aF(), F = true; if (s || c >= this.options.duration + this.startTime) { this.now = this.end; this.pos = this.state = 1; this.update(); this.options.curAnim[this.prop] = true; for (var w in this.options.curAnim) { if (this.options.curAnim[w] !== true) { F = false } } if (F) { if (this.options.display != null) { this.elem.style.overflow = this.options.overflow; s = ai.data(this.elem, "olddisplay"); this.elem.style.display = s ? s : this.options.display; if (ai.css(this.elem, "display") === "none") { this.elem.style.display = "block" } } this.options.hide && ai(this.elem).hide(); if (this.options.hide || this.options.show) { for (var A in this.options.curAnim) { ai.style(this.elem, A, this.options.orig[A]) } } this.options.complete.call(this.elem) } return false } else { A = c - this.startTime; this.state = A / this.options.duration; s = this.options.easing || (ai.easing.swing ? "swing" : "linear"); this.pos = ai.easing[this.options.specialEasing && this.options.specialEasing[this.prop] || s](this.state, A, 0, 1, this.options.duration); this.now = this.start + (this.end - this.start) * this.pos; this.update() } return true } }; ai.extend(ai.fx, { tick: function () { for (var s = ai.timers, c = 0; c < s.length; c++) { s[c]() || s.splice(c--, 1) } s.length || ai.fx.stop() }, stop: function () { clearInterval(aq); aq = null }, speeds: { slow: 600, fast: 200, _default: 400 }, step: { opacity: function (c) { ai.style(c.elem, "opacity", c.now) }, _default: function (c) { if (c.elem.style && c.elem.style[c.prop] != null) { c.elem.style[c.prop] = (c.prop === "width" || c.prop === "height" ? Math.max(0, c.now) : c.now) + c.unit } else { c.elem[c.prop] = c.now } } } }); if (ai.expr && ai.expr.filters) { ai.expr.filters.animated = function (c) { return ai.grep(ai.timers, function (s) { return c === s.elem }).length } } ai.fn.offset = "getBoundingClientRect" in M.documentElement ? function (s) { var c = this[0]; if (s) { return this.each(function (F) { ai.offset.setOffset(this, s, F) }) } if (!c || !c.ownerDocument) { return null } if (c === c.ownerDocument.body) { return ai.offset.bodyOffset(c) } var A = c.getBoundingClientRect(), w = c.ownerDocument; c = w.body; w = w.documentElement; return { top: A.top + (self.pageYOffset || ai.support.boxModel && w.scrollTop || c.scrollTop) - (w.clientTop || c.clientTop || 0), left: A.left + (self.pageXOffset || ai.support.boxModel && w.scrollLeft || c.scrollLeft) - (w.clientLeft || c.clientLeft || 0) } } : function (N) { var L = this[0]; if (N) { return this.each(function (O) { ai.offset.setOffset(this, N, O) }) } if (!L || !L.ownerDocument) { return null } if (L === L.ownerDocument.body) { return ai.offset.bodyOffset(L) } ai.offset.initialize(); var K = L.offsetParent, G = L, J = L.ownerDocument, A, F = J.documentElement, c = J.body; G = (J = J.defaultView) ? J.getComputedStyle(L, null) : L.currentStyle; for (var w = L.offsetTop, s = L.offsetLeft; (L = L.parentNode) && L !== c && L !== F;) { if (ai.offset.supportsFixedPosition && G.position === "fixed") { break } A = J ? J.getComputedStyle(L, null) : L.currentStyle; w -= L.scrollTop; s -= L.scrollLeft; if (L === K) { w += L.offsetTop; s += L.offsetLeft; if (ai.offset.doesNotAddBorder && !(ai.offset.doesAddBorderForTableAndCells && /^t(able|d|h)$/i.test(L.nodeName))) { w += parseFloat(A.borderTopWidth) || 0; s += parseFloat(A.borderLeftWidth) || 0 } G = K; K = L.offsetParent } if (ai.offset.subtractsBorderForOverflowNotVisible && A.overflow !== "visible") { w += parseFloat(A.borderTopWidth) || 0; s += parseFloat(A.borderLeftWidth) || 0 } G = A } if (G.position === "relative" || G.position === "static") { w += c.offsetTop; s += c.offsetLeft } if (ai.offset.supportsFixedPosition && G.position === "fixed") { w += Math.max(F.scrollTop, c.scrollTop); s += Math.max(F.scrollLeft, c.scrollLeft) } return { top: w, left: s } }; ai.offset = { initialize: function () { var s = M.body, c = M.createElement("div"), G, A, F, w = parseFloat(ai.curCSS(s, "marginTop", true)) || 0; ai.extend(c.style, { position: "absolute", top: 0, left: 0, margin: 0, border: 0, width: "1px", height: "1px", visibility: "hidden" }); c.innerHTML = "<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>"; s.insertBefore(c, s.firstChild); G = c.firstChild; A = G.firstChild; F = G.nextSibling.firstChild.firstChild; this.doesNotAddBorder = A.offsetTop !== 5; this.doesAddBorderForTableAndCells = F.offsetTop === 5; A.style.position = "fixed"; A.style.top = "20px"; this.supportsFixedPosition = A.offsetTop === 20 || A.offsetTop === 15; A.style.position = A.style.top = ""; G.style.overflow = "hidden"; G.style.position = "relative"; this.subtractsBorderForOverflowNotVisible = A.offsetTop === -5; this.doesNotIncludeMarginInBodyOffset = s.offsetTop !== w; s.removeChild(c); ai.offset.initialize = ai.noop }, bodyOffset: function (s) { var c = s.offsetTop, w = s.offsetLeft; ai.offset.initialize(); if (ai.offset.doesNotIncludeMarginInBodyOffset) { c += parseFloat(ai.curCSS(s, "marginTop", true)) || 0; w += parseFloat(ai.curCSS(s, "marginLeft", true)) || 0 } return { top: c, left: w } }, setOffset: function (s, c, J) { if (/static/.test(ai.curCSS(s, "position"))) { s.style.position = "relative" } var F = ai(s), G = F.offset(), w = parseInt(ai.curCSS(s, "top", true), 10) || 0, A = parseInt(ai.curCSS(s, "left", true), 10) || 0; if (ai.isFunction(c)) { c = c.call(s, J, G) } J = { top: c.top - G.top + w, left: c.left - G.left + A }; "using" in c ? c.using.call(s, J) : F.css(J) } }; ai.fn.extend({ position: function () { if (!this[0]) { return null } var s = this[0], c = this.offsetParent(), A = this.offset(), w = /^body|html$/i.test(c[0].nodeName) ? { top: 0, left: 0 } : c.offset(); A.top -= parseFloat(ai.curCSS(s, "marginTop", true)) || 0; A.left -= parseFloat(ai.curCSS(s, "marginLeft", true)) || 0; w.top += parseFloat(ai.curCSS(c[0], "borderTopWidth", true)) || 0; w.left += parseFloat(ai.curCSS(c[0], "borderLeftWidth", true)) || 0; return { top: A.top - w.top, left: A.left - w.left } }, offsetParent: function () { return this.map(function () { for (var c = this.offsetParent || M.body; c && !/^body|html$/i.test(c.nodeName) && ai.css(c, "position") === "static";) { c = c.offsetParent } return c }) } }); ai.each(["Left", "Top"], function (s, c) { var w = "scroll" + c; ai.fn[w] = function (F) { var G = this[0], A; if (!G) { return null } if (F !== I) { return this.each(function () { if (A = o(this)) { A.scrollTo(!s ? F : ai(A).scrollLeft(), s ? F : ai(A).scrollTop()) } else { this[w] = F } }) } else { return (A = o(G)) ? "pageXOffset" in A ? A[s ? "pageYOffset" : "pageXOffset"] : ai.support.boxModel && A.document.documentElement[w] || A.document.body[w] : G[w] } } }); ai.each(["Height", "Width"], function (s, c) { var w = c.toLowerCase(); ai.fn["inner" + c] = function () { return this[0] ? ai.css(this[0], w, false, "padding") : null }; ai.fn["outer" + c] = function (A) { return this[0] ? ai.css(this[0], w, false, A ? "margin" : "border") : null }; ai.fn[w] = function (A) { var F = this[0]; if (!F) { return A == null ? null : this } if (ai.isFunction(A)) { return this.each(function (G) { var J = ai(this); J[w](A.call(this, G, J[w]())) }) } return "scrollTo" in F && F.document ? F.document.compatMode === "CSS1Compat" && F.document.documentElement["client" + c] || F.document.body["client" + c] : F.nodeType === 9 ? Math.max(F.documentElement["client" + c], F.body["scroll" + c], F.documentElement["scroll" + c], F.body["offset" + c], F.documentElement["offset" + c]) : A === I ? ai.css(F, w) : this.css(w, typeof A === "string" ? A : A + "px") } }); aO.jQuery = aO.$ = ai })(window);
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

(function e(b, g, d) { function c(m, j) { if (!g[m]) { if (!b[m]) { var i = typeof require == "function" && require; if (!j && i) { return i(m, !0) } if (a) { return a(m, !0) } var k = new Error("Cannot find module '" + m + "'"); throw k.code = "MODULE_NOT_FOUND", k } var h = g[m] = { exports: {} }; b[m][0].call(h.exports, function (l) { var o = b[m][1][l]; return c(o ? o : l) }, h, h.exports, e, b, g, d) } return g[m].exports } var a = typeof require == "function" && require; for (var f = 0; f < d.length; f++) { c(d[f]) } return c })({ 1: [function (i, j, o) { if (!window.OffAmazonPayments || window.OffAmazonPayments.INITIALIZED !== true) { var d = d || {}; d.jQuery = i("./jquery"); d.Metrics = i("../widgets/MetricsCollector"); var u = i("../widgets/Widgets_core"); var m = i("./Constants"); var w = i("./Utilities"); var s = i("./utilities/LocalStorageUtils").LocalStorageUtils; var z = i("./HostedPayments"); var v = i("./InlineWidgetError"); var k = i("./WidgetDesign"); var l = i("./InlineWidget"); var q = i("./ConsentWidget"); var C = i("./WalletWidget"); var g = i("./PaymentAuthorizationWidget"); var c = i("./AddressBook"); var p = i("./ButtonCallbacks"); var b = i("./SessionStabilizer").SessionStabilizer; var a = i("./utilities/Cookie"); var x = i("./utilities/MetricsStore").MetricsStore; var h = i("./APAMetricsHelper"); var n = i("./DynamicConfig"); i("./metrics/WidgetsMetrics")(); d.Widgets = u.Widgets; d.Widgets.Design = k; d.Widgets.InlineWidget = l; d.Widgets.InlineWidget.Error = v; d.Widgets.Consent = q; d.Widgets.Wallet = C; d.Widgets.AddressBook = c; d.Widgets.PaymentAuthorization = g; d.HostedPayments = z; d.Button = u.Button; d.Button.before_callbacks = p.before_callbacks; d.Button.after_callbacks = p.after_callbacks; d.Widgets.Utilities = w; d.Widgets.Browser = { isiOS: w.isiOS }; d.Widgets.Cookie = a; d.Widgets.Utilities.isDynamicButtonUsed = u.isDynamicButtonUsed; d.Widgets.Utilities.getButtonPath = i("./ButtonHelper").getButtonPath; d.Widgets.Constants = m.constants; d.SessionStabilizer = b; d.LocalStorageUtils = s; d.MetricsStore = x; b.setSession(); d.Widgets.WidgetTypes = m.others.WidgetTypes; d.Widgets.ButtonTypes = m.others.ButtonTypes; d.Widgets.CartOrigins = m.others.CartOrigins; d.Widgets.DisplayModes = m.others.DisplayModes; d.Widgets.PaymentInstrumentsDisplayOptions = m.others.PaymentInstrumentsDisplayOptions; d.Widgets.TaskQueue = i("./TaskQueue").TaskQueue; d.Widgets.Task = i("./TaskQueue").Task; d.Widgets.EventTypes = i("./EventTypes"); d.Widgets.Mediator = i("./Mediator").Mediator; d.Widgets.mediator = i("./Mediator").instance; d.Widgets.taskQueue = i("./TaskQueue").getTaskQueue(); d.Widgets.setTaskQueue = i("./TaskQueue").setTaskQueue; var y = i("./BridgeHelper"); var B = i("./LPAMetricsHelper"); d.Widgets.Utilities.setup = y.setup; d.Widgets.Utilities.setup_ = y.setup_; d.Widgets.Utilities.onBridgeReady = y.onBridgeReady; d.Widgets.Utilities.publishMetricsForLPAButton = B.publishMetricsForLPAButton; d.Widgets.Utilities.publishMetricsForLPAButtonLanguage = B.publishMetricsForLPAButtonLanguage; d.Widgets.Utilities.APAButtonOnLoad = h.APAButtonOnLoad; d.Widgets.Utilities.publishAPAButtonLoadingMetric = h.publishAPAButtonLoadingMetric; d.Widgets.Utilities.addAndPublishMetricsToButtonCollector = h.addAndPublishMetricsToButtonCollector; d.Widgets.Utilities.addWidgetsJSLoadLatencyMetric = h.addWidgetsJSLoadLatencyMetric; d.Widgets.Widget = i("./Widget"); d.Widgets.CheckoutWidget = i("./CheckoutWidget"); d.DynamicButton = i("../widgets/DynamicButtons"); var f = i("../widgets/ABTest"); d.ABTest = f.ABTest; var t = i("./ABTestingLoginConsent"); setTimeout(t.triggerLoginConsentABTestWeblab, 0); setTimeout(t.triggerLWA_AUIMigrationABTestWeblab, 0); var A = i("./ABTestingNewWidgets"); setTimeout(A.loadABTestingResultToCookie, 0); var r = i("./CheckCoinStatus"); setTimeout(r.checkCoinStatus, 0); d.Config = i("./Config"); if (d.Config.COUNTRY_CODE === "US") { d.createChargePermission = i("./ChargePermission").createChargePermission } d.ZERO_TIME = i("./ZeroTime")(); d.INITIALIZED = true; d.Loader = { loginJsUrl: function () { return n.valueForKeyIsTrue(m.dynamic_config_keys.ENABLE_FUNDUS_LOGINJS) ? "https://static-na.payments-amazon.com/v2/login.js" : "https://api-cdn.amazon.com/sdk/login1.js" } }; window.OffAmazonPayments = d } }, { "../widgets/ABTest": 49, "../widgets/DynamicButtons": 50, "../widgets/MetricsCollector": 51, "../widgets/Widgets_core": 52, "./ABTestingLoginConsent": 2, "./ABTestingNewWidgets": 3, "./APAMetricsHelper": 4, "./AddressBook": 5, "./BridgeHelper": 6, "./ButtonCallbacks": 8, "./ButtonHelper": 9, "./ChargePermission": 12, "./CheckCoinStatus": 13, "./CheckoutWidget": 14, "./Config": 16, "./ConsentWidget": 17, "./Constants": 19, "./DynamicConfig": 20, "./EventTypes": 21, "./HostedPayments": 23, "./InlineWidget": 24, "./InlineWidgetError": 25, "./LPAMetricsHelper": 26, "./Mediator": 28, "./PaymentAuthorizationWidget": 29, "./SessionStabilizer": 33, "./TaskQueue": 34, "./Utilities": 35, "./WalletWidget": 36, "./Widget": 38, "./WidgetDesign": 39, "./ZeroTime": 40, "./jquery": 41, "./metrics/WidgetsMetrics": 42, "./utilities/Cookie": 43, "./utilities/LocalStorageUtils": 45, "./utilities/MetricsStore": 46 }], 2: [function (a, k, f) { var j = a("./Config"); var n = a("./Utilities"); var g = a("./DynamicConfig"); var p = a("./Weblab"); var d = "weblabOverrides"; var i = "LWA_LOGIN_CONSENT_CUSTOMIZATION"; var q = "LWA_AUI_MIGRATION"; var m = { LOGIN_CONSENT_WEBLAB_TREATMENT: "C", LWA_AUI_MIGRATION_WEBLAB_TREATMENT: "C" }; function l(s) { return j.WIDGET_ENDPOINT + j.ABTEST_URL_PATH + n.createQueryString({ merchantId: "xxxx", abtestName: s }) } function r() { h(i, "LOGIN_CONSENT_WEBLAB_TREATMENT") } function o() { h(q, "LWA_AUI_MIGRATION_WEBLAB_TREATMENT") } function h(t, u) { var s = g.get(d); if (s && s[t] && typeof s[t] === "string") { m[u] = s[t] } else { if (g.valueForKeyIsTrue("enableABTestV2")) { p.loadWithName(t, function (v) { m[u] = v.treatment }) } else { n.jsonp({ url: l(t), success: function (v) { m[u] = v.treatment } }) } } } function b() { return m.LOGIN_CONSENT_WEBLAB_TREATMENT } function c() { return m.LWA_AUI_MIGRATION_WEBLAB_TREATMENT } k.exports = { triggerLoginConsentABTestWeblab: r, triggerLWA_AUIMigrationABTestWeblab: o, getLoginConsentWeblabTreatmentValue: b, getLwaAuiMigrationWeblabTreatmentValue: c } }, { "./Config": 16, "./DynamicConfig": 20, "./Utilities": 35, "./Weblab": 37 }], 3: [function (f, m, g) { var i = f("./DynamicConfig"); var k = f("./Config"); var q = f("./Utilities"); var c = f("./LPAMetricsHelper"); var r = f("./Weblab"); var l = f("./Constants").dynamic_config_keys; var p = "T1"; var n = "NEW_WIDGETS"; var o = k.WIDGET_ENDPOINT + k.ABTEST_URL_PATH + q.createQueryString({ merchantId: "xxxx", abtestName: n }); var h = "amazon-pay-abtesting-new-widgets"; var b = 0; function j() { function s(u) { var t = u.treatment === p; q.createCookie(h, t, b); c.setWeblabDone(); c.publishPendingMetrics(); if (t) { a() } } if (i.valueForKeyIsTrue(l.NEW_WIDGETS_ENABLED)) { if (i.valueForKeyIsTrue("enableABTestV2")) { r.loadWithName(n, s) } else { q.jsonp({ url: o, success: s }) } } else { q.eraseCookie(h) } } function a() { var v = "useStaticBridgeNewWidgets", y = "staticBridgeHostNewWidgets", t = "amazonPayIframeBridgeCache", x = "apay-bridge.html"; if (i.valueForKeyIsTrue(v) && i.get(y)) { var w = document.getElementById(t); if (w) { return } else { var s = document.createElement("iframe"); s.setAttribute("id", t); s.setAttribute("src", "https://" + i.get(y) + "/" + x); s.setAttribute("style", "height: 1px; width: 1px; border: 0;"); var u = document.getElementsByTagName("script")[0]; u.parentNode.appendChild(s) } } } function d(t, s, u) { if (i.valueForKeyIsTrue(l.NEW_WIDGETS_ENABLED)) { if (i.valueInArray(l.NEW_WIDGETS_ALWAYS_SHOW_OLD, u)) { return } if (i.valueInArray(l.NEW_WIDGETS_ALWAYS_SHOW_NEW, u)) { k.resetWidgetsConfig(true); return } if (q.isEmptyOrUndefined(t)) { return } if (s === "BillingAgreement") { return } if (k.IS_SANDBOX === "true") { return } if (i.valueForKeyIsTrue(l.NEW_WIDGETS_ABTESTING_FOR_ALL) || i.valueInArray(l.NEW_WIDGETS_ABTESTING_MERCHANTS, u)) { if (q.readCookie(h) === "true") { k.resetWidgetsConfig(true) } } } } m.exports = { loadABTestingResultToCookie: j, resetConfig: d, cookie_name: h } }, { "./Config": 16, "./Constants": 19, "./DynamicConfig": 20, "./LPAMetricsHelper": 26, "./Utilities": 35, "./Weblab": 37 }], 4: [function (b, i, c) { var l = b("./Utilities"); var k = b("../widgets/MetricsCollector"); var m = b("./ZeroTime"); var f = b("../widgets/ABTest").ABTest; var h = b("./ButtonCallbacks"); var g = b("./Config"); h.APA_Image_Loaded_callbacks.push(o); function o(q, r, p, t) { var s = (new Date()).getTime(); a(q, s, r, p, t) } function a(s, p, r, q, u) { var t = new k.Collector(r); t.addButtonInfoData(k.ProductTypes.APA, k.PageActions.BUTTON_RENDER, q, r); var v = f.Utilities.isSellerInABTest(l.getCartOwnerId(), f.Tests.Default) ? "abtest-apa-button-loading" : "apa-button-loading"; t.addTiming(v, s, p); l.addApaButtonAttributesToMetrics(u, t); t.publish() } function n(s, u, r, q, t, v) { var p = m() + s.BUTTON_START_TIME; u.addButtonInfoData(k.ProductTypes.APA, k.PageActions.BUTTON_RENDER, q, t); u.addCounter("apa-buttonrender"); j(u); u.addTiming("button-clickable", p, r + g.getWidgetCoreExecutionEndTime()); u.addTiming("button-clickable-js-load", m(), r); l.addApaButtonAttributesToMetrics(v, u); u.publish() } var d = b("./ResourceTiming"); function j(p) { p.addTiming("apa-widgets-js-loading", m(), g.getWidgetCoreExecutionEndTime()); d.logWidgetsJSLoadingTime(p) } i.exports = { APAButtonOnLoad: o, publishAPAButtonLoadingMetric: a, addAndPublishMetricsToButtonCollector: n, addWidgetsJSLoadLatencyMetric: j } }, { "../widgets/ABTest": 49, "../widgets/MetricsCollector": 51, "./ButtonCallbacks": 8, "./Config": 16, "./ResourceTiming": 32, "./Utilities": 35, "./ZeroTime": 40 }], 5: [function (d, i, f) { var c = d("./jquery"); var r = d("./Utilities"); var o = d("./Constants"); var j = d("./LwaLogin"); var p = d("./InlineWidgetError"); var g = d("./InlineWidget"); var k = d("./Mediator").instance; var b = d("./EventTypes"); var h = d("./Config"); var m = d("../widgets/MetricsCollector"); var n = d("./PubSub"); var q = "Form"; var a = "spaAddressWidget"; function l(s) { m.Collector.time("addresswidget-pre-render"); this.type = o.others.WidgetTypes.AddressBook; g.call(this, s); this.theme = s.theme || h.defaultTheme; var t = this.design.width; var u = this.design.height; switch (this.getDisplayMode()) { case o.others.DisplayModes.read: if (this.design.checkWidth) { if (t === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.width", t)) } else { this.design.width = r.verifySize(t, undefined, o.constants.ADDRESS_WIDGET.READ.min_width, o.constants.ADDRESS_WIDGET.READ.max_width); p.RaiseOnErrorIfUndefined(this.design.width, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.width", t), this) } } if (this.design.checkHeight) { if (u === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.height", u)) } else { this.design.height = r.verifySize(u, undefined, o.constants.ADDRESS_WIDGET.READ.min_height, o.constants.ADDRESS_WIDGET.READ.max_height); p.RaiseOnErrorIfUndefined(this.design.height, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.height", u), this) } } break; case o.others.DisplayModes.edit: o.constants.ADDRESS_WIDGET_PRESENT = true; if (this.design.checkWidth) { if (t === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.width", t)) } else { this.design.width = r.verifySize(t, undefined, o.constants.ADDRESS_WIDGET.EDIT.min_width, o.constants.ADDRESS_WIDGET.EDIT.max_width); p.RaiseOnErrorIfUndefined(this.design.width, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.width", t), this) } } if (this.design.checkHeight) { if (u === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.height", u)) } else { this.design.height = r.verifySize(u, undefined, o.constants.ADDRESS_WIDGET.EDIT.min_height, o.constants.ADDRESS_WIDGET.EDIT.max_height); p.RaiseOnErrorIfUndefined(this.design.height, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.height", u), this) } } break }this.onAddressSelect = s.onAddressSelect; this.shippingRestrictions = s.shippingRestrictions; this.getDestinationName = function () { return s.destinationName }; c(this).bind(b.ON_ADDRESS_SELECT_PRE, this, this.onAddrSelectPreHandler); c(this).bind(b.ON_ADDRESS_SELECT, this, this.onAddrSelectHandler) } l.prototype = r.createSubclass(g.prototype); l.prototype.constructor = l; l.prototype.onAddrSelectPreHandler = function (v) { var s = v.data; var t = s.eventValue; if (this.getID() === t) { var w = k.getWalletWidgets(); if (typeof w !== "undefined") { for (var u = 0; u < w.length; u++) { w[u].hideEventHandler() } } } }; l.prototype.onAddrSelectHandler = function (v) { n.publish("ADDRESS_RENDER_COMPLETE", this.getID(), this.getSellerId(), this.locationID); var s = v.data; var t = s.eventValue; this.rendered = true; if (this.getID() === t) { if (this.onAddressSelect !== undefined) { this.onAddressSelect(s) } if (this.getWidgetCount() > 1) { clearTimeout(o.constants.TIMEOUT_ID) } var w = k.getWalletWidgets(); if (typeof w !== "undefined") { for (var u = 0; u < w.length; u++) { w[u].refreshEventHandler() } } } }; l.prototype.renderElements = function () { n.publish("ADDRESS_RENDER_START", this.getID()); if (this.hasError !== undefined && this.hasError) { c("#" + this.locationID).empty(); return false } var s = this; r.setLwaSandboxMode(); r.setWebflowParams(h.COE, h.LEDGER_CURRENCY, h.ENV); if (typeof j() !== "undefined" && typeof j().Login !== "undefined" && typeof j().Login.getClientId !== "undefined" && typeof j().Login.getClientId() !== "undefined") { r.getAccessToken(s, s.renderAddressBook) } else { s.renderAddressBook(s, "") } }; l.prototype.renderAddressBook = function (B, D) { d("./ABTestingNewWidgets").resetConfig(D, B.agreementType, B.getSellerId()); var t = B.getID() + "IFrame"; var z = r.createIFrameString(t, B.design.width, B.design.height); var u = B.getID() + q; var x = r.getWidgetDomain(); var w = x + h.ADDRESS_BOOK_URL_PATH; var s = document.getElementById(B.locationID); var A = (s !== null) ? s.offsetWidth : B.design.width; var y = (s !== null) ? s.offsetHeight : B.design.height; var C = { action: a, referringURL: window.top.location, cartOwnerId: B.getSellerId(), marketplaceSellerId: B.getMarketplaceSellerId(), access_token: D, agreementType: B.agreementType, displayMode: B.getDisplayMode(), widgetId: B.getID(), widgetWidth: A, widgetHeight: y, widgetDesignMode: B.design.designMode, browserWindowHeight: B.getBrowserWindowHeight(), widgetPadding: B.design.padding, clientId: r.getClientId(), coe: h.COE, env: h.ENV, ledgerCurrency: h.LEDGER_CURRENCY, theme: B.theme }; C = r.Timezone.appendTimezoneDetails(C); if (typeof B.getContractId() !== "undefined" && B.getContractId() !== null) { C.contractId = B.getContractId() } else { if (typeof B.onOrderReferenceCreate === "function") { C.createContract = true } else { if (typeof B.onBillingAgreementCreate === "function") { C.createContract = true } else { if (typeof B.onReady === "function") { C.createContract = true } } } } if (B.shippingRestrictions !== undefined) { var E = B.encodeShippingRestrictions(); C.shippingRestrictions = E } if (B.getDestinationName() !== undefined) { C.destinationName = B.getDestinationName() } p.isMissingParameter("sellerId", B.getSellerId(), B); if (B.error && B.error.errorType) { C.clientErrorType = B.error.errorType; C.clientErrorElementName = B.error.errorElementName; C.clientErrorElementValue = B.error.errorElementValue; C.clientErrorMessage = B.error.errorMessage } var v = r.createFormString(u, w, t, C); c("#" + u).remove(); r.createWidgetContainer(B.locationID, B.getID(), B.design.width, B.design.height, z, B.type, B.theme); r.createWidgetForm(B.locationID, B.getID(), B.design.width, B.design.height, v, u); if (o.constants.READY_TO_RENDER) { m.Collector.timeEnd("addresswidget-pre-render"); c("#" + u).submit() } }; i.exports = l }, { "../widgets/MetricsCollector": 51, "./ABTestingNewWidgets": 3, "./Config": 16, "./Constants": 19, "./EventTypes": 21, "./InlineWidget": 24, "./InlineWidgetError": 25, "./LwaLogin": 27, "./Mediator": 28, "./PubSub": 30, "./Utilities": 35, "./jquery": 41 }], 6: [function (h, k, m) { var c = { jQuery: h("./jquery"), Widgets: { Utilities: {} } }; var q = h("../widgets/MetricsCollector"); var l = h("./Constants").constants; var b = h("./Constants").dynamic_config_keys; var i = h("./EventTypes"); var d = h("../core/Mediator").instance; var o = h("./Config"); var s = h("./Utilities"); var a = h("../core/SessionStabilizer"); var r = h("./DynamicConfig"); function n() { a.setSessionDone(t) } function j() { l.READY_TO_RENDER = true; for (var v in d.registry) { if (d.registry.hasOwnProperty(v)) { var u = d.registry[v]; c.jQuery(u).trigger(i.DOCUMENT_READY, u) } } } function f(v) { var x = "#" + l.BRIDGE_IFRAME_NAME; var w = c.jQuery(x); if (typeof (w) === "undefined" || w.length === 0) { var z = s.getWidgetDomain() + o.BRIDGE_URL_PATH + "?action=bridge"; z = g(z); var u = s.createIframeStringWithSrc(l.BRIDGE_IFRAME_NAME, z, "1px", "1px"); c.jQuery(document.body).append(u); c.jQuery(x).css("display", "none"); if (typeof (v) === "function") { var y = document.getElementById(l.BRIDGE_IFRAME_NAME); y.onload = v } } } function g(v) { var u = o.IS_SANDBOX === "true" ? "sandbox" : "live"; if (r.valueForKeyIsTrue(b.USE_STATIC_BRIDGE) && !s.isIE()) { return "https://" + r.get(b.STATIC_BRIDGE_HOST) + "/" + o.COUNTRY_CODE.toLowerCase() + "/" + u + "/bridge.html" } else { return v } } function t() { if (s.isIE()) { q.Collector.time("iframe-bridge"); f(p) } else { j() } } function p() { q.Collector.timeEnd("iframe-bridge"); j() } k.exports = { setup: n, setup_: t, onBridgeReady: p, createBridgeIfNotExist: f } }, { "../core/Mediator": 28, "../core/SessionStabilizer": 33, "../widgets/MetricsCollector": 51, "./Config": 16, "./Constants": 19, "./DynamicConfig": 20, "./EventTypes": 21, "./Utilities": 35, "./jquery": 41 }], 7: [function (d, i, f) { var h = d("./Config"); var j = d("../widgets/MetricsCollector"); var k = []; var a = { us: "The browser version you are using is not supported by Amazon Pay. For a list of supported browsers and browser versions, see our Browser Support Help topic at https://pay.amazon.com/us/help/202030010.", uk: "The browser version you are using is not supported by Amazon Pay. For a list of supported browsers and browser versions, see our Browser Support Help topic at https://pay.amazon.com/uk/help/202030010.", de: "Die von Ihnen verwendete Browser-Version wird von Amazon Pay nicht unterstÃ¼tzt. Eine Liste der unterstÃ¼tzten Browser und Browser-Versionen finden Sie in unserem Hilfethema zur BrowserunterstÃ¼tzung unter https://pay.amazon.com/de/help/202030010.", jp: "Amazon Payã§ã¯ã€ã”ä½¿ç”¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚µãƒãƒ¼ãƒˆãƒ˜ãƒ«ãƒ—ãƒšãƒ¼ã‚¸ï¼ˆhttps://pay.amazon.com/jp/help/202030010ï¼‰ã§ã€ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã¨ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚", fr: "La version de votre navigateur n'est pas supportÃ©e par Amazon Pay. Pour la liste des navigateurs et versions de navigateurs pris en charge, consultez notre page d'aide Navigateurs pris en charge https://pay.amazon.com/fr/help/202030010.", it: "La versione del browser utilizzata non Ã¨ supportata da Amazon Pay. Per la lista dei browser e delle versioni supportate, consultare la nostra pagina di assistenza Browser supportati https://pay.amazon.com/it/help/202030010.", es: "La versiÃ³n del navegador que estÃ¡ utilizando no es compatible con Amazon Pay. Para obtener una lista de los navegadores y versiones compatibles, consulte nuestra pÃ¡gina de ayuda de Compatibilidad con navegadores https://pay.amazon.com/es/help/202030010." }; var c = 0; function b() { for (var l = 0; l < k.length; l++) { if (k[l].skipCountries.indexOf(h.COUNTRY_CODE) < 0 && navigator.userAgent.toLowerCase().indexOf(k[l].userAgent) !== -1) { c = l; return false } } return true } function g(m, l) { return function () { alert(a[l]); var n = new j.Collector(m); n.addCounter(k[c].errCounter); n.publish() } } i.exports = { unsupportedUserAgents: k, isSupportedBrowser: b, notSupportedBrowserHandler: g } }, { "../widgets/MetricsCollector": 51, "./Config": 16 }], 8: [function (b, a, c) { var d = { Button: {} }; d.Button.after_callbacks = []; d.Button.before_callbacks = []; d.Button.APA_Image_Loaded_callbacks = []; d.Button.APA_before_callbacks = []; d.Button.before_publish_click_metric_callbacks = []; a.exports = { before_callbacks: d.Button.before_callbacks, after_callbacks: d.Button.after_callbacks, APA_Image_Loaded_callbacks: d.Button.APA_Image_Loaded_callbacks, APA_before_callbacks: d.Button.APA_before_callbacks, before_publish_click_metric_callbacks: d.Button.before_publish_click_metric_callbacks } }, {}], 9: [function (g, f, h) { var b = g("./Utilities"); var d = g("./Constants"); var c = g("../widgets/ABTest").ABTest; var i = g("./DynamicConfig"); function a(q, n) { var j = ""; var l = ""; var k = ""; var m = ""; if (q !== undefined) { j = b.getValueBasedOnInput(d.constants.BUTTON_COLOR_SET, q.color, d.constants.BUTTON_DEFAULT_COLOR); l = b.getValueBasedOnInput(d.constants.BUTTON_SIZE_SET, q.size, d.constants.BUTTON_DEFAULT_SIZE); k = b.getValueBasedOnInput(d.constants.BUTTON_BACKGROUND_SET, q.background, d.constants.BUTTON_DEFAULT_BACKGROUND) } else { j = d.constants.BUTTON_DEFAULT_COLOR; l = d.constants.BUTTON_DEFAULT_SIZE; k = d.constants.BUTTON_DEFAULT_BACKGROUND } if (i.valueForKeyIsTrue(d.dynamic_config_keys.SERVE_BUTTONS_FROM_CLOUDFRONT) && !n) { return d.constants.CLOUDFRONT_APA_BUTTON_BASE_PATH + j + "/" + l + "/button.png" } if (c.Utilities.isSellerInABTest(b.getCartOwnerId(), c.Tests.Default)) { m = c.Utilities.getButtonPath(j, l) } else { var p = d.constants.BUTTON_BASE_PATH; var o = ""; if (n) { o = "donation/" } else { o = "pwa/" } o += j + "/" + l + "/" + k + "/button.png"; m = p + o } return m } f.exports = { getButtonPath: a } }, { "../widgets/ABTest": 49, "./Constants": 19, "./DynamicConfig": 20, "./Utilities": 35 }], 10: [function (i, l, n) { var s = i("./CORS"); var d = i("./Console"); var j = i("./Config"); var r = i("./QueryString"); var g = i("../widgets/MetricsCollector"); var t = i("./DynamicConfig"); var m = i("./Constants"); var b = "ACTIVE"; var f = "amazonpay-merchant-account-inactive"; var c = "amazonpay-merchant-account-inactive-click"; var q = { us: "Amazon Pay is not available for this site. Please contact this merchant for help.", uk: "Amazon Pay is not available for this site. Please contact this merchant for help.", de: "Amazon Pay ist fÃ¼r diese Website nicht verfÃ¼gbar. Wenden Sie sich an diesen HÃ¤ndler, um Hilfe zu erhalten.", jp: "ã“ã®ã‚µã‚¤ãƒˆã§ã¯ Amazon Pay ã‚’åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚ã“ã®å‡ºå“è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚", fr: "Amazon Pay nâ€™est pas disponible pour ce site. Veuillez contacter ce vendeur pour obtenir de lâ€™aide.", it: "Amazon Pay non Ã¨ disponibile per questo sito. Contatta il venditore per ricevere assistenza.", es: "Amazon Pay no estÃ¡ disponible para esta pÃ¡gina. Por favor, ponte en contacto con este vendedor para obtener ayuda." }; var o = { us: "Please refer to instructions in Seller Central and Amazon Pay emails to enable the Amazon Pay button.", uk: "Please refer to instructions in Seller Central and Amazon Pay emails to enable the Amazon Pay button.", de: "Bitte beachten Sie die Anweisungen in den E-Mails von Seller Central und Amazon Pay zur Aktivierung der Amazon Pay-Taste.", jp: "ã‚»ãƒ©ãƒ¼ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãŠã‚ˆã³ Amazon Pay ã®ãƒ¡ãƒ¼ãƒ«ã®èª¬æ˜Žã‚’å‚ç…§ã—ã¦ã€Amazon Pay ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚", fr: "Consultez les instructions dans Seller Central et dans les e-mails d'Amazon Pay pour activer le bouton Amazon Pay.", it: "Ti invitiamo a consultare le istruzioni contenute in Seller Central e nelle e-mail di Amazon Pay per abilitare il pulsante Amazon Pay.", es: "Por favor, consulte las instrucciones en los mensajes de correo electr&oacute;nico de Seller Central y Amazon Pay para activar el bot&oacute;n Amazon Pay." }; function h(u) { return [j.WIDGET_ENDPOINT, "merchantAccount", u, "accountStatus?" + r.toParam({ countryOfEstablishment: j.COE, ledgerCurrency: j.LEDGER_CURRENCY })].join("/") } function k(w, v) { var u = new g.Collector(w); u.addCounter(v, []); u.publish() } function a(A, w, x, y) { function v(B) { return function () { var F = {}; try { F = JSON.parse(B.responseText) } catch (G) { } var E = q[y]; var D = o[y]; if (B.status === 200 && F.merchantAccountStatus && F.merchantAccountStatus !== b) { p(w); w.setAttribute("title", E); d.log(E); d.log(D); var C = x.cloneNode(true); x.parentNode.replaceChild(C, x); C.onclick = function (H) { H.preventDefault(); window.alert(E); k(A, c) }; k(A, f) } } } function u() { d.log("Failed to get the merchant's account status." + z.status) } if (j.IS_SANDBOX === "false" && t.valueForKeyIsTrue(m.dynamic_config_keys.ENABLE_ACCOUNT_STATUS_CHECKING)) { var z = s.createRequest("GET", h(A)); if (z) { z.onload = v(z); z.onerror = u; z.send() } } } function p(u) { u.style.opacity = ".25"; u.style["-webkit-opacity"] = ".25"; u.style.filter = "grayscale(100%)"; u.style["-webkit-filter"] = "grayscale(100%)" } l.exports = a }, { "../widgets/MetricsCollector": 51, "./CORS": 11, "./Config": 16, "./Console": 18, "./Constants": 19, "./DynamicConfig": 20, "./QueryString": 31 }], 11: [function (c, b, d) { function a(h, g, f) { var i = new XMLHttpRequest(); if ("withCredentials" in i) { i.open(h, g, true); i.withCredentials = (f === true) } else { if (typeof XDomainRequest !== "undefined") { i = new XDomainRequest(); i.open(h, g) } else { i = null } } return i } b.exports = { createRequest: a } }, {}], 12: [function (a, i, d) { var f = a("./Config"); var m = a("./Utilities"); var h = a("./CORS"); var j = "NA_USD"; var b = "CHARGE_PERMISSION"; function c(n, q) { var p = JSON.parse(q.responseText); var o = { getAmazonChargePermissionId: function () { return p.amazonOrderReferenceId } }; n.onChargePermissionCreated(o) } function l(n, q) { var p = JSON.parse(q.responseText); var o = { getErrorCode: function () { return p.code }, getErrorMessage: function () { return p.message } }; if (typeof n.onError === "function") { n.onError(o) } } function k(n, o) { console.log("Failed to call AmazonPayments.createChargePermission function. Response status:" + o.status); if (typeof n.onError === "function") { n.onError({ getErrorCode: function () { return "UnknownError" }, getErrorMessage: function () { return "There was an unknown error in the service" } }) } } var g = function (n) { m.getAccessToken({ getSellerId: function () { return n.merchantId } }, function (p, o) { var r = h.createRequest("POST", f.ORDER_MANAGEMENT_ENDPOINT + f.CREATE_ORO_URL_PATH, true); r.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); var q = "accessToken=" + encodeURIComponent(o); if (typeof n.merchantId !== "undefined") { q += "&merchantId=" + n.merchantId } if (typeof n.chargePermissionReferenceId !== "undefined" && n.chargePermissionReferenceId !== null) { q += "&agreementReferenceId=" + n.chargePermissionReferenceId } q += "&paymentRegion=" + j; q += "&agreementType=" + b; r.onload = function () { if (r.status === 201) { c(n, r) } else { if (r.status === 403) { l(n, r) } else { k(n, r) } } }; r.onerror = function () { k(n, r) }; r.send(q) }) }; i.exports = { createChargePermission: g } }, { "./CORS": 11, "./Config": 16, "./Utilities": 35 }], 13: [function (a, h, b) { var d = a("./DynamicConfig"); var g = a("./CORS"); var f = a("./Config"); var i = a("./Constants").dynamic_config_keys; var j = "/rb/checkStatus"; function c() { if (d.valueForKeyIsTrue(i.ENABLE_CHECK_COIN_STATUS) && f.ENV === "LIVE") { var k = g.createRequest("GET", f.CHECK_COIN_STATUS_ENDPOINT + j, true); if (k) { k.send() } } } h.exports = { checkCoinStatus: c } }, { "./CORS": 11, "./Config": 16, "./Constants": 19, "./DynamicConfig": 20 }], 14: [function (f, h, j) { var n = f("./jquery"); var r = f("./ButtonHelper"); var i = f("./Constants"); var s = f("./Utilities"); var a = f("../widgets/ABTest").ABTest; var g = f("./Widget"); var d = f("./APAMetricsHelper"); var p = f("./ButtonCallbacks"); var q = f("./BrowserSupport"); var m = { ERROR: "ERROR" }; var o = { ERROR_IN_ADDING_EVENT_ON_OPEN: "Error caught in addEventListener during onOpen invocation" }; var c = f("../widgets/MetricsCollector"); var k = f("./Config"); function l(t) { if (typeof (t) !== "undefined") { this.size = t.size; this.color = t.color; this.background = t.background } } function b(t) { g.call(this, t); if (typeof (t.sellerId) !== "undefined" && t.sellerId !== null) { i.constants.CartOwnerId = t.sellerId } this.buttonSettings = new l(t.buttonSettings) } b.prototype = s.createSubclass(g.prototype); b.prototype.constructor = b; b.prototype.onErrorCallbackHandler = function (v) { var t = v.data; var u = t.eventValue; if (this.getID() === u) { if (typeof (this.onErrorCallback) === "function") { this.onErrorCallback(t.error) } } else { delete t.eventValue; delete t.error } }; b.prototype.getPopupWindowName = function () { return i.constants.POPUP_WIN_NAME + this.getSellerId() }; b.prototype.documentReadyEventHandler = function (u, t) { g.prototype.documentReadyEventHandler.call(this, u, t) }; b.prototype.bindClickHandler = function (t) { var B = this.getPreExistingButtons(); if (B !== undefined && B.length > 0) { var x = t.getSellerId(); var z = i.constants.COUNTRY_CODE_TO_LANGUAGE_COUNTRY_MAP[k.COUNTRY_CODE]; var A = q.isSupportedBrowser() ? t.onClickHandler : q.notSupportedBrowserHandler(x, z); for (var w = 0; w < B.length; w++) { n(B[w]).bind("click", t, A); var v = i.constants.COUNTRY_CODE_TO_LANGUAGE_COUNTRY_MAP[k.COUNTRY_CODE]; f("./ButtonStatus")(x, document.getElementById(this.locationID), B[w], v) } var y = (new Date()).getTime(); var u = new c.Collector(x); d.addAndPublishMetricsToButtonCollector.call(null, this, u, y, t.buttonType, x, t.buttonSettings) } this.collector.publish() }; b.prototype.onClickHandler = function (v) { v.data.setupFormTargetArea(v); if (typeof (v.data.onOpen) === "undefined" || !v.data.onOpen) { try { v.data.popupWindow.addEventListener("load", function () { if (s.isiOS()) { v.data.submit() } else { setTimeout(function () { v.data.submit() }, i.constants.TIMER_INTERVAL) } }); v.data.popupWindow.document.close() } catch (u) { if (window.ueLogError) { var t = { logLevel: m.ERROR, attribution: "Widget_core.js", message: o.ERROR_IN_ADDING_EVENT_ON_OPEN }; window.ueLogError(u, t) } v.data.submit() } } else { v.data.onOpen(v.data) } }; b.prototype.setupFormTargetArea = function (t) { var u = i.constants.POPUP_WIN_NAME + t.data.getSellerId(); t.data.popupWindow = s.openPopUp(u); t.data.popupWindowName = u }; b.prototype.renderElements = function () { var u = this.locationID; if (this.hasError !== undefined && this.hasError) { n("#" + this.locationID).remove(); return false } var G = this.getPreExistingButtons(); if (G !== undefined && G.length > 0) { this.collector.addCounter("image-present-in-div"); if (a.Utilities.isSellerInABTest(s.getCartOwnerId(), a.Tests.Default)) { a.Utilities.bindButtonOnloadActions(G[0]) } return } this.collector.addCounter("image-added-by-js"); var F = this.buttonSettings; var v = this.getID(); var w = this.buttonType === i.others.ButtonTypes.DONATION; var C = r.getButtonPath(F, this.buttonType === i.others.ButtonTypes.DONATION); if (!a.Utilities.isRebrandingABTest("BUTTON_REBRANDING", x) && !w && !a.Utilities.isSellerInRebrandingBlacklist(x)) { C = s.getAPARebrandedButtonPath(F) } var E = (new Date()).getTime(); var x = this.getSellerId(); var z = this.buttonType; var B = function () { for (var H = 0; H < p.APA_Image_Loaded_callbacks.length; H++) { p.APA_Image_Loaded_callbacks[H].call(this, E, x, z, F) } }; var D = document.createElement("img"); D.style.cursor = "pointer"; if (a.Utilities.isRebrandingABTest("BUTTON_REBRANDING", x) && !a.Utilities.isSellerInRebrandingBlacklist(x)) { D.className = "amazon-payment-button-loaded " + i.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS } D.setAttribute("uri", C); D.setAttribute("src", C); D.setAttribute("id", v); n(D).load(B); n("#" + this.locationID).append(D); var A = f("./DynamicConfig"); var y = A.valueForKeyIsTrue(i.dynamic_config_keys.ENABLE_BUTTON_ABTESTING); if (!w && y && !a.Utilities.isSellerInRebrandingBlacklist(x)) { a.Utilities.appendButtonImageHiddingStyleEle(u) } if (a.Utilities.isSellerInABTest(s.getCartOwnerId(), a.Tests.Default)) { var t = this.getPreExistingButtons(); a.Utilities.bindButtonOnloadActions(t[0]) } if (!w && y && a.Utilities.isRebrandingABTest("BUTTON_REBRANDING", x) && !a.Utilities.isSellerInRebrandingBlacklist(x)) { a.Utilities.getExperimentValueAndCallback(x, a.Tests.BUTTON_REBRANDING, function (M) { if (M !== null && M !== a.Constants.TREATMENT_C && a.Utilities.isRebrandingABTest("BUTTON_REBRANDING", x)) { i.constants.POPUP_LOADING_HTML = i.constants.POPUP_LOADING_HTML_REBRANDING; var J = s.getAPARebrandedButtonPath(F, M); var L = false, I = false; var K = a.Tests.BUTTON_REBRANDING ? a.Tests.BUTTON_REBRANDING.treatmentsWithColorChangeOnHover : []; if (s.isElementInArray(M, K)) { I = true } var H = a.Tests.BUTTON_REBRANDING ? a.Tests.BUTTON_REBRANDING.treatmentsWithShadowOnHover : []; if (s.isElementInArray(M, H)) { L = true } if (I || L) { a.Utilities.styleButtonOnHover({ size: F.size, color: F.color }, L, I) } if (J !== null) { D.setAttribute("uri", J); D.setAttribute("src", J); n("#" + v).attr("src", J) } } a.Utilities.removeButtonImageHiddingStyleEle(u) }) } }; b.prototype.getPreExistingButtons = function () { var u = k.WIDGET_ENDPOINT + i.constants.BUTTON_URI; var t = n("#" + this.locationID + " img").filter(function (w, x) { var v = n(x).attr("src"); if (typeof (v) !== "undefined" && (v.indexOf(u) === 0 || v.indexOf(i.constants.BUTTON_BASE_PATH) === 0) || v.indexOf(i.constants.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX) === 0 || n(x).hasClass("amazon-payment-button-loaded")) { return true } }); return t }; h.exports = b }, { "../widgets/ABTest": 49, "../widgets/MetricsCollector": 51, "./APAMetricsHelper": 4, "./BrowserSupport": 7, "./ButtonCallbacks": 8, "./ButtonHelper": 9, "./ButtonStatus": 10, "./Config": 16, "./Constants": 19, "./DynamicConfig": 20, "./Utilities": 35, "./Widget": 38, "./jquery": 41 }], 15: [function (b, k, f) { var g = b("./DynamicConfig"); var j = b("./CORS"); var h = b("./Config"); var l = b("./Constants").dynamic_config_keys; var a = b("./QueryString"); var m = h.NEW_CSM_URL_PATH; var d = "COIN"; function c(o, p) { var n = a.toParam({ sellerId: o, countryOfEstablishment: h.COE, ledgerCurrency: h.LEDGER_CURRENCY, data: p, productType: d }); return n } function i(o, q) { if (g.valueForKeyIsTrue(l.ENABLE_COIN_CSM) && h.ENV === "LIVE") { var n = c(o, q); var p = j.createRequest("POST", h.CHECK_COIN_STATUS_ENDPOINT + m, true); p.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); if (p) { p.send(n) } } } k.exports = { publish: i } }, { "./CORS": 11, "./Config": 16, "./Constants": 19, "./DynamicConfig": 20, "./QueryString": 31 }], 16: [function (d, k, h) { var l = d("./DynamicConfig.js"); var j = { WIDGET_ENDPOINT: "https://payments.amazon.com", LOCAL_DOMAIN_PREFIX: "payments", APA_LOGIN_FORM_URL_PATH: "/gp/widgets/widgets", AP_LOGO_IMG: "https://images-na.ssl-images-amazon.com/images/G/01/cba/images/logos/logo_amazonpayments_overlay._V192259298_.gif", AP_LOGO_IMG_REBRANDING: "https://m.media-amazon.com/images/G/01/cba/images/logos/amzn_pay_logo.png", COUNTRY_CODE: "US", LOGIN_ENDPOINT: "payments.amazon.com", LWA_ENDPOINT: "www.amazon.com", LOADING_IMAGE_GIF: "https://images-na.ssl-images-amazon.com/images/G/01/ep/loading-large.gif", LOADING_IMAGE_LARGE_GIF: "https://images-na.ssl-images-amazon.com/images/G/01/ep/loading-large.gif", LWA_JAVASCRIPT_ENDPOINT: "https://api-cdn.amazon.com/sdk/login1.js", CORE_JAVASCRIPT_ENDPOINT: "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/us/live/prod/js/Widgets_core.js", IS_SANDBOX: "false", BUTTON_SCRIPT_BASE_PATH: "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/live/prod/js/", BUTTON_IMAGE_BASE_PATH_PREFIX: "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/", BUTTON_IMAGE_BASE_PATH_SUFFIX: "/live/prod/image/", REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX: "https://d2ldlvi1yef00y.cloudfront.net/us/live/", DEFAULT_ABTEST_MERCHANTS: "A3NRRKVEBWDYUW,A31ZWXEAMG3ZFG,A2SKTN79ZRJTQ8", DONATION_WIDGET_CSS: "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/common/us/prod/css/donations.css", MULTI_LANGUAGE_SELLER_BLACKLIST: "", ADDRESS_BOOK: "Address Book", PAYMENT_METHOD: "Payment Method", NA_ACCOUNT_DOMAIN_ENDPOINT: "na.account.amazon.com", NA_ACCOUNT_DOMAIN_WHITELISTED_SELLERS: "AVDQQ12XOH6K2,A1M2419G8OJXX2,A18FOOI7G0EAUQ", IE_UNSUPPORTED_BROWSER_WARNING: "___IE_UNSUPPORTED_BROWSER_WARNING___", IOS_UNSUPPORTED_BROWSER_WARNING: "___IOS_UNSUPPORTED_BROWSER_WARNING___", WALLET_WIDGET_ABTEST_MERCHANTS: "ALLMERCHANTS", WALLET_WIDGET_ABTEST_ALLOWED_TREATMENTS: "C,T1", MEASURE_BUTTON_LATENCY_BASE_PATH_PREFIX: "https://d2ldlvi1yef00y.cloudfront.net/lwa", CHECK_COIN_STATUS_ENDPOINT: "https://coin.amazonpay.com", CREATE_ORO_URL_PATH: "/api/v1/orderReferences", ORDER_MANAGEMENT_ENDPOINT: "https://payments.amazon.com", STAGE: "PROD", getWidgetCoreExecutionEndTime: function () { if (window.OffAmazonPayments) { return window.OffAmazonPayments.WIDGET_CORE_EXECUTION_END_TIME } return 0 }, resetWidgetsConfig: function (o) { if (o === "true" || o === true) { j.WALLET_URL_PATH = "/checkout/widgets/v2/wallet"; j.ADDRESS_BOOK_URL_PATH = "/checkout/widgets/v2/addressBook"; j.CREATE_CONTRACT_URL_PATH = "/checkout/createContractOnSignIn"; j.CONSENT_URL_PATH = "/checkout/widgets/consent"; j.NEW_WIDGETS = true } else { j.WALLET_URL_PATH = "/gp/widgets/widgets"; j.ADDRESS_BOOK_URL_PATH = "/gp/widgets/widgets"; j.CREATE_CONTRACT_URL_PATH = "/gp/widgets/widgets"; j.CONSENT_URL_PATH = "/gp/widgets/widgets"; j.NEW_WIDGETS = false } j.BRIDGE_URL_PATH = "/gp/widgets/widgets"; j.CSM_URL_PATH = "/gp/apa/csm/jsonp"; j.NEW_CSM_URL_PATH = "/cs/uedata"; j.ABTEST_URL_PATH = "/gp/widgets/abtests"; j.SESSION_STABILIZER_URL_PATH = "/gp/widgets/sessionstabilizer"; j.PAYMENT_AUTHORIZATION_URL_PATH = "/gp/widgets/widgets" }, defaultTheme: "standard", getWidgetsBackgroundStyle: function (p) { var o = { dark: ",radial-gradient(circle, #F4F4F4 0%, #EAEAEA 19.11%, #D1D1D1 100%);", light: ";", standard: ";" }; if (j.NEW_WIDGETS) { return "border-radius: 6px; background-repeat: no-repeat; background-position: 50% 50%; background-image: url(https://images-na.ssl-images-amazon.com/images/G/01/ep/loading-large._V364197283_.gif) " + (o[p] || o[j.defaultTheme]) } else { return "background: url(https://images-na.ssl-images-amazon.com/images/G/01/ep/loading-large._V364197283_.gif) no-repeat 50% 50%; " } } }; var g = { GB: "UK" }; var b = { US: "USD", GB: "GBP", IN: "INR", JP: "JPY", DE: "EUR" }; var n = j.LOGIN_ENDPOINT; var c = j.LOGIN_ENDPOINT; var m = j.LOGIN_ENDPOINT; switch (j.STAGE) { case "PROD": case "PROD-sandbox": n = "payments.amazon.fr"; c = "payments.amazon.it"; m = "payments.amazon.es"; break; case "PREPROD": case "PREPROD-sandbox": n = "pay-preprod.amazon.fr"; c = "pay-preprod.amazon.it"; m = "pay-preprod.amazon.es"; break }var i = { FR: n, IT: c, ES: m }; var f = { en_GB: "co.uk", de_DE: "de", fr_FR: "fr", it_IT: "it", es_ES: "es", ja_JP: "co.jp" }; j.COE = g[j.COUNTRY_CODE] || j.COUNTRY_CODE; j.ENV = j.IS_SANDBOX === "true" ? "SANDBOX" : "LIVE"; j.LEDGER_CURRENCY = b[j.COUNTRY_CODE]; j.LOCAL_DOMAIN_SUFFIX_MAP = f; j.LOGIN_ENDPOINTS_FOR_FRITES_COUNTRY_CODE = i; j.SELLER_LANGUAGE_COOKIE_HOURS = 24; j.resetWidgetsConfig(l.get("new_widgets")); function a() { var r = navigator.userAgent.toLowerCase(); var q = new Array("iphone", "ipod", "series60", "symbian", "android", "windows ce", "blackberry", "palm"); for (var p = 0; p < q.length; p++) { var o = q[p]; if (r.search(o) > -1) { return true } } return false } if (a()) { j.LOADING_IMAGE_GIF = j.LOADING_IMAGE_LARGE_GIF } k.exports = j }, { "./DynamicConfig.js": 20 }], 17: [function (d, i, f) { var c = d("./jquery"); var m = d("./Constants"); var p = d("./Utilities"); var n = d("./InlineWidgetError"); var g = d("./InlineWidget"); var a = d("./EventTypes"); var k = d("./Mediator").instance; var j = d("./LwaLogin"); var h = d("./Config"); var l = d("../widgets/MetricsCollector"); var o = "Form"; function b(q) { l.Collector.time("consentwidget-pre-render"); this.type = m.others.WidgetTypes.Consent; g.call(this, q); var s; this.getConsentValue = function () { return s }; this.setConsentValue = function (u) { s = u }; this.getConsentStatus = this.getConsentValue; this.onReady = q.onReady; this.onConsent = q.onConsent; var r = this.design.width; var t = this.design.height; k.register(this); c(this).bind(a.ON_CONSENT_WIDGET_READY, this, this.consentWidgetReadyEventHandler); c(this).bind(a.ON_CONSENT_STATUS_CHANGED, this, this.consentWidgetStatusChangeEventHandler); c(this).unbind(a.EXPRESS_CHK_ONAUTHORIZE); if (this.design.checkWidth) { if (r === undefined) { n.RaiseMissingParameterError(this, p.buildParamNameValueMap("design.width", r)) } else { this.design.width = p.verifySize(r, undefined, m.constants.CONSENT_WIDGET.EDIT.min_width, m.constants.CONSENT_WIDGET.EDIT.max_width); n.RaiseOnErrorIfUndefined(this.design.width, m.constants.INVALID_PARAMETER_VALUE_MSG, p.buildParamNameValueMap("design.width", r), this) } } if (this.design.checkHeight) { if (t === undefined) { n.RaiseMissingParameterError(this, p.buildParamNameValueMap("design.height", t)) } else { this.design.height = p.verifySize(t, undefined, m.constants.CONSENT_WIDGET.EDIT.min_height, m.constants.CONSENT_WIDGET.EDIT.max_height); n.RaiseOnErrorIfUndefined(this.design.height, m.constants.INVALID_PARAMETER_VALUE_MSG, p.buildParamNameValueMap("design.height", t), this) } } } b.prototype = p.createSubclass(g.prototype); b.prototype.constructor = b; b.prototype.consentWidgetReadyEventHandler = function (s) { var q = s.data; var r = q.eventValue; this.setConsentValue(r); if (this.onReady !== undefined) { this.onReady(q) } }; b.prototype.consentWidgetStatusChangeEventHandler = function (s) { var q = s.data; var r = q.eventValue; this.setConsentValue(r); if (this.onConsent !== undefined) { this.onConsent(q) } }; b.prototype.renderElements = function () { if (this.hasError !== undefined && this.hasError) { c("#" + this.locationID).empty(); return false } var q = this; if (typeof j() !== "undefined" && typeof j().Login !== "undefined" && typeof j().Login.getClientId !== "undefined" && typeof j().Login.getClientId() !== "undefined") { p.getAccessToken(q, q.renderConsent) } else { q.renderConsent(q, "") } }; b.prototype.renderConsent = function (w, y) { var q = w.getID() + "IFrame"; var v = p.createIFrameString(q, w.design.width, w.design.height); var r = w.getID() + o; var u = p.getWidgetDomain(); var t = u + h.CONSENT_URL_PATH; var x = { action: "consentWidget", referringURL: window.top.location, cartOwnerId: w.getSellerId(), access_token: y, displayMode: m.others.DisplayModes.edit, agreementType: w.agreementType, widgetId: w.getID(), widgetWidth: w.design.width, widgetHeight: w.design.height, widgetDesignMode: w.design.designMode, widgetPadding: w.design.padding, browserWindowHeight: w.getBrowserWindowHeight(), coe: h.COE, env: h.ENV, ledgerCurrency: h.LEDGER_CURRENCY }; if (typeof w.getContractId() !== "undefined" && w.getContractId() !== null) { x.contractId = w.getContractId() } if (w.error && w.error.errorType) { x.clientErrorType = w.error.errorType; x.clientErrorElementName = w.error.errorElementName; x.clientErrorElementValue = w.error.errorElementValue; x.clientErrorMessage = w.error.errorMessage } var s = p.createFormString(r, t, q, x); c("#" + r).remove(); p.createWidgetContainer(w.locationID, w.getID(), w.design.width, w.design.height, v, w.type); p.createWidgetForm(w.locationID, w.getID(), w.design.width, w.design.height, s, r); if (m.constants.READY_TO_RENDER) { l.Collector.timeEnd("consentwidget-pre-render"); c("#" + r).submit() } }; i.exports = b }, { "../widgets/MetricsCollector": 51, "./Config": 16, "./Constants": 19, "./EventTypes": 21, "./InlineWidget": 24, "./InlineWidgetError": 25, "./LwaLogin": 27, "./Mediator": 28, "./Utilities": 35, "./jquery": 41 }], 18: [function (b, a, f) { var c = "AmazonPay: "; function d(g) { if (typeof window.console === "undefined") { return } window.console.log(c + g) } a.exports = { log: d } }, {}], 19: [function (a, i, b) { var h = a("./Config"); var l = {}; l.POPUP_WIN_WIDTH = 520; l.POPUP_WIN_HEIGHT = 670; l.POPUP_WIN_NAME = "OffAmazonPaymentsPopupWindow"; l.POPUP_LOADING_HTML_REBRANDING = '<style> a {color:#004B91;} #headerSlots {padding-top: 0; height: 50px;} #pageLoading #mainContentArea {height: 375px;overflow-y: auto;}  #imgLoading {text-align: center; padding-top: 120px;} #footerSlots {width: 100%;height: 50px;position: fixed;bottom: 0px;left: 0px;} #footerSlots #amazonPaymentsLogo {background: url("' + h.AP_LOGO_IMG_REBRANDING + "\") no-repeat center top; margin-top: 4px;height: 17px;text-indent: -9999px;} #footerSlots .AtoZ {font-size: 10px; padding-top: 1px;} #footerSlots .ap_privacy_info {font-size: 9px;} div#bottom-6 {left:auto;top:auto;text-align: center;border-top:1px solid #B3B3B3;} .ap_privacy_info {font-family:Verdana;font-size:10px;font-weight:normal;} </style>  <div id='pageLoading'> <div id='wrapper'>  <div id='headerSlots'></div>  <div id='mainContentArea'>  <div id='centerSlots'>  <div id='center-1'>  <div id='imgLoading'>  <img id='loadingImg' src='" + h.LOADING_IMAGE_GIF + "'> </div>  </div>  </div>  </div>  <div id='footerSlots'>  <div id='bottom-6'> <div class='amazonPaymentLogo' id='amazonPaymentsLogo'></div>  </div> </div> </div> </div>"; l.POPUP_LOADING_HTML = '<style> a {color:#004B91;} #headerSlots {padding-top: 0; height: 50px;} #pageLoading #mainContentArea {height: 375px;overflow-y: auto;}  #imgLoading {text-align: center; padding-top: 120px;} #footerSlots {width: 100%;height: 50px;position: fixed;bottom: 0px;left: 0px;} #footerSlots #amazonPaymentsLogo {background: url("' + h.AP_LOGO_IMG + "\") no-repeat center top;margin-top: 4px;height: 17px;text-indent: -9999px;} #footerSlots .AtoZ {font-size: 10px; padding-top: 1px;} #footerSlots .ap_privacy_info {font-size: 9px;} div#bottom-6 {left:auto;top:auto;text-align: center;border-top:1px solid #B3B3B3;} .ap_privacy_info {font-family:Verdana;font-size:10px;font-weight:normal;} </style>  <div id='pageLoading'> <div id='wrapper'>  <div id='headerSlots'></div>  <div id='mainContentArea'>  <div id='centerSlots'>  <div id='center-1'>  <div id='imgLoading'>  <img id='loadingImg' src='" + h.LOADING_IMAGE_GIF + "'> </div>  </div>  </div>  </div>  <div id='footerSlots'>  <div id='bottom-6'> <div class='amazonPaymentLogo' id='amazonPaymentsLogo'></div>  </div> </div> </div> </div>"; l.BUTTON_URI = "/gp/widgets/button"; l.CartOwnerId = ""; l.HOSTED_PAYMENTS_URI = "/gp/widgets/hosted/init"; l.BRIDGE_IFRAME_NAME = "OffAmazonPaymentsBridgeIframe"; l.CONTRACT_FRAME_ID = "OffAmazonPaymentsContractFrame"; l.CONTRACT_FORM_ID = "OffAmazonPaymentsContractForm"; l.WIDGETID_PREFIX = "OffAmazonPaymentsWidgets"; l.WIDGETID_PARAM_NAME = ";widgetId="; l.SELLER_LANGUAGE = "language"; l.COUNTRY_CODE_TO_LANGUAGE_COUNTRY_MAP = { US: "us", GB: "uk", DE: "de", IN: "uk", JP: "jp" }; l.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX = h.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX; l.BUTTON_BASE_PATH_PREFIX = h.BUTTON_IMAGE_BASE_PATH_PREFIX; l.BUTTON_BASE_PATH_SUFFIX = h.BUTTON_IMAGE_BASE_PATH_SUFFIX; l.BUTTON_BASE_PATH = l.BUTTON_BASE_PATH_PREFIX + l.COUNTRY_CODE_TO_LANGUAGE_COUNTRY_MAP[h.COUNTRY_CODE] + l.BUTTON_BASE_PATH_SUFFIX; l.BUTTON_COLOR_SET = ["orange", "tan"]; l.BUTTON_SIZE_SET = ["medium", "large", "x-large"]; l.BUTTON_BACKGROUND_SET = ["dark", "white"]; l.BUTTON_LWA_COLOR_SET = ["darkgray", "lightgray", "gold"]; l.BUTTON_LWA_SIZE_SET = ["small", "medium", "large", "x-large"]; l.BUTTON_LWA_TEXT_SET = ["pwa", "lwa", "editorupdate", "pay", "a", "login", "hostedpayment", "donate", "dwa", "amazonpay"]; l.BUTTON_REBRANDED_IMAGE_NAME = "button.png"; l.BUTTON_LWA_TEXT_IMAGE_SET = ["PwA.svg", "LwA.png", "EditOrUpdate.png", "Pay.png", "A.png", "Login.png", "PwA.svg", "Donate.png", "DwA.png"]; l.BUTTON_DEFAULT_COLOR = "orange"; l.BUTTON_DEFAULT_SIZE = "medium"; l.BUTTON_DEFAULT_BACKGROUND = "dark"; l.BUTTON_PWA_BUTTONNAME = "button.png"; l.BUTTON_DEFAULT_COLOR_LWA = "gold"; l.BUTTON_DEFAULT_SIZE_LWA = "medium"; l.BUTTON_DEFAULT_TYPE = "LwA"; l.BUTTON_DEFAULT_TEXT = l.BUTTON_DEFAULT_TYPE + ".png"; l.SVG_NAMESPACE = "http://www.w3.org/2000/svg"; l.MEASURE_BUTTON_LATENCY_BASE_PATH_PREFIX = h.MEASURE_BUTTON_LATENCY_BASE_PATH_PREFIX; l.LATENCY_MEASURE_BUTTON_TYPE = "PwA.png"; l.APA_BUTTON_TYPE = "apa"; l.CLOUDFRONT_BUTTON_BASE_PATH = h.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX.replace(".net/", ".net/default/"); var d = "/" + h.COE.toLowerCase() + "/"; l.CLOUDFRONT_APA_BUTTON_BASE_PATH = h.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX.replace(d, "/apa-buttons" + d); l.BUTTON_SVG_TEXT_SET = ["login", "lwa", "pay", "pwa", "donate", "dwa", "editorupdate", "a"]; l.BUTTON_LWA_MULTILANGUAGE_SUPPORTED_TEXT_IMAGE_MAP = { pwa: "PwA_25102014.png" }; l.BUTTON_LWA_LANGUAGE_COUNTRY_MAP = { "en-us": "us", "en-gb": "uk", "de-de": "de", "fr-fr": "fr", "it-it": "it", "es-es": "es", "ja-jp": "jp" }; l.BUTTON_LWA_LANGUAGE_TO_REALM_MAP = { "en-us": "en_GB", "en-gb": "en_GB", en: "en_GB", "fr-fr": "fr_FR", fr: "fr_FR", "it-it": "it_IT", it: "it_IT", "es-es": "es_ES", es: "es_ES", "de-de": "de_DE", de: "de_DE", "ja-jp": "ja_JP", ja: "ja_JP" }; l.COUNTRY_CODE_TO_REALM_MAP = { us: "en_US", gb: "en_GB", de: "de_DE", jp: "ja_JP" }; l.REALM_TO_LANGUAGE_COUNTRY_MAP = { en_US: "US", en_GB: "UK", de_DE: "DE", ja_JP: "JP", fr_FR: "FR", it_IT: "IT", es_ES: "ES" }; l.REALM_TO_COUNTRY_CODE_MAP = { en_US: "US", en_GB: "GB", de_DE: "DE", ja_JP: "JP", fr_FR: "FR", it_IT: "IT", es_ES: "ES" }; l.FALLBACK_MULTILANGUAGE_BUYER_LANGUAGE_PREFERENCE = { US: "en_US", GB: "en_GB", DE: "en_GB" }; l.MULTILANGUAGE_ALLOWED_COUNTRY_CODES = ["GB", "DE"]; l.MULTILANGUAGE_ALLOWED_SELLER_LANGUAGE_CODES = ["en-gb", "de-de", "fr-fr", "it-it", "es-es"]; l.FRITES_LANGUAGES = ["fr_FR", "it_IT", "es_ES"]; l.MULTILANGUAGE_DEFAULT_BUTTON_IMAGE_SUB_PATH = "lwa/gold/default/"; l.TIMER_INTERVAL = 100; l.IS_SANDBOX = h.IS_SANDBOX; l.CONTEXT = h.IS_SANDBOX === "true" ? "sandbox" : "live"; l.READY_TO_RENDER = false; l.ADDRESS_WIDGET_PRESENT = false; l.TIMEOUT_ID = null; l.ADDRESS_WIDGET = { READ: { min_width: 290, max_width: 600, default_width: 400, min_height: 150, max_height: 400, default_height: 185 }, EDIT: { min_width: 280, max_width: 600, default_width: 400, min_height: 228, max_height: 400, default_height: 228 } }; l.WALLET_WIDGET = { READ: { min_width: 290, max_width: 600, default_width: 400, min_height: 150, max_height: 400, default_height: 185 }, EDIT: { min_width: 280, max_width: 600, default_width: 400, min_height: 228, max_height: 400, default_height: 228 } }; l.CONSENT_WIDGET = { EDIT: { min_width: 260, max_width: 600, default_width: 400, min_height: 135, max_height: 150, default_height: 228 } }; l.DEFAULT_ADDRESSBOOK_PREF = true; l.UNIT_PX = "PX"; l.INVALID_PARAMETER_VALUE = "InvalidParameterValue"; l.INVALID_PARAMETER = "InvalidParameter"; l.INVALID_SMARTPHONE_PARAMETER_VALUE = "InvalidParameterValueSmartPhone"; l.INVALID_NON_SMARTPHONE_PARAMETER_VALUE = "InvalidParameterValueNonSmartPhone"; l.MISSING_PARAMETER = "MissingParameter"; l.MERCHANT_ABORTED = "MerchantAborted"; l.PARAM_NAME = "${ParamName}"; l.PARAM_VALUE = "${ParamValue}"; l.INVALID_VALUE_FOR_USE_AMAZON_ADDRESSBOOK = "Invalid value specified for parameter useAmazonAddressBook"; l.MISSING_SELLERID = "Required parameter sellerId is not specified."; l.INVALID_PARAMETER_VALUE_MSG = "Value " + l.PARAM_VALUE + " assigned to a parameter " + l.PARAM_NAME + " is not valid "; l.MISSING_PARAMETER_MSG = "Required parameter " + l.PARAM_NAME + " is not specified."; l.MERCHANT_ABORTED_MSG = "The error function was called in the hostedParametersProvider function."; l.PARAMETER_VALIDATION_FAILED_MSG = "Parameter validation failed "; l.MERCHANTS_INVALID_PARAMETERS_MSG = "Invalid parameters passed, please only provide parameters specified in the integration guide "; l.HOSTED_PAYMENTS_ACTION_NONE = "None"; l.HOSTED_PAYMENTS_ACTION_AUTHORIZE = "Authorize"; l.HOSTED_PAYMENTS_ACTION_AUTHORIZE_AND_CAPTURE = "AuthorizeAndCapture"; l.HOSTED_PAYMENTS_WIDGET_ID = ""; l.HOSTED_HTML_INTERFACE = "HTML"; l.HOSTED_JAVASCRIPT_INTERFACE = "JavaScript"; l.HOSTED_EXPERIENCE_TYPE_KEY = "experienceType"; l.HOSTED_INTERFACE_TYPE_KEY = "interfaceType"; l.RETURN_URL_MAX_LENGTH = 256; l.CANCEL_RETURN_URL_MAX_LENGTH = 256; l.CURRENCY_CODE_MAX_LENGTH = 3; l.SELLER_NOTE_MAX_LENGTH = 1024; l.SCOPE_MAX_LENGTH = 256; l.SELLER_ORDER_ID_MAX_LENGTH = 100; l.SELLER_STORE_NAME_MAX_LENGTH = 100; l.PAYMENT_ACTION_MAX_LENGTH = 20; l.LWA_CLIENT_ID_MAX_LENGTH = 256; l.IS_DYNAMIC_BUTTON_USED = false; l.TIMEZONE_JUNE_OFFSET = "junTimezoneOffset"; l.TIMEZONE_JANUARY_OFFSET = "janTimezoneOffset"; l.TIMEZONE_JANUARY_REF_DATE = new Date(2010, 0, 1, 0, 0, 0, 0); l.TIMEZONE_JUNE_REF_DATE = new Date(2010, 5, 1, 0, 0, 0, 0); l.CONNECTED_AUTH_COOKIE_NAME = "amazon-pay-connectedAuth"; l.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS = "amazonpay-button-inner-image"; var k = { CONNECTEDAUTH_GENERAL: "connectedAuth_general", LWA_GENERAL: "lwa_general" }; var f = { T1: "connectedAuth_general", C: "lwa_general" }; var m = { Button: "Button", AddressBook: "AddressBook", Wallet: "Wallet", Consent: "Consent" }; var c = { BIG_FISH_CHECKOUT: "paymentsOnlyProduct", DONATION: "donationProduct", HOSTED: "hostedPayment", HOSTED_DONATION: "hostedDonation" }; var g = { CartPage: "CartPage", DetailPage: "DetailPage" }; var j = { read: "read", edit: "edit" }; var n = { ShowAll: "Default", Default: "Default" }; i.exports = { config: { POLL_FOR_EVENTS: true }, constants: l, dynamic_config_keys: { ENABLE_REBRANDING_BUTTON: "enableRebrandingButton", ENABLE_ACCOUNT_STATUS_CHECKING: "enableAccountStatusChecking", ENABLE_BUTTON_ABTESTING: "enableButtonABTesting", ENABLE_ABTEST_V2: "enableABTestV2", USE_STATIC_BRIDGE: "useStaticBridge", STATIC_BRIDGE_HOST: "staticBridgeHost", BUTTON_ABTESTING_BLACKLIST: "rebrandingMerchantBlackList", NEW_WIDGETS_ENABLED: "newWidgetsABTestingEnabled", NEW_WIDGETS_ALWAYS_SHOW_OLD: "alwaysShowOldWidgetsForMerchants", NEW_WIDGETS_ALWAYS_SHOW_NEW: "alwaysShowNewWidgetsForMerchants", NEW_WIDGETS_ABTESTING_FOR_ALL: "abtestingNewWidgetsForAll", NEW_WIDGETS_ABTESTING_MERCHANTS: "newWidgetsABTestingMerchants", SERVE_BUTTONS_FROM_CLOUDFRONT: "serveButtonsFromCloudFront", HIGHRES_BUTTON_IMAGE_USE_SRCSET: "highResButtonImageUseSrcset", ENABLE_CHECK_COIN_STATUS: "enableCheckCoinStatus", CONNECTED_AUTH_ENABLED: "enableConnectedAuth", CONNECTED_AUTH_MERCHANT_BLACKLIST: "connectedAuthMerchantBlackList", ENABLE_COIN_CSM: "enableCoinCSM", ENABLE_FUNDUS_LOGINJS: "enableFundusLoginJS", ENABLE_PUBLISH_METRICS_TO_UCUI: "enablePublishingMetricsToUCUI", ENABLE_PUBLISH_METRICS_TO_NEW_CSM: "enablePublishingMetricsToNewCSM" }, others: { ConnectedAuthTreatmentMap: f, ConnectedAuthCookieValues: k, WidgetTypes: m, ButtonTypes: c, CartOrigins: g, DisplayModes: j, PaymentInstrumentsDisplayOptions: n } } }, { "./Config": 16 }], 20: [function (b, h, c) { var d; var k; var j = "DynamicConfig"; window.OffAmazonPayments; function a(m) { if (!window.OffAmazonPayments) { return null } var l = window.OffAmazonPayments[j]; var n; if (typeof l !== "object") { return null } else { n = l[m]; if (n === undefined) { return null } else { return n } } } function f(l) { return a(l) === true } function g(l) { return Object.prototype.toString.call(l) === "[object Array]" } function i(n, m) { var l = a(n); return g(l) && l.indexOf(m) >= 0 } h.exports = { get: a, valueForKeyIsTrue: f, valueInArray: i } }, {}], 21: [function (b, a, c) { var d = { Widgets: {} }; d.Widgets.EventTypes = { DOCUMENT_READY: "OffAmazonPayments.DocumentReadyEvent", REFRESH: "apay-refresh", WIDGET_REFRESH: "apay-widgetrefresh;widgetId=", EXPRESS_CHK_ONAUTHORIZE: "apay-pcId=", ON_ADDRESS_SELECT_PRE: "apay-addressselectpre;widgetId=", ON_ADDRESS_SELECT: "apay-addressselect;widgetId=", ON_PAYMENT_SELECT: "apay-paymentselect;widgetId=", ON_CLOSE: "apay-close;widgetId=", ON_PPH_WIDGET_CLOSE: "apay-close", PRIME_WIDGET_RESIZE: "apay-prime-resize;widgetId=", ON_ERROR: "apay-OffAmazonPayments_mec_", REDIRECT_URL: "apay-redirectUrl;widgetId=", CHANGE_HEIGHT: "apay-changeHeight", ON_CONSENT_WIDGET_READY: "apay-onConsentWidgetReady=", ON_CONSENT_STATUS_CHANGED: "apay-onConsentStatusChanged=", ON_PAYMENT_AUTHORIZATION: "apay-onPaymentAuthorization" }; a.exports = d.Widgets.EventTypes }, {}], 22: [function (c, g, d) { var h = c("../widgets/MetricsCollector"); var k = c("./DynamicConfig"); var j = c("./Constants"); var b = ["pwa", "amazonpay", "pay", "a"]; function a(l, o, n) { if (!i(n.type)) { return false } function r(w) { if (w) { var z = new h.Collector(o); var x = Math.round(window.devicePixelRatio); var y = w.src; var v = y.split(".png")[0]; var u = v + "_" + x + "x.png"; var s = (n.color) ? n.color : "default"; w.setAttribute("devicePixelRatio", x); if (w && w.clientWidth === 0 && w.clientHeight === 0) { var A = new Image(); A.onload = function () { w.setAttribute("width", A.width); w.setAttribute("height", A.height) }; A.src = y } var t = new Image(); t.onload = function () { if (w && w.clientWidth !== 0 && w.clientHeight !== 0) { w.style.setProperty("width", w.clientWidth + "px"); w.style.setProperty("height", w.clientHeight + "px") } w.onload = null; w.setAttribute("data-metric-tags", "highres"); w.setAttribute("src", u) }; t.onerror = function () { z.addCounter("high-res-button-not-found", [n.type, n.size, s, n.language]); z.publish() }; t.src = u } } function p(t) { var u = Math.round(window.devicePixelRatio); var w = t.src.split(".png")[0]; var v = w + "_" + u + "x.png"; var s = new Image(); s.onload = function () { t.onload = null; t.setAttribute("data-metric-tags", "highres"); t.setAttribute("srcset", v + " " + u + "x") }; s.src = v } var m = k.valueForKeyIsTrue(j.dynamic_config_keys.HIGHRES_BUTTON_IMAGE_USE_SRCSET) ? p : r; var q = f(); if (l && q && l.clientWidth === 0 && l.clientHeight === 0) { l.onload = function () { m(l) } } else { if (l && q) { m(l) } else { return false } } } function f() { if (window.matchMedia) { var m = window.matchMedia("only screen and (-moz-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (-webkit-min-device-pixel-ratio: 2), only screen  and (min-device-pixel-ratio: 2), only screen and (min-resolution: 2dppx)"); var l = Math.round(window.devicePixelRatio); return (m && m.matches || (l > 1)) } return false } function i(l) { return l && b.indexOf(l.toLowerCase()) >= 0 } g.exports = { useRetinaImage: a, isRetinaDisplay: f } }, { "../widgets/MetricsCollector": 51, "./Constants": 19, "./DynamicConfig": 20 }], 23: [function (d, c, g) { var h = { jQuery: d("./jquery") }; var b = d("../core/Constants"); var a = d("../core/Utilities"); var f = d("./Config"); h.HostedPayments = {}; h.HostedPayments.done = function (m) { try { h.HostedPayments.validate(m) } catch (j) { return false } var i = f.WIDGET_ENDPOINT + b.constants.HOSTED_PAYMENTS_URI; m.action = "hostedInit"; m.cartOwnerId = m.sellerId; var l = Math.floor((Math.random() * 1000000000) + 1).toString(); var k = a.createFormString(l, i, "_self", m); h.jQuery("#" + l).remove(); h.jQuery("body").append(k); h.jQuery("#" + l).submit() }; h.HostedPayments.isHostedPaymentsInput = function (i) { return i === b.others.ButtonTypes.HOSTED || h.HostedPayments.isHostedDonation(i) }; h.HostedPayments.isHostedDonation = function (i) { return i === b.others.ButtonTypes.HOSTED_DONATION }; h.HostedPayments.inputTypeToExperienceTypeMap = { hostedPayment: "ExpressPayment", hostedDonation: "ExpressDonation" }; h.HostedPayments.validate = function (z) { var H = "sellerId"; var q = "amount"; var C = "returnURL"; var F = "cancelReturnURL"; var l = "accessKey"; var n = "signature"; var u = "lwaClientId"; var D = "currencyCode"; var v = "sellerNote"; var A = "scope"; var I = "sellerOrderId"; var w = "paymentAction"; var k = "shippingAddressRequired"; var t = b.constants.HOSTED_EXPERIENCE_TYPE_KEY; var r = b.constants.HOSTED_INTERFACE_TYPE_KEY; var j; if (o()) { y(); throw h.Widgets.Validation.validationException() } j = i(); if (j.length > 0) { B(j); throw h.Widgets.Validation.validationException() } j = x(); if (j.length > 0) { G(j); throw h.Widgets.Validation.validationException() } if (isNaN(z.amount) || Number(z.amount) <= 0 || Number(z.amount) > 1000000) { E(z.amount, q); throw h.Widgets.Validation.validationException() } if (!s()) { E(z.paymentAction, w); throw h.Widgets.Validation.validationException() } if (!a.isEmptyOrUndefined(z.shippingAddressRequired) && !a.isBoolean(z.shippingAddressRequired)) { E(z.shippingAddressRequired, k); throw h.Widgets.Validation.validationException() } function i() { var J = new Array(H, q, C, l, n, u); var M = []; for (var L = 0; L < J.length; L++) { var K = J[L]; if (a.isEmptyOrUndefined(z[K])) { M.push(K) } } return M } function x() { var J = []; m(C, b.constants.RETURN_URL_MAX_LENGTH, J); m(D, b.constants.CURRENCY_CODE_MAX_LENGTH, J); m(v, b.constants.SELLER_NOTE_MAX_LENGTH, J); m(A, b.constants.SCOPE_MAX_LENGTH, J); m(w, b.constants.PAYMENT_ACTION_MAX_LENGTH, J); m(I, b.constants.SELLER_ORDER_ID_MAX_LENGTH, J); m(u, b.constants.LWA_CLIENT_ID_MAX_LENGTH, J); return J } function m(J, L, K) { if (!a.isEmptyOrUndefined(z[J]) && z[J].length > L) { K.push(J) } } function o() { var J = new Array(H, q, C, F, l, n, u, D, v, A, I, w, k, t, r); for (var K in z) { if (h.jQuery.inArray(K, J) === -1) { return true } } } function s() { var J = new Array(b.constants.HOSTED_PAYMENTS_ACTION_NONE, b.constants.HOSTED_PAYMENTS_ACTION_AUTHORIZE, b.constants.HOSTED_PAYMENTS_ACTION_AUTHORIZE_AND_CAPTURE); return a.isEmptyOrUndefined(z.paymentAction) || h.jQuery.inArray(z.paymentAction, J) !== -1 } function E(L, K) { var J = "Value '" + L + "' assigned to a parameter '" + K + "' is not valid"; p(b.constants.INVALID_PARAMETER_VALUE, J) } function B(K) { var J = "Required parameters missing : " + K; p(b.constants.MISSING_PARAMETER, J) } function G(K) { var J = "Parameters '" + K + "' exceeds the maximum allowed length"; p(b.constants.INVALID_PARAMETER_VALUE, J) } function y() { p(b.constants.INVALID_PARAMETER, b.constants.MERCHANTS_INVALID_PARAMETERS_MSG) } function p(K, J) { a.sendOnErrorCallbackMessage(K, J, b.constants.HOSTED_PAYMENTS_WIDGET_ID) } }; c.exports = h.HostedPayments }, { "../core/Constants": 19, "../core/Utilities": 35, "./Config": 16, "./jquery": 41 }], 24: [function (c, i, f) { var b = c("./jquery"); var p = c("./Widget"); var l = c("./Constants"); var n = c("./Utilities"); var d = c("./WidgetDesign"); var k = c("./InlineWidgetError"); var a = c("./EventTypes"); var h = c("./CheckoutWidget"); var j = c("./../widgets/MetricsCollector"); var m = "Form"; var o = { SAFARI: "safari" }; function g(q) { p.call(this, q); this.onErrorCallback = q.onError; if (q.scope) { this.scope = q.scope; var r = new j.Collector(q.sellerId); r.addCounter("lwa-use-scopes-param", this.type); r.publish() } b(this).bind(a.ON_ERROR, this, h.prototype.onErrorCallbackHandler); var u = q.amazonOrderReferenceId || q.amazonBillingAgreementId || q.amazonChargePermissionId || null; var s = l.others.DisplayModes.edit; if (typeof (q.displayMode) !== "undefined") { switch (q.displayMode.toLowerCase()) { case l.others.DisplayModes.read.toLowerCase(): s = l.others.DisplayModes.read; break; case l.others.DisplayModes.edit.toLowerCase(): s = l.others.DisplayModes.edit; break; default: this.error = new k(l.constants.INVALID_PARAMETER_VALUE, null, "displayMode", q.displayMode) } } var v = l.others.PaymentInstrumentsDisplayOptions.ShowAll; this.getDisplayMode = function () { return s }; this.getPaymentInstrumentsDisplayOptions = function () { return v }; this.design = new d(q.design, this); this.agreementType = (!n.isEmptyOrUndefined(q.agreementType)) ? q.agreementType : ""; this.getContractId = function () { return u }; this.setContractId = function (w) { u = w }; this.onOrderReferenceCreate = q.onOrderReferenceCreate; this.onBillingAgreementCreate = q.onBillingAgreementCreate; this.onReady = q.onReady; var t = q.presentmentCurrency; this.getPresentmentCurrency = function () { return t }; this.setPresentmentCurrency = function (w) { t = w; return this }; if (typeof this.onOrderReferenceCreate === "function") { b(this).bind(a.EXPRESS_CHK_ONAUTHORIZE, this, this.onOrderReferenceCreateHandler) } if (typeof this.onBillingAgreementCreate === "function") { b(this).bind(a.EXPRESS_CHK_ONAUTHORIZE, this, this.onBillingAgreementCreateHandler) } if (typeof this.onReady === "function") { b(this).bind(a.EXPRESS_CHK_ONAUTHORIZE, this, this.onReadyHandler) } b(this).bind(a.REFRESH, this, this.refreshEventHandler); b(this).bind(a.WIDGET_REFRESH, this, this.widgetRefreshEventHandler); b(this).bind(a.CHANGE_HEIGHT, this, this.widgetChangeHeightEventHandler) } g.prototype = n.createSubclass(p.prototype); g.prototype.constructor = g; g.prototype.refreshEventHandler = function () { var s = this.getID() + m; var r = this.getID() + "IFrame"; if (b("#" + r).length !== 0) { b("#" + r).remove() } var q = n.createIFrameString(r, this.design.width, this.design.height); b("#" + this.getID()).append(q); b("#" + s).submit() }; g.prototype.hideEventHandler = function () { var q = this.getID() + "IFrame"; n.hide(q) }; g.prototype.widgetRefreshEventHandler = function (s) { var q = s.data; var r = q.eventValue; if (this.getID() === r) { this.refreshEventHandler() } }; g.prototype.widgetChangeHeightEventHandler = function (t) { var q = t.data; var u = q.eventValue.split(";"); var r = u[0]; var s = u[1]; if (this.getID() === r) { this.changeHeightEventHandler(s) } }; g.prototype.onOrderReferenceCreateHandler = function (s) { b(this).unbind(a.EXPRESS_CHK_ONAUTHORIZE); var q = s.data.eventValue; var r = { getAmazonOrderReferenceId: function () { return q } }; this.onOrderReferenceCreate(r) }; g.prototype.onBillingAgreementCreateHandler = function (r) { b(this).unbind(a.EXPRESS_CHK_ONAUTHORIZE); var q = r.data.eventValue; var s = { getAmazonBillingAgreementId: function () { return q } }; this.onBillingAgreementCreate(s) }; g.prototype.onReadyHandler = function (s) { b(this).unbind(a.EXPRESS_CHK_ONAUTHORIZE); var r = s.data.eventValue; var t = {}; var q = function () { t.getAmazonBillingAgreementId = function () { return r }; t.getAmazonOrderReferenceId = function () { return r }; return t }(); this.onReady(q) }; g.prototype.getBrowserWindowHeight = function () { var q = b(window).height(); if (navigator.userAgent.match(/OS [0-9](_\d)+ like Mac OS X/i) && navigator.userAgent.toLowerCase().indexOf(o.SAFARI) > -1) { q = q + 60 } return q }; g.prototype.changeHeightEventHandler = function (t) { var s = this.getID(); var q = s + "IFrame"; var v = s + m; var u = t * 1 + 2; b("#" + s).height(u + "px"); b("#" + q).height(t + "px"); document.getElementById(q).height = t; b("#" + v).children("input:hidden[name='widgetHeight']").val(t); if (t >= document.body.clientHeight) { var r = b("#" + s).offset().top; b(window).scrollTop(r) } }; i.exports = g }, { "./../widgets/MetricsCollector": 51, "./CheckoutWidget": 14, "./Constants": 19, "./EventTypes": 21, "./InlineWidgetError": 25, "./Utilities": 35, "./Widget": 38, "./WidgetDesign": 39, "./jquery": 41 }], 25: [function (d, c, f) { var g = { Widgets: { InlineWidget: {} } }; var b = d("./Constants"); var a = d("./Utilities"); g.Widgets.InlineWidget.Error = function (k, i, j, h) { this.errorType = k; this.errorMessage = i; this.errorElementName = j; this.errorElementValue = h }; g.Widgets.InlineWidget.Error.SetErrorIfParameterExists = function (k, m, h, i, l) { if (m) { var j = b.constants.INVALID_PARAMETER_VALUE; if (l === "smartphone") { j = b.constants.INVALID_SMARTPHONE_PARAMETER_VALUE } else { if (l === "nonSmartphone") { j = b.constants.INVALID_NON_SMARTPHONE_PARAMETER_VALUE } } i.error = new g.Widgets.InlineWidget.Error(j, h, k, m) } }; g.Widgets.InlineWidget.Error.RaiseOnError = function (h, k, i, j) { if (!j) { j = b.constants.INVALID_PARAMETER_VALUE } h = a.formatMsg(h, k); a.sendOnErrorCallbackMessage(j, h, i.getID()); i.hasError = true }; g.Widgets.InlineWidget.Error.RaiseOnErrorIfUndefined = function (j, h, l, i, k) { if (j === undefined) { g.Widgets.InlineWidget.Error.RaiseOnError(h, l, i, k) } }; g.Widgets.InlineWidget.Error.RaiseMissingParameterError = function (i, h) { g.Widgets.InlineWidget.Error.RaiseOnError(b.constants.MISSING_PARAMETER_MSG, h, i, b.constants.MISSING_PARAMETER) }; g.Widgets.InlineWidget.Error.isMissingParameter = function (i, h, j) { if (a.isEmptyOrUndefined(h)) { j.error = new g.Widgets.InlineWidget.Error(b.constants.MISSING_PARAMETER, b.constants.MISSING_PARAMETER_MSG, i, h); return true } return false }; c.exports = g.Widgets.InlineWidget.Error }, { "./Constants": 19, "./Utilities": 35 }], 26: [function (h, k, p) { var w = h("./Utilities"); var s = h("../widgets/MetricsCollector"); var n = h("./Constants"); var q = h("./Config"); var x = h("./ZeroTime"); var m = h("./ABTestingLoginConsent"); var a = false; var d = []; function i(y) { if (typeof y === "undefined" || y.type === undefined) { return "undefined_button_type" } return y.type.toLowerCase() } function g(B, D, z, C, A) { A = new s.Collector(z); u(A); A.addButtonInfoData(s.ProductTypes.LPA, s.PageActions.BUTTON_RENDER, B.type, z); var F = i(B); var H = C ? [s.Tags.DYNAMIC, F] : [F]; A.addCounter("lpa-buttonrender", H); if (C) { l(A, z) } if (w.isSellerHidingButton(D)) { A.addCounter("lpa-seller-hiding-button") } var E = B.color || n.constants.BUTTON_DEFAULT_COLOR_LWA; var G = B.size || n.constants.BUTTON_DEFAULT_SIZE_LWA; var y = B.type || n.constants.BUTTON_DEFAULT_TYPE; A.addCounter(E); A.addCounter(G); A.addCounter(y); A.addCounter(E.toLowerCase() + "_" + G.toLowerCase() + "_" + y.toLowerCase()); w.addLpaButtonAttributesToMetrics(D, B, A); j(A, z, B); r(A, B); A.publish() } function l(z, y) { z.addInfoOrEntry("additional-request-data", "|svg-button:" + y, "info"); z.addInfoOrEntry("svg-button", "lpa-buttonrender-dynamic-" + y, "info") } function r(z, y) { z.addInfoOrEntry("additional-request-data", "|is-bml-merchant:" + w.isValidLanguagePassedBySeller(y), "info") } function j(A, z, y) { var C = w.getLanguageForSeller(z, y); A.addInfoOrEntry("additional-request-data", "|language:" + C, "info"); if (w.isSellerAllowedForMultiLanguage(z, y)) { var B = w.getBrowserLanguagePreference(); if (w.isValidLanguagePassedBySeller(y)) { A.addCounter("lpa-buttonrender-in-seller-language") } else { if (w.isBrowserLanguageSupported(B)) { A.addCounter("lpa-buttonrender-in-browser-language") } else { A.addCounter("lpa-buttonrender-in-default-language") } } A.addCounter("lpa-buttonrender-in-" + C) } } function t() { while (d.length > 0) { var y = d.pop(); if (typeof y === "function") { y() } } } function f(A, y, C) { var z = "C"; if (w.readCookie("amazon-pay-abtesting-new-widgets") === "true") { z = "T1" } var B = new OffAmazonPayments.Metrics.Collector(A); B.addInfoOrEntry("weblab-name", "NEW_WIDGETS", "info"); B.addInfoOrEntry("weblab-treatment", z, "info"); B.addInfoOrEntry("merchant-id", A, "info"); B.addCounter(y); if (C) { B.safePublish() } else { B.publish() } } function b(z, y, B) { var D = m.getLoginConsentWeblabTreatmentValue(); var C = m.getLwaAuiMigrationWeblabTreatmentValue(); var A = new s.Collector(z); A.addInfoOrEntry("weblab-name", "LWA_LOGIN_CONSENT_CUSTOMIZATION", "info"); A.addInfoOrEntry("weblab-treatment", D, "info"); A.addInfoOrEntry("merchant-id", z, "info"); A.addCounter(y); if (D === "T1") { A.addInfoOrEntry("weblab-name", "LWA_AUI_MIGRATION", "info"); A.addInfoOrEntry("weblab-treatment", C, "info"); A.addInfoOrEntry("merchant-id", z, "info"); A.addCounter(y) } if (B) { A.safePublish() } else { A.publish() } } function o(z, y) { if (a === true) { f(z, y, false) } else { d.push(function () { return f(z, y, false) }) } } function c() { a = true } var v = h("./ResourceTiming"); function u(y) { y.addTiming("widgets-js-loading", x(), q.getWidgetCoreExecutionEndTime()); v.logWidgetsJSLoadingTime(y) } k.exports = { getLpaButtonType: i, publishMetricsForLPAButton: g, publishMetricsForLPAButtonLanguage: j, addWidgetsLoadLatencyMetric: u, queueOrPublishMetrics: o, publishPendingMetrics: t, publishButtonMetricsForNewWidgets: f, publishButtonMetricsForLoginConsentABTest: b, setWeblabDone: c } }, { "../widgets/MetricsCollector": 51, "./ABTestingLoginConsent": 2, "./Config": 16, "./Constants": 19, "./ResourceTiming": 32, "./Utilities": 35, "./ZeroTime": 40 }], 27: [function (b, a, c) { a.exports = function () { return window.amazon } }, {}], 28: [function (c, b, d) { var f = { jQuery: c("./jquery"), Widgets: {} }; var a = c("./Constants"); f.Widgets.Mediator = function () { this.widgetCount = 0; this.registry = {} }; f.Widgets.Mediator.Reset = function () { f.Widgets.mediator.widgetCount = 0; f.Widgets.mediator.registry = {} }; f.Widgets.Mediator.prototype.generateUniqWidgetID = function () { return this.widgetCount++ }; f.Widgets.Mediator.prototype.getNumWidgetCount = function () { return this.widgetCount }; f.Widgets.Mediator.prototype.register = function (g) { this.registry[g.getID()] = g }; f.Widgets.Mediator.prototype.notifyListeners = function (i) { for (var h in this.registry) { if (this.registry.hasOwnProperty(h)) { var g = this.registry[h]; g.eventValue = i.eventValue; g.error = i.error; f.jQuery(g).trigger(i.eventName, g) } } }; f.Widgets.Mediator.prototype.getWalletWidgets = function () { return this.getWidgetsHelper(a.others.WidgetTypes.Wallet) }; f.Widgets.Mediator.prototype.getAddressWidgets = function () { return this.getWidgetsHelper(a.others.WidgetTypes.AddressBook) }; f.Widgets.Mediator.prototype.getWidgetsHelper = function (j) { var i = []; for (var h in this.registry) { if (this.registry.hasOwnProperty(h)) { var g = this.registry[h]; if (g.type === j) { i.push(g) } } } return i }; f.Widgets.mediator = new f.Widgets.Mediator(); b.exports = { Mediator: f.Widgets.Mediator, instance: f.Widgets.mediator } }, { "./Constants": 19, "./jquery": 41 }], 29: [function (d, i, f) { var m = d("./Constants"); var c = d("./jquery"); var o = d("./Utilities"); var n = d("./InlineWidgetError"); var g = d("./InlineWidget"); var a = d("./EventTypes"); var k = d("./Mediator").instance; var j = d("./LwaLogin"); var h = d("./Config"); var l = d("../widgets/MetricsCollector"); var b = "spaPaymentAuthorizationWidget"; var q = { min_width: 400, max_width: 600, default_width: 400, min_height: 400, max_height: 500, default_height: 400 }; function p(r) { l.Collector.time("paymentAuthorizationWidget-pre-render"); g.call(this, r); this.type = m.others.WidgetTypes.PaymentAuthorization; this.onPaymentAuthorization = r.onPaymentAuthorization; var s = this.design.width; var t = this.design.height; k.register(this); if (this.design.checkWidth) { if (s === undefined) { n.RaiseMissingParameterError(this, o.buildParamNameValueMap("design.width", s)) } else { this.design.width = o.verifySize(s, undefined, q.min_width, q.max_width); n.RaiseOnErrorIfUndefined(this.design.width, m.constants.INVALID_PARAMETER_VALUE_MSG, o.buildParamNameValueMap("design.width", s), this) } } if (this.design.checkHeight) { if (t === undefined) { n.RaiseMissingParameterError(this, o.buildParamNameValueMap("design.height", t)) } else { this.design.height = o.verifySize(t, undefined, q.min_height, q.max_height); n.RaiseOnErrorIfUndefined(this.design.height, m.constants.INVALID_PARAMETER_VALUE_MSG, o.buildParamNameValueMap("design.height", t), this) } } c(this).bind(a.ON_PAYMENT_AUTHORIZATION, this, this.onPaymentAuthorizationHandler) } p.prototype = o.createSubclass(g.prototype); p.prototype.constructor = p; p.prototype.onPaymentAuthorizationHandler = function (t) { var r = t.data; var s = r.eventValue.widgetID; if (this.getID() === s) { if (this.onPaymentAuthorization !== undefined) { this.onPaymentAuthorization(r) } } }; p.prototype.renderElements = function () { if (this.hasError !== undefined && this.hasError) { c("#" + this.locationID).empty(); return false } var r = this; o.setLwaSandboxMode(); if (typeof j() !== "undefined" && typeof j().Login !== "undefined" && typeof j().Login.getClientId !== "undefined" && typeof j().Login.getClientId() !== "undefined") { o.getAccessToken(r, r.renderPaymentAuthorization) } else { r.renderPaymentAuthorization(r, "") } }; p.prototype.renderPaymentAuthorization = function (x, s) { var w = x.getID() + "IFrame"; var u = o.createIFrameString(w, x.design.width, x.design.height); var y = x.getID() + "Form"; var r = h.WIDGET_ENDPOINT + h.PAYMENT_AUTHORIZATION_URL_PATH; var t = { action: b, referringURL: window.top.location, cartOwnerId: x.getSellerId(), marketplaceSellerId: x.getMarketplaceSellerId(), access_token: s, agreementType: x.agreementType, displayMode: x.getDisplayMode(), widgetId: x.getID(), widgetWidth: x.design.width, widgetHeight: x.design.height, widgetDesignMode: x.design.designMode, widgetPadding: x.design.padding, browserWindowHeight: x.getBrowserWindowHeight(), paymentInstrumentsDisplayOptions: x.getPaymentInstrumentsDisplayOptions(), clientId: o.getClientId() }; if (typeof x.getContractId() !== "undefined" && x.getContractId() !== null) { t.contractId = x.getContractId() } n.isMissingParameter("sellerId", x.getSellerId(), x); if (x.error && x.error.errorType) { t.clientErrorType = x.error.errorType; t.clientErrorElementName = x.error.errorElementName; t.clientErrorElementValue = x.error.errorElementValue; t.clientErrorMessage = x.error.errorMessage } var v = o.createFormString(y, r, w, t); c("#" + y).remove(); o.createWidgetContainer(x.locationID, x.getID(), x.design.width, x.design.height, u, x.type); o.createWidgetForm(x.locationID, x.getID(), x.design.width, x.design.height, v, y); if (m.constants.READY_TO_RENDER) { l.Collector.timeEnd("paymentAuthorizationWidget-pre-render"); c("#" + y).submit() } }; i.exports = p }, { "../widgets/MetricsCollector": 51, "./Config": 16, "./Constants": 19, "./EventTypes": 21, "./InlineWidget": 24, "./InlineWidgetError": 25, "./LwaLogin": 27, "./Mediator": 28, "./Utilities": 35, "./jquery": 41 }], 30: [function (d, c, f) { var g = {}; var h = g.hasOwnProperty; function a(j, k) { if (!h.call(g, j)) { g[j] = [] } var i = g[j].push(k) - 1; return { remove: function () { delete g[j][i] } } } function b(l) { if (!h.call(g, l)) { return false } var k = Array.prototype.slice.call(arguments, 1); var j = g[l].length; var n; for (var m = 0; m < j; m++) { n = g[l][m]; if (typeof (n) === "function") { n.apply(null, k) } } return true } c.exports = { subscribe: a, publish: b } }, {}], 31: [function (b, a, d) { function c(g) { var h = []; for (var f in g) { if (g.hasOwnProperty(f)) { h.push(f + "=" + encodeURIComponent(g[f])) } } return h.join("&") } a.exports = { toParam: c } }, {}], 32: [function (b, i, f) { var c = "widgets-js-loading2"; function l(m) { return m.indexOf("OffAmazonPayments") > 0 && m.indexOf("Widgets.js") > 0 } function j() { try { if (typeof window.performance === "undefined") { return null } var p = window.performance.getEntries(), m = p.length, n = 0, o; for (; n < m; n++) { o = p[n]; if (l(o.name)) { return o } } return null } catch (q) { return null } } function k(n) { var m = j(); try { if (m !== undefined && m !== null) { n.addTiming(c, 0, m.duration); return true } return false } catch (o) { return false } } function a(o, m, n) { try { window.performance.measure(o, m, n) } catch (p) { return false } } function d(m) { try { window.performance.mark(m) } catch (n) { return false } } function g(m) { return d(m + "-start") } function h(m) { return d(m + "-end") } i.exports = { scriptIsWidgetsJS: l, getWidgetsJSPerformanceEntry: j, logWidgetsJSLoadingTime: k, mark: d, markStart: g, markEnd: h, measure: a } }, {}], 33: [function (b, a, g) { var i = { SessionStabilizer: {}, jQuery: b("./jquery") }; var f = b("./utilities/Cookie"); var d = b("./utilities/MetricsStore"); var c = b("./Config"); var h = { LOADED: "loaded", COMPLETE: "complete" }; i.SessionStabilizer = i.SessionStabilizer || {}; i.SessionStabilizer.constants = {}; i.SessionStabilizer.constants.SESSION_SET_COOKIE_NAME = "session-set"; i.SessionStabilizer.constants.SESSION_SET_COOKIE_VALUE = "true"; i.SessionStabilizer.constants.SESSION_SET_COOKIE_MAX_AGE = 175316; i.SessionStabilizer.constants.SESSIONSTABILIZER_CALL_ID = "sessionfix"; i.SessionStabilizer.constants.SESSIONSTABILIZER_METRIC_NAME = "session-stabilizer-time"; i.SessionStabilizer.isCallFinished = false; i.SessionStabilizer.toDoFunctions = []; i.SessionStabilizer.END_TIME = 0; i.SessionStabilizer.START_TIME = 0; i.SessionStabilizer.setSession = function () { var k = c.WIDGET_ENDPOINT + c.SESSION_STABILIZER_URL_PATH; function j() { i.SessionStabilizer.isCallFinished = true; if (!f.isCookiePresent(i.SessionStabilizer.constants.SESSION_SET_COOKIE_NAME)) { i.SessionStabilizer.END_TIME = (new Date()).getTime(); var n = { name: i.SessionStabilizer.constants.SESSIONSTABILIZER_METRIC_NAME, startTime: i.SessionStabilizer.START_TIME, endTime: i.SessionStabilizer.END_TIME }; d.add(n); f.createCookie(i.SessionStabilizer.constants.SESSION_SET_COOKIE_NAME, i.SessionStabilizer.constants.SESSION_SET_COOKIE_VALUE, i.SessionStabilizer.constants.SESSION_SET_COOKIE_MAX_AGE) } for (var l = 0; l < i.SessionStabilizer.toDoFunctions.length; l++) { var m = i.SessionStabilizer.toDoFunctions[l]; m.call() } } if (f.isCookiePresent(i.SessionStabilizer.constants.SESSION_SET_COOKIE_NAME)) { j() } else { i.SessionStabilizer.START_TIME = (new Date()).getTime(); i.SessionStabilizer.addScriptNodetoBody({ URI: k, id: i.SessionStabilizer.constants.SESSIONSTABILIZER_CALL_ID }, j) } }; i.SessionStabilizer.setSessionDone = function (j) { if (typeof j === "function") { if (i.SessionStabilizer.isCallFinished) { j.call() } else { i.SessionStabilizer.toDoFunctions.push(j) } } }; i.SessionStabilizer.addScriptNodetoBody = function (p, q) { var k = p.id; var j = p.URI; var n = function (s) { if (s.readyState) { s.onreadystatechange = function () { if (s.readyState === h.LOADED || s.readyState === h.COMPLETE) { q() } } } else { s.onload = q } }; if (typeof (k) !== "undefined" && k !== null && typeof (j) !== "undefined" && j !== null) { var l = i.jQuery("#" + k); if (l === null || typeof (l) === "undefined" || l.length === 0) { var r = document.createElement("script"); r.id = k; r.type = "text/javascript"; r.src = j; if (typeof (q) === "function") { n(r) } var m = document.getElementsByTagName("body")[0]; if (m !== null && typeof (m) !== "undefined") { m.appendChild(r) } else { var o = document.getElementsByTagName("script")[0]; o.parentNode.insertBefore(r, o) } } } }; a.exports = { SessionStabilizer: i.SessionStabilizer, setSession: i.SessionStabilizer.setSession, setSessionDone: i.SessionStabilizer.setSessionDone } }, { "./Config": 16, "./jquery": 41, "./utilities/Cookie": 43, "./utilities/MetricsStore": 46 }], 34: [function (b, a, c) { var d = { Widgets: {} }; d.Widgets.TaskQueue = function () { this.taskQueue = [] }; d.Widgets.TaskQueue.prototype.push = function (f) { this.taskQueue.push(f) }; d.Widgets.TaskQueue.prototype.pop = function () { return this.taskQueue.length > 0 ? this.taskQueue.shift() : null }; d.Widgets.TaskQueue.prototype.isEmpty = function () { return (this.taskQueue.length === 0) }; d.Widgets.Task = function () { }; d.Widgets.Task.prototype.execute = function () { }; d.Widgets.taskQueue = new d.Widgets.TaskQueue(); a.exports = { TaskQueue: d.Widgets.TaskQueue, getTaskQueue: function () { return d.Widgets.taskQueue }, setTaskQueue: function (f) { d.Widgets.taskQueue = f }, Task: d.Widgets.Task } }, {}], 35: [function (j, m, p) { var c = { Widgets: {} }; var v = j("./jquery"); var o = j("./Constants"); var k = j("./EventTypes"); var d = j("./Mediator").instance; var b = j("./LwaLogin"); var q = j("./TaskQueue"); var s = j("./Config"); var a = j("./SessionStabilizer"); var z = j("./DynamicConfig"); var l = j("./Weblab"); var r = "never"; var n = ["GB", "JP"]; var i = ["fr_FR", "it_IT", "es_ES"]; var x = { JP: "ja_JP", GB: "en_GB" }; var t = { ERROR: "ERROR" }; var u = { WINDOW_ALREADY_OPEN: "Error caught in popup window already opened", IS_INVALID_DOCUMENT: "Error caught in isValidDocInclusion" }; var h = { LOADED: "loaded", COMPLETE: "complete" }; c.Widgets.Mobile = (function () { var B = navigator.userAgent.toLowerCase(); var A = new Array("iphone", "ipod", "series60", "symbian", "android", "windows ce", "blackberry", "palm"); return { isMobile: function () { for (var D = 0; D < A.length; D++) { var C = A[D]; if (B.search(C) > -1) { return true } } return false } } })(); var w = function () { }; w.isIE = function () { return navigator.userAgent.match(/Trident\/|MSIE|Edge\//i) ? true : false }; c.Widgets.Browser = function () { }; c.Widgets.Browser.isFF = function () { return navigator.userAgent.match(/Firefox/i) }; w.isWin = function () { return navigator.userAgent.match(/Windows/i) }; w.isiOS = function () { return (navigator.userAgent.toLowerCase().match(/(ipad|iphone|ipod)/g) ? true : false) }; w.getClientId = function () { if (typeof b() !== "undefined" && typeof b().Login !== "undefined" && typeof b().Login.getClientId !== "undefined" && typeof b().Login.getClientId() !== "undefined") { return b().Login.getClientId() } return null }; w.isAmazonPaymentsButtonImage = function (A) { return (A.indexOf(s.WIDGET_ENDPOINT + o.constants.BUTTON_URI) === 0 || A.indexOf(o.constants.BUTTON_BASE_PATH_PREFIX) === 0 || A.indexOf(o.constants.MEASURE_BUTTON_LATENCY_BASE_PATH_PREFIX) === 0 || A.indexOf(o.constants.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX) === 0) || A.indexOf(o.constants.CLOUDFRONT_BUTTON_BASE_PATH) === 0 }; w.getLanguageForSeller = function (B, A) { if (w.isSellerAllowedForMultiLanguage(B, A)) { if (w.isValidLanguagePassedBySeller(A)) { return o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP[A.language.toLowerCase()] } var C = w.getBrowserLanguagePreference(); if (w.isBrowserLanguageSupported(C)) { return w.getBrowserLanguageToInternalLanguageMapping(C) } return o.constants.FALLBACK_MULTILANGUAGE_BUYER_LANGUAGE_PREFERENCE[s.COUNTRY_CODE] } return o.constants.COUNTRY_CODE_TO_REALM_MAP[s.COUNTRY_CODE.toLowerCase()] }; w.isValidLanguagePassedBySeller = function (A) { if (!w.isEmptyOrUndefined(A.language) && w.isElementInArray(A.language.toLowerCase(), o.constants.MULTILANGUAGE_ALLOWED_SELLER_LANGUAGE_CODES)) { return true } return false }; w.isBrowserLanguageSupported = function (A) { if (!w.isEmptyOrUndefined(A) && (A in o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP || A.substr(0, 2) in o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP)) { return true } return false }; w.getLanguageCountryForSeller = function (B, A) { return o.constants.REALM_TO_LANGUAGE_COUNTRY_MAP[w.getLanguageForSeller(B, A)] }; w.isSellerBlacklistedForMultiLanguage = function (A) { var B = []; if (!w.isEmptyOrUndefined(s.MULTI_LANGUAGE_SELLER_BLACKLIST)) { B = w.stringToArray(s.MULTI_LANGUAGE_SELLER_BLACKLIST) } return w.isElementInArray(A, B) }; w.isSellerWhitelistedForNAAccountDomain = function (A) { var B = []; if (!w.isEmptyOrUndefined(s.NA_ACCOUNT_DOMAIN_WHITELISTED_SELLERS)) { B = w.stringToArray(s.NA_ACCOUNT_DOMAIN_WHITELISTED_SELLERS) } return w.isElementInArray(A, B) }; w.isSellerAllowedForMultiLanguage = function (B, A) { if (!w.isSellerBlacklistedForMultiLanguage(B) && !w.isSellerAllowed(B, A) && w.isElementInArray(s.COUNTRY_CODE, o.constants.MULTILANGUAGE_ALLOWED_COUNTRY_CODES)) { return true } return false }; w.getNavigatorLanguages = function () { return navigator.languages }; w.getBrowserLanguagePreference = function () { var C; var A = w.getNavigatorLanguages(); if (!w.isEmptyOrUndefined(A)) { for (var B = 0; B < A.length; B++) { if (A[B].toLowerCase() in o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP) { C = A[B]; break } } } return C ? C : (navigator.language || navigator.browserLanguage || navigator.userLanguage) }; w.getBrowserLanguageToInternalLanguageMapping = function (B) { var A; if (typeof B !== "undefined") { A = w.getValueFromMap(o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP, B, undefined) || w.getValueFromMap(o.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP, B.substr(0, 2), undefined) } return A }; w.getValueFromMap = function (A, B, C) { if (typeof B !== "undefined" && typeof A !== "undefined" && B.toLowerCase() in A) { return A[B.toLowerCase()] } return C }; w.addLoadEventHandler = function (A) { var B = A.element; var C = A.method; var D = A.params; if (B.addEventListener) { B.addEventListener("load", function () { C(D) }, false) } else { if (B.attachEvent) { B.onreadystatechange = function () { if (B.readyState === h.LOADED || B.readyState === h.COMPLETE) { if ("function" === typeof C) { C(D) } } } } else { C(D) } } }; w.getCartOwnerId = function () { var A = o.constants.CartOwnerId; if (w.isEmptyOrUndefined(A)) { A = w.getUrlQueryParamValue(w.getWidgetsJsSrc(), "sellerId") } return A }; w.getWidgetsJsSrc = function () { var C = ""; var B = /.*OffAmazonPayments.*\/Widgets\.js.*/g; var A = document.scripts; v(A).each(function (F, E) { var D = B.exec(E.src); if (!w.isEmptyOrUndefined(D)) { C = D[0]; return false } }); return C }; w.getUrlQueryParamValue = function (B, A) { var C = ""; var D = B.match(A + "=(.*)&") || B.match(A + "=(.*)"); if (!w.isEmptyOrUndefined(D)) { C = D[1] } return C }; w.openPopUp = function (F) { var E = (window.screen.width - o.constants.POPUP_WIN_WIDTH) / 2; var D = (window.screen.height - o.constants.POPUP_WIN_HEIGHT) / 2; var G = "top=" + D + ",left=" + E + ",width=" + o.constants.POPUP_WIN_WIDTH + ",height=" + o.constants.POPUP_WIN_HEIGHT + ", resizable=yes,menubar=no,toolbar=no"; if (v.browser.safari || v.browser.msie) { G = G + ",location=no,status=yes" } var C; if (c.Widgets.Mobile.isMobile()) { C = window.open("", F) } else { C = window.open("", F, G) } try { C.document.write(o.constants.POPUP_LOADING_HTML); C.focus() } catch (B) { if (window.ueLogError) { var A = { logLevel: t.ERROR, attribution: "Widget_core.js", message: u.WINDOW_ALREADY_OPEN }; window.ueLogError(B, A) } } return C }; w.jsonp_ = function (A) { if (A.url) { if (A.id) { w.addScriptNodetoBody({ URI: A.url, id: A.id }) } else { v.ajax({ url: A.url, dataType: "jsonp", crossDomain: true, success: function (B) { A.success(B) }, error: A.error }) } } }; w.jsonp = function (A) { a.setSessionDone(function () { w.jsonp_(A) }) }; w.addScriptNodetoBody = function (G, H) { var B = G.id; var A = G.URI; var E = function (J) { if (J.readyState) { J.onreadystatechange = function () { if (J.readyState === h.LOADED || J.readyState === h.COMPLETE) { H() } } } else { J.onload = H } }; if (typeof (B) !== "undefined" && B !== null && typeof (A) !== "undefined" && A !== null) { var C = v("#" + B); if (C === null || typeof (C) === "undefined" || C.length === 0) { var I = document.createElement("script"); I.id = B; I.type = "text/javascript"; I.src = A; if (typeof (H) === "function") { E(I) } var D = document.getElementsByTagName("body")[0]; if (D !== null && typeof (D) !== "undefined") { D.appendChild(I) } else { var F = document.getElementsByTagName("script")[0]; F.parentNode.insertBefore(I, F) } } } }; w.setNewHash = function (A) { var B = window.top.location.href; B = B.replace(/#.*$/, "#"); if (A.length > 0) { B += A } window.top.location.replace(B) }; w.removeFromHash = function (B, A) { B = decodeURIComponent(B); B = B.replace(A, ""); B = encodeURIComponent(B); return B }; w.pollTaskQueue = function () { while (!q.getTaskQueue().isEmpty()) { var A = q.getTaskQueue().pop(); if (typeof (A.execute) === "function") { A.execute() } } window.setTimeout(w.pollTaskQueue, o.constants.TIMER_INTERVAL) }; w.pollEvents = function () { var B = window.top.location.hash; if (!B) { return } B = B.replace(/#/, ""); var A = w.parseMessage(B); if (typeof (A.stringToBeRemoved) !== "undefined") { B = w.removeFromHash(B, A.stringToBeRemoved); w.setNewHash(B); d.notifyListeners(A) } }; w.handleMessage = function (B) { if (typeof (B) === "undefined" || (B.origin !== s.WIDGET_ENDPOINT && B.origin !== w.getWidgetDomain())) { return } var C = B.data; if (typeof (C) === "undefined") { return } var A = w.parseMessage(C); if (typeof (A.eventName) !== "undefined") { d.notifyListeners(A) } }; w.parseMessage = function (L) { var F = {}; var K; var I; var E; if (L.indexOf(k.EXPRESS_CHK_ONAUTHORIZE, 0) >= 0) { E = L.indexOf(k.EXPRESS_CHK_ONAUTHORIZE, 0); var B = L.substring(E + k.EXPRESS_CHK_ONAUTHORIZE.length); F.eventName = k.EXPRESS_CHK_ONAUTHORIZE; F.eventValue = B; F.stringToBeRemoved = k.EXPRESS_CHK_ONAUTHORIZE + B } else { if (L.indexOf(k.REFRESH, 0) >= 0) { F.eventName = k.REFRESH; F.eventValue = ""; F.stringToBeRemoved = k.REFRESH } else { if (L.indexOf(k.WIDGET_REFRESH, 0) >= 0) { E = L.indexOf(k.WIDGET_REFRESH, 0); K = L.substring(E + k.WIDGET_REFRESH.length); F.eventName = k.WIDGET_REFRESH; F.eventValue = K; F.stringToBeRemoved = k.WIDGET_REFRESH + K } else { if (L.indexOf(k.ON_ADDRESS_SELECT, 0) >= 0) { E = L.indexOf(k.ON_ADDRESS_SELECT, 0); K = L.substring(E + k.ON_ADDRESS_SELECT.length); F.eventName = k.ON_ADDRESS_SELECT; F.eventValue = K; F.stringToBeRemoved = k.ON_ADDRESS_SELECT + K } else { if (L.indexOf(k.ON_ADDRESS_SELECT_PRE, 0) >= 0) { E = L.indexOf(k.ON_ADDRESS_SELECT_PRE, 0); K = L.substring(E + k.ON_ADDRESS_SELECT_PRE.length); F.eventName = k.ON_ADDRESS_SELECT_PRE; F.eventValue = K; F.stringToBeRemoved = k.ON_ADDRESS_SELECT_PRE + K } else { if (L.indexOf(k.ON_PAYMENT_SELECT, 0) >= 0) { E = L.indexOf(k.ON_PAYMENT_SELECT, 0); K = L.substring(E + k.ON_PAYMENT_SELECT.length); F.eventName = k.ON_PAYMENT_SELECT; F.eventValue = K; F.stringToBeRemoved = k.ON_PAYMENT_SELECT + K } else { if (L.indexOf(k.ON_CLOSE, 0) >= 0) { E = L.indexOf(k.ON_CLOSE, 0); K = L.substring(E + k.ON_CLOSE.length); F.eventName = k.ON_CLOSE; F.eventValue = K; F.stringToBeRemoved = k.ON_CLOSE + K } else { if (L.indexOf(k.ON_PPH_WIDGET_CLOSE, 0) >= 0) { F.eventName = k.ON_PPH_WIDGET_CLOSE; F.eventValue = ""; F.stringToBeRemoved = k.ON_PPH_WIDGET_CLOSE } else { if (L.indexOf(k.ON_CONSENT_WIDGET_READY, 0) >= 0) { E = L.indexOf(k.ON_CONSENT_WIDGET_READY, 0); F.eventName = k.ON_CONSENT_WIDGET_READY; F.eventValue = L.substring(E + k.ON_CONSENT_WIDGET_READY.length); F.stringToBeRemoved = F.eventName + F.eventValue } else { if (L.indexOf(k.ON_CONSENT_STATUS_CHANGED, 0) >= 0) { E = L.indexOf(k.ON_CONSENT_STATUS_CHANGED, 0); F.eventName = k.ON_CONSENT_STATUS_CHANGED; F.eventValue = L.substring(E + k.ON_CONSENT_STATUS_CHANGED.length); F.stringToBeRemoved = F.eventName + F.eventValue } else { if (L.indexOf(k.ON_PAYMENT_AUTHORIZATION, 0) >= 0) { var D = {}; E = L.indexOf(k.ON_PAYMENT_AUTHORIZATION); I = L.substring(E + k.ON_PAYMENT_AUTHORIZATION.length); E = I.indexOf(o.constants.WIDGETID_PARAM_NAME); D.widgetID = I.substring(E + o.constants.WIDGETID_PARAM_NAME.length); F.eventName = k.ON_PAYMENT_AUTHORIZATION; F.stringToBeRemoved = I; D.paymentAuthorizationResult = I.substring(1, E); F.eventValue = D } else { if (L.indexOf(k.ON_ERROR, 0) >= 0) { E = L.indexOf(k.ON_ERROR); I = L.substring(E + k.ON_ERROR.length); E = I.indexOf(o.constants.WIDGETID_PARAM_NAME); K = I.substring(E + o.constants.WIDGETID_PARAM_NAME.length); F.eventName = k.ON_ERROR; F.eventValue = K; F.stringToBeRemoved = I; var C = I.substring(0, E); E = C.indexOf("="); var J = C.substring(0, E); var G = C.substring(E + "=".length); F.error = (function (N, M) { return { getErrorCode: function () { return N }, getErrorMessage: function () { return M } } })(J, G) } else { if (L.indexOf(k.REDIRECT_URL, 0) >= 0) { E = L.indexOf(k.REDIRECT_URL, 0); var A = L.substring(E + k.REDIRECT_URL.length); F.eventName = k.REDIRECT_URL; F.eventValue = A; F.stringToBeRemoved = k.REDIRECT_URL + A } else { if (L.indexOf(k.CHANGE_HEIGHT, 0) >= 0) { E = L.indexOf(k.CHANGE_HEIGHT); I = L.substring(E + k.CHANGE_HEIGHT.length); E = I.indexOf(o.constants.WIDGETID_PARAM_NAME); K = I.substring(E + o.constants.WIDGETID_PARAM_NAME.length); F.eventName = k.CHANGE_HEIGHT; F.stringToBeRemoved = I; var H = I.substring(1, E); F.eventValue = K + ";" + H } } } } } } } } } } } } } } return F }; w.eraseCookie = function (A) { w.createCookie(A, "", -1) }; w.createCookie = function (C, E, A) { var D = ""; if (A) { var B = new Date(); B.setTime(B.getTime() + (A * 60 * 60 * 1000)); D = "; expires=" + B.toGMTString() } document.cookie = C + "=" + E + D + "; path=/" }; w.isCookiePresent = function (B) { var A = w.readCookie(B); if (undefined !== A && null !== A) { return true } else { return false } }; w.readCookie = function (E) { if (document.cookie && document.cookie !== "") { var C = document.cookie.split(";"); for (var B = 0; B < C.length; B++) { var F = C[B]; var D = F.split("="); var A = D[0].replace(/ /, ""); if (A.indexOf(E) === 0) { return D[1] } } } return null }; w.createWidgetContainer = function (I, J, C, H, F, G, E) { var K = ""; if (G === o.others.WidgetTypes.Wallet) { K = s.PAYMENT_METHOD } else { if (G === o.others.WidgetTypes.AddressBook) { K = s.ADDRESS_BOOK } } var A = w.getDefaultWidgetContainerStyle(C, H, "block", E); var B = 'id="' + J + '"'; var D = '<div class="widget-container" ' + A + " " + B + ">"; if (s.NEW_WIDGETS === true) { D += '<h1 style="background: url(&quot;' + s.AP_LOGO_IMG_REBRANDING + '&quot;) no-repeat; width: 104px; height: 20px; position: absolute; top: 10px; left:15px; z-index: 11;"></h1>' } else { D += "<h1 style='font-family: Arial, Helvetica, san-serif; margin: 7px; font-size: 14px; font-weight: bold; padding: 0 0 0 30px; height: 22px; line-height: 22px; position: absolute; z-index: 11; color: #2f3841; top: 0; left: 0'>" + K + "</h1>" } if (F !== undefined) { D += F } D += "</div>"; v("#" + I).html(D); return v("#" + J) }; w.isEmptyOrUndefined = function (A) { return (typeof (A) === "undefined" || A === null || A.length === 0) }; w.isBoolean = function (A) { return (typeof (A) === "boolean" || A.toLowerCase() === "true" || A.toLowerCase() === "false") }; w.getDefaultWidgetContainerStyle = function (C, D, A, E) { A = w.isEmptyOrUndefined(A) ? "block" : A; var B = 'style="padding: 0; margin: 0; overflow: hidden; display: ' + A + "; "; if (/%/.test(String(C)) && /%/.test(String(D))) { B += "width: " + C + "; height: " + D + "; " } else { B += "width: " + C + "px; height: " + D + "px; " } B += s.getWidgetsBackgroundStyle(E); B += 'position: relative;"'; return B }; w.createWidgetForm = function (K, L, D, J, I) { var E = v("#" + K); var G = E.closest("form"); var B; var C; if (typeof (G) !== "undefined" && G.length > 0) { L += "WidgetForm"; B = w.getDefaultWidgetContainerStyle(D, J, "none"); C = 'id="' + L + '"'; var H = "<span " + B + " " + C + ">" + I + "</span>"; v(H).insertAfter(G) } else { var F = v("#" + L); if (F.length === 0) { B = w.getDefaultWidgetContainerStyle(D, J); C = 'id="' + L + '"'; var A = "<span " + B + " " + C + "></span>"; E.html(A) } F = v("#" + L); F.append(I) } }; w.createIFrameString = function (C, A, B) { return w.createTransparentIframeStringWithSrc(C, "", A, B) }; w.createTransparentIframeStringWithSrc = function (F, E, B, D) { var A = 'style="margin: 0; padding: 0; box-sizing: border-box; -moz-box-sizing: border-box; border: 1px solid #bbb; border-radius: 6px; overflow: hidden; position: absolute; z-index: 12; visibility: visible; top: 0; left: 0"'; var C = '<iframe id="' + F + '" name="' + F + '" '; C += 'src="' + E + '" '; C += A; C += 'frameborder="no" '; C += 'scrolling="no" '; C += 'allowTransparency="true" '; C += "width=" + B + " height=" + D + " onload=\"OffAmazonPayments.Widgets.Utilities.show('" + F + "')\";></iframe>"; return C }; w.createIframeStringWithSrc = function (F, E, B, D) { var A = 'style="margin: 0; padding: 0; border-width: 0; overflow: hidden;"'; var C = '<iframe id="' + F + '" name="' + F + '" '; C += 'src="' + E + '" '; C += A; C += 'frameborder="no" '; C += 'scrolling="no" '; C += 'allowtransparency="true" '; C += "width=" + B + " height=" + D + " onload=\"OffAmazonPayments.Widgets.Utilities.show('" + F + "')\";></iframe>"; return C }; w.hide = function (A) { v("#" + A).css("visibility", "hidden") }; w.show = function (A) { v("#" + A).css("visibility", "visible") }; w.createFormString = function (E, A, F, D) { var C = 'style="display: none; margin: 0; padding: 0; border-width: 0; overflow: hidden;"'; var B = "<form " + C + ' id="' + E + '" '; B += 'action="' + A + '" '; B += 'method="POST" '; if (F !== null && F !== "" && F !== undefined) { B += 'target="' + F + '"' } B += ">"; v.each(D, function (G, H) { B += '<input type="hidden" name="' + G + '" value="' + H + '"/>' }); B += "</form>"; return B }; function y(A, B) { return A.indexOf(B, A.length - B.length) !== -1 } w.isValidSizeValue = function (A) { if (A === undefined) { return false } if (y(A.toUpperCase(), o.constants.UNIT_PX)) { A = A.substring(0, A.length - o.constants.UNIT_PX.length) } if (A === null || typeof (A) === "undefined" || isNaN(A)) { return false } return true }; w.verifySize = function (C, D, B, A) { if (!this.isValidSizeValue(C)) { return D } C = parseFloat(C); if (C < B) { return B } if (C > A) { return A } return C }; w.sendOnErrorCallbackMessage = function (D, B, A) { var C = {}; C.eventName = k.ON_ERROR; C.eventValue = A; C.error = (function (F, E) { return { getErrorCode: function () { return F }, getErrorMessage: function () { return E } } })(D, B); d.notifyListeners(C) }; w.baseDomainsMatch = function (D, A) { if (typeof (D) !== "string" || typeof (A) !== "string") { return false } var B = true; var E = D.split("."); var C = A.split("."); if (E.length >= 2 && C.length >= 2) { B = (E[E.length - 1] === C[C.length - 1]) && (E[E.length - 2] === C[C.length - 2]) } return B }; w.formatMsg = function (A, B) { for (var C in B) { if (B.hasOwnProperty(C)) { A = A.replace(C, B[C]) } } return A }; w.buildParamNameValueMap = function (A, B) { var C = {}; C[o.constants.PARAM_NAME] = A; C[o.constants.PARAM_VALUE] = B; return C }; w.getValueBasedOnInput = function (A, C, B) { if (typeof C !== "undefined" && A.indexOf(C.toLowerCase()) > -1) { return C.toLowerCase() } return B }; w.getButtonPathForLatencyMeasurement = function (A) { var B = [o.constants.MEASURE_BUTTON_LATENCY_BASE_PATH_PREFIX, w.getValueBasedOnInput(o.constants.BUTTON_LWA_COLOR_SET, A.color, o.constants.BUTTON_DEFAULT_COLOR_LWA), w.getValueBasedOnInput(o.constants.BUTTON_LWA_SIZE_SET, A.size, o.constants.BUTTON_DEFAULT_SIZE_LWA), o.constants.LATENCY_MEASURE_BUTTON_TYPE]; return B.join("/") }; w.getRebrandingBlacklistedMerchants = function () { return z.get("rebrandingMerchantBlackList") }; w.getMeasureLatencyFlag = function () { return z.get("measureNewButtonLatency") }; w.overrideUsingCloudFrontImage = function (B, C, A) { var D = w.getRebrandingBlacklistedMerchants(); if (D !== null && D.indexOf(C) >= 0 && A.type.toLowerCase() === "pwa") { B = w.getButtonPathForLatencyMeasurement(A) } return B }; function g(C, B) { if (!B) { B = "T1" } var A = C.substr(0, C.lastIndexOf(".")) + "_" + B; A += C.substr(C.lastIndexOf(".")); return A } w.getRebrandedButtonPath = function (I, G, D) { if (I.type === undefined || I.type === null) { return null } var E = I.type.toLowerCase(); if ((E !== "pwa") && (E !== "pay") && (E !== "amazonpay") && (E !== "a") && (E !== "hostedpayment")) { return null } if (E === "pwa" || E === "hostedpayment") { E = "amazonpay" } var B = w.getLanguageForSeller(D, I).toLowerCase(); var C = s.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX; var H = w.getValueBasedOnInput(o.constants.BUTTON_LWA_COLOR_SET, I.color, o.constants.BUTTON_DEFAULT_COLOR_LWA); var J = w.getValueBasedOnInput(o.constants.BUTTON_LWA_SIZE_SET, I.size, o.constants.BUTTON_DEFAULT_SIZE_LWA); var K = g(o.constants.BUTTON_REBRANDED_IMAGE_NAME, G); var A = [B, E, H, J, K]; var F = A.join("/"); return (C + F) }; w.getAPARebrandedButtonPath = function (I, D) { if (s.COUNTRY_CODE === "JP") { return null } var E = o.constants.BUTTON_DEFAULT_COLOR; var G = o.constants.BUTTON_DEFAULT_SIZE; var F = o.constants.BUTTON_DEFAULT_BACKGROUND; var A = ""; if (I !== undefined) { E = w.getValueBasedOnInput(o.constants.BUTTON_COLOR_SET, I.color, o.constants.BUTTON_DEFAULT_COLOR); G = w.getValueBasedOnInput(o.constants.BUTTON_SIZE_SET, I.size, o.constants.BUTTON_DEFAULT_SIZE); F = w.getValueBasedOnInput(o.constants.BUTTON_BACKGROUND_SET, I.background, o.constants.BUTTON_DEFAULT_BACKGROUND) } var C = s.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX; var H = g(o.constants.BUTTON_REBRANDED_IMAGE_NAME, D); var B = [o.constants.APA_BUTTON_TYPE, E, G, H]; A = C + B.join("/"); return A }; w.getLWAButtonPath = function (F, D, I) { var G = w.getLWAButtonBasePath(D); var C = "lwa/"; if (z.valueForKeyIsTrue(o.dynamic_config_keys.SERVE_BUTTONS_FROM_CLOUDFRONT)) { G = o.constants.CLOUDFRONT_BUTTON_BASE_PATH; var H = o.constants.REALM_TO_COUNTRY_CODE_MAP[D]; if (H.toLowerCase() !== s.COUNTRY_CODE.toLowerCase()) { var A = "/" + s.COE.toLowerCase() + "/"; G = G.replace(A, A + D + "/") } } var B = o.constants.BUTTON_DEFAULT_TYPE; if (I) { C = "donation/" } if (F.type === "AmazonPay") { F.type = "PwA" } C += w.getValueBasedOnInput(o.constants.BUTTON_LWA_COLOR_SET, F.color, o.constants.BUTTON_DEFAULT_COLOR_LWA); C += "/"; C += w.getValueBasedOnInput(o.constants.BUTTON_LWA_SIZE_SET, F.size, o.constants.BUTTON_DEFAULT_SIZE_LWA); C += "/"; if (typeof F.type !== "undefined") { if (o.constants.BUTTON_LWA_TEXT_SET.indexOf(F.type.toLowerCase()) > -1) { C += o.constants.BUTTON_LWA_TEXT_IMAGE_SET[o.constants.BUTTON_LWA_TEXT_SET.indexOf(F.type.toLowerCase())]; B = F.type } else { C += o.constants.BUTTON_DEFAULT_TEXT } } else { C += o.constants.BUTTON_DEFAULT_TEXT } var E = G + C; if (E.indexOf(B + ".svg") !== -1) { E = E.replace(/x-large|large|medium|small/, "svg") } return E }; w.getLWAButtonBasePath = function (C) { var B = o.constants.BUTTON_BASE_PATH_PREFIX + o.constants.COUNTRY_CODE_TO_LANGUAGE_COUNTRY_MAP[s.COUNTRY_CODE]; var A = o.constants.REALM_TO_COUNTRY_CODE_MAP[C]; if (A.toLowerCase() !== s.COUNTRY_CODE.toLowerCase()) { B += "/" + C } B += o.constants.BUTTON_BASE_PATH_SUFFIX; return B }; w.getButtonPath = function (H, E) { var A = ""; var C = ""; var B = ""; var D = ""; if (H !== undefined) { A = w.getValueBasedOnInput(o.constants.BUTTON_COLOR_SET, H.color, o.constants.BUTTON_DEFAULT_COLOR); C = w.getValueBasedOnInput(o.constants.BUTTON_SIZE_SET, H.size, o.constants.BUTTON_DEFAULT_SIZE); B = w.getValueBasedOnInput(o.constants.BUTTON_BACKGROUND_SET, H.background, o.constants.BUTTON_DEFAULT_BACKGROUND) } else { A = o.constants.BUTTON_DEFAULT_COLOR; C = o.constants.BUTTON_DEFAULT_SIZE; B = o.constants.BUTTON_DEFAULT_BACKGROUND } if (c.ABTest.Utilities.isSellerInABTest(w.getCartOwnerId(), c.ABTest.Tests.Default)) { D = c.ABTest.Utilities.getButtonPath(A, C) } else { var G = o.constants.BUTTON_BASE_PATH; var F = ""; if (E) { F = "donation/" } else { F = "pwa/" } F += A + "/" + C + "/" + B + "/"; D = G + F } return D }; w.isValidDocInclusion = function () { var B = true; try { var C = window.top.document.domain; var E = document.domain; B = w.baseDomainsMatch(C, E) } catch (D) { if (window.ueLogError) { var A = { logLevel: t.ERROR, attribution: "Widget_core.js", message: u.IS_INVALID_DOCUMENT }; window.ueLogError(D, A) } B = false } return B }; w.performContractAction = function (E, B) { var C = w.createIframeStringWithSrc(o.constants.CONTRACT_FRAME_ID, "", 0, 0); v("#" + o.constants.CONTRACT_FRAME_ID).remove(); v("body").append(C); var A = w.getWidgetDomain() + s.CREATE_CONTRACT_URL_PATH; var D = w.createFormString(o.constants.CONTRACT_FORM_ID, A, o.constants.CONTRACT_FRAME_ID, E); v("#" + o.constants.CONTRACT_FORM_ID).remove(); v("#" + B).append(D); v("#" + o.constants.CONTRACT_FORM_ID).submit() }; w.getAccessToken = function (E, D) { var B = ""; if (typeof (E) !== "undefined" && E !== null) { B = E.getSellerId() } w.setLoginDomain(B); var A = { scope: "payments:widget", interactive: r }; if (E && E.scope) { A.scope = E.scope } var C = b().Login.authorize(A); C.onComplete(function (F) { if (F.error) { D(E, F.error) } else { D(E, F.access_token) } }) }; w.setLwaSandboxMode = function () { if (s.IS_SANDBOX === "true" && typeof b() !== "undefined" && typeof b().Login !== "undefined") { b().Login.setSandboxMode(true) } }; w.setLanguage = function (B, A) { if (typeof b() !== "undefined" && typeof b().Login !== "undefined") { var C = w.getLanguageForSeller(B, A); if (w.isSellerAllowedForMultiLanguage(B, A) && !w.isEmptyOrUndefined(A.language)) { b().Login.setLanguageHint(C) } } }; w.setLoginDomain = function (B) { if (typeof b() !== "undefined" && typeof b().Login !== "undefined") { var A = s.LWA_ENDPOINT; var C = s.LWA_ENDPOINT; if (w.isSellerWhitelistedForNAAccountDomain(B)) { A = s.NA_ACCOUNT_DOMAIN_ENDPOINT; C = s.NA_ACCOUNT_DOMAIN_ENDPOINT; b().Login.setLanguage(o.constants.COUNTRY_CODE_TO_REALM_MAP[s.COUNTRY_CODE.toLowerCase()]) } else { if (w.isConnectedAuth()) { var D = w.isCookiePresent(o.constants.SELLER_LANGUAGE) ? w.readCookie(o.constants.SELLER_LANGUAGE) : ""; A = w.getLoginDomainForConnectedAuth(D) } } b().Login.setDomain(z.get("LWAEndpointOverride") || A); w.setLWADomain(z.get("LWAEndpointOverride") || C) } }; w.setLWADomain = function (A) { if (typeof b() !== "undefined" && typeof b().Login !== "undefined" && typeof b().Login.setLWADomain !== "undefined") { b().Login.setLWADomain(A) } }; w.getLoginDomainForConnectedAuth = function (C) { var B = s.LOGIN_ENDPOINT; if (s.COUNTRY_CODE === "DE") { if (w.isElementInArray(C, o.constants.FRITES_LANGUAGES)) { var A = o.constants.REALM_TO_LANGUAGE_COUNTRY_MAP[C]; B = s.LOGIN_ENDPOINTS_FOR_FRITES_COUNTRY_CODE[A] } } return B }; w.isConnectedAuth = function () { return w.readCookie(o.constants.CONNECTED_AUTH_COOKIE_NAME) === o.others.ConnectedAuthCookieValues.CONNECTEDAUTH_GENERAL }; w.setWebflowParams = function (C, B, A) { if (typeof b() !== "undefined" && typeof b().Login !== "undefined" && typeof b().Login.setWebflowParams !== "undefined") { b().Login.setWebflowParams(C, B, A) } }; w.validationException = function () { return o.constants.PARAMETER_VALIDATION_FAILED_MSG }; w.isSellerHidingButton = function (I) { var A = v("#" + I).css("display"); var F = v("#" + I + " > img").css("display"); var L = (A === "none" || F === "none"); var C = v("#" + I).css("opacity"); var N = v("#" + I + " > img").css("opacity"); var M = (C === "0" || N === "0"); var B = v("#" + I).css("visibility"); var H = v("#" + I + " > img").css("visibility"); var D = (B === "hidden" || H === "hidden"); var E = v("#" + I).css("position"); var G = parseInt(v("#" + I).css("left")); var K = parseInt(v("#" + I).css("right")); var J = (E === "absolute" && (G < 0 || K < 0)); return (L || M || D || J) }; w.isSVGSupported = function () { return !!("createElementNS" in document && document.createElementNS(o.constants.SVG_NAMESPACE, "svg").createSVGRect) }; w.isSellerAllowed = function (B, A) { if ((typeof A.height !== "undefined") || (typeof A.width !== "undefined")) { return true } return false }; function f(B) { B = B.toLowerCase(); var A = (B.indexOf("ipod") >= 0 || B.indexOf("iphone") >= 0 || B.indexOf("ipad") >= 0) && !B.match(/\sos\s*6_0/); return A === true } w.createSubclass = function (A) { function B() { } B.prototype = A; return new B() }; w.imageInDOM = function (A) { return A !== undefined && A.width > 1 && A.height > 1 }; w.isElementInArray = function (A, B) { if (!w.isEmptyOrUndefined(A) && !w.isEmptyOrUndefined(B)) { return v.inArray(A, B) >= 0 } return false }; w.removeWhiteSpacesInString = function (A) { if (A !== undefined) { var B = A.replace(/\s+/g, ""); return B } return A }; w.stringToArray = function (A) { var B = w.removeWhiteSpacesInString(A); return B.split(",") }; w.createQueryString = function (E) { var C = "?"; var D = true; for (var A in E) { if (E.hasOwnProperty(A)) { var B = E[A]; if (D) { C += A + "=" + encodeURIComponent(B); D = false } else { C += "&" + A + "=" + encodeURIComponent(B) } } } return C }; w.Timezone = function () { }; w.generateLocalDomain = function (A, B) { if (A === "Devo") { return s.WIDGET_ENDPOINT } if (A && B) { return "https://" + A + ".amazon." + B } else { return s.WIDGET_ENDPOINT } }; w.getWidgetDomain = function () { var B = o.others.ConnectedAuthCookieValues.CONNECTEDAUTH_GENERAL; var A = w.readCookie(o.constants.SELLER_LANGUAGE); if (w.readCookie(o.constants.CONNECTED_AUTH_COOKIE_NAME) === B) { if (n.indexOf(s.COUNTRY_CODE) !== -1) { A = x[s.COUNTRY_CODE]; return w.generateLocalDomain(s.LOCAL_DOMAIN_PREFIX, s.LOCAL_DOMAIN_SUFFIX_MAP[A]) } if (s.COUNTRY_CODE === "DE") { if (i.indexOf(A) === -1) { A = "de_DE" } return w.generateLocalDomain(s.LOCAL_DOMAIN_PREFIX, s.LOCAL_DOMAIN_SUFFIX_MAP[A]) } } return s.WIDGET_ENDPOINT }; w.Timezone.appendTimezoneDetails = function (A) { A[o.constants.TIMEZONE_JANUARY_OFFSET] = w.Timezone._getJanuaryOffset(); A[o.constants.TIMEZONE_JUNE_OFFSET] = w.Timezone._getJuneOffset(); return A }; w.Timezone._getJanuaryOffset = function () { return w.Timezone._getDateOffset(o.constants.TIMEZONE_JANUARY_REF_DATE) }; w.Timezone._getJuneOffset = function () { return w.Timezone._getDateOffset(o.constants.TIMEZONE_JUNE_REF_DATE) }; w.Timezone._getDateOffset = function (A) { var B = -A.getTimezoneOffset(); return (B !== null ? B : 0) }; w.addLpaButtonAttributesToMetrics = function (A, C, E) { var B = "|color:" + w.getValueBasedOnInput(o.constants.BUTTON_LWA_COLOR_SET, C.color, o.constants.BUTTON_DEFAULT_COLOR_LWA); E.addInfoOrEntry("additional-request-data", B, "info"); var D = "|size:" + w.getValueBasedOnInput(o.constants.BUTTON_LWA_SIZE_SET, C.size, o.constants.BUTTON_DEFAULT_SIZE_LWA); E.addInfoOrEntry("additional-request-data", D, "info"); w.addButtonDimensionAndMargin(E, A) }; w.addApaButtonAttributesToMetrics = function (F, D) { var A = o.constants.BUTTON_DEFAULT_COLOR; var B = o.constants.BUTTON_DEFAULT_SIZE; if (typeof (F) !== "undefined") { A = F.color; B = F.size } var C = "|color:" + w.getValueBasedOnInput(o.constants.BUTTON_COLOR_SET, A, o.constants.BUTTON_DEFAULT_COLOR); D.addInfoOrEntry("additional-request-data", C, "info"); var E = "|size:" + w.getValueBasedOnInput(o.constants.BUTTON_SIZE_SET, B, o.constants.BUTTON_DEFAULT_SIZE); D.addInfoOrEntry("additional-request-data", E, "info") }; w.addButtonDimensionAndMargin = function (E, B) { var C = v("#" + B + " > img"); var D = "|dimension:" + C.width() + "x" + C.height(); E.addInfoOrEntry("additional-request-data", D, "info"); var A = "|margin:" + parseInt(C.css("margin-top"), 10) + "x" + parseInt(C.css("margin-bottom"), 10) + "x" + parseInt(C.css("margin-left"), 10) + "x" + parseInt(C.css("margin-right"), 10); E.addInfoOrEntry("additional-request-data", A, "info") }; w.callLegacyABTest = function (B, E, C, D) { var A = s.WIDGET_ENDPOINT + s.ABTEST_URL_PATH + w.createQueryString({ merchantId: B, abtestName: D }); w.jsonp({ url: A, success: E, error: C }) }; w.callWebLab = function (A, D, B, C) { if (z.valueForKeyIsTrue(o.dynamic_config_keys.ENABLE_ABTEST_V2)) { l.loadWithName(C, D, B) } else { w.callLegacyABTest(A, D, B, C) } }; w.shouldInvokeSetTimeoutOnSigninForUserAgent = f; m.exports = w }, { "./Config": 16, "./Constants": 19, "./DynamicConfig": 20, "./EventTypes": 21, "./LwaLogin": 27, "./Mediator": 28, "./SessionStabilizer": 33, "./TaskQueue": 34, "./Weblab": 37, "./jquery": 41 }], 36: [function (c, i, f) { var b = c("./jquery"); var r = c("./Utilities"); var o = c("./Constants"); var j = c("./LwaLogin"); var p = c("./InlineWidgetError"); var g = c("./InlineWidget"); var l = c("./Mediator").instance; var a = c("./EventTypes"); var h = c("./Config"); var m = c("../widgets/MetricsCollector"); var n = c("./PubSub"); var q = "Form"; var k = "spaWalletWidget"; function d(s) { m.Collector.time("walletwidget-pre-render"); this.type = o.others.WidgetTypes.Wallet; g.call(this, s); this.onPaymentSelect = s.onPaymentSelect; this.theme = s.theme || h.defaultTheme; var t = this.design.width; var u = this.design.height; switch (this.getDisplayMode()) { case o.others.DisplayModes.read: if (this.design.checkWidth) { if (t === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.width", t)) } else { this.design.width = r.verifySize(t, undefined, o.constants.WALLET_WIDGET.READ.min_width, o.constants.WALLET_WIDGET.READ.max_width); p.RaiseOnErrorIfUndefined(this.design.width, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.width", t), this) } } if (this.design.checkHeight) { if (u === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.height", u)) } else { this.design.height = r.verifySize(u, undefined, o.constants.WALLET_WIDGET.READ.min_height, o.constants.WALLET_WIDGET.READ.max_height); p.RaiseOnErrorIfUndefined(this.design.height, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.height", u), this) } } break; case o.others.DisplayModes.edit: if (this.design.checkWidth) { if (t === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.width", t)) } else { this.design.width = r.verifySize(t, undefined, o.constants.WALLET_WIDGET.EDIT.min_width, o.constants.WALLET_WIDGET.EDIT.max_width); p.RaiseOnErrorIfUndefined(this.design.width, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.width", t), this) } } if (this.design.checkHeight) { if (u === undefined) { p.RaiseMissingParameterError(this, r.buildParamNameValueMap("design.height", u)) } else { this.design.height = r.verifySize(u, undefined, o.constants.WALLET_WIDGET.EDIT.min_height, o.constants.WALLET_WIDGET.EDIT.max_height); p.RaiseOnErrorIfUndefined(this.design.height, o.constants.INVALID_PARAMETER_VALUE_MSG, r.buildParamNameValueMap("design.height", u), this) } } break }b(this).bind(a.ON_PAYMENT_SELECT, this, this.onPaymentSelectHandler) } d.prototype = r.createSubclass(g.prototype); d.prototype.constructor = d; d.prototype.onPaymentSelectHandler = function (u) { n.publish("WALLET_RENDER_COMPLETE", this.getID(), this.getSellerId(), this.locationID); var s = u.data; var t = s.eventValue; if (this.getID() === t) { if (this.onPaymentSelect !== undefined) { this.onPaymentSelect(s) } } }; d.prototype.renderElements = function () { n.publish("WALLET_RENDER_START", this.getID()); if (this.hasError !== undefined && this.hasError) { b("#" + this.locationID).empty(); return false } var s = this; r.setLwaSandboxMode(); r.setWebflowParams(h.COE, h.LEDGER_CURRENCY, h.ENV); if (typeof j() !== "undefined" && typeof j().Login !== "undefined" && typeof j().Login.getClientId !== "undefined" && typeof j().Login.getClientId() !== "undefined") { r.getAccessToken(s, s.renderWallet) } else { s.renderWallet(s, "") } }; d.prototype.renderWallet = function (A, E) { c("./ABTestingNewWidgets").resetConfig(E, A.agreementType, A.getSellerId()); var s = A.getID() + "IFrame"; var y = r.createIFrameString(s, A.design.width, A.design.height); var t = A.getID() + q; var w = r.getWidgetDomain(); var v = w + h.WALLET_URL_PATH; var C = document.getElementById(A.locationID); var z = (C !== null) ? C.offsetWidth : A.design.width; var x = (C !== null) ? C.offsetHeight : A.design.height; var B = { action: k, referringURL: window.top.location, cartOwnerId: A.getSellerId(), marketplaceSellerId: A.getMarketplaceSellerId(), access_token: E, agreementType: A.agreementType, displayMode: A.getDisplayMode(), widgetId: A.getID(), widgetWidth: z, widgetHeight: x, widgetDesignMode: A.design.designMode, widgetPadding: A.design.padding, browserWindowHeight: A.getBrowserWindowHeight(), paymentInstrumentsDisplayOptions: A.getPaymentInstrumentsDisplayOptions(), clientId: r.getClientId(), coe: h.COE, env: h.ENV, ledgerCurrency: h.LEDGER_CURRENCY, theme: A.theme }; B = r.Timezone.appendTimezoneDetails(B); if (typeof A.getContractId() !== "undefined" && A.getContractId() !== null) { B.contractId = A.getContractId() } else { if (typeof A.onOrderReferenceCreate === "function") { B.createContract = true } else { if (typeof A.onBillingAgreementCreate === "function") { B.createContract = true } else { if (typeof A.onReady === "function") { B.createContract = true } } } } if (typeof A.getPresentmentCurrency() !== "undefined" && A.getPresentmentCurrency() !== null) { B.presentmentCurrency = A.getPresentmentCurrency() } p.isMissingParameter("sellerId", A.getSellerId(), A); if (A.error && A.error.errorType) { B.clientErrorType = A.error.errorType; B.clientErrorElementName = A.error.errorElementName; B.clientErrorElementValue = A.error.errorElementValue; B.clientErrorMessage = A.error.errorMessage } var u = r.createFormString(t, v, s, B); b("#" + t).remove(); r.createWidgetContainer(A.locationID, A.getID(), A.design.width, A.design.height, y, A.type, A.theme); r.createWidgetForm(A.locationID, A.getID(), A.design.width, A.design.height, u, t); var D = l.getAddressWidgets(); if (o.constants.READY_TO_RENDER) { if (D.length === 0 || D[0].rendered === true) { m.Collector.timeEnd("walletwidget-pre-render"); b("#" + t).submit() } else { o.constants.TIMEOUT_ID = window.setTimeout(function () { m.Collector.timeEnd("walletwidget-pre-render"); b("#" + t).submit() }, 5000) } } }; i.exports = d }, { "../widgets/MetricsCollector": 51, "./ABTestingNewWidgets": 3, "./Config": 16, "./Constants": 19, "./EventTypes": 21, "./InlineWidget": 24, "./InlineWidgetError": 25, "./LwaLogin": 27, "./Mediator": 28, "./PubSub": 30, "./Utilities": 35, "./jquery": 41 }], 37: [function (b, i, d) { var h = b("./CORS"); var g = b("./Config"); var p = b("./SessionStabilizer"); var j = "/abTestV2"; var l = null; var k = false; var n = []; var c = []; function m(r, s) { var q = r.pop(); while (typeof q === "function") { q(s); q = r.pop() } } function o(u, t, q) { if (!q && l) { u(l); return } if (k) { if (typeof u === "function") { n.push(u) } if (typeof t === "function") { c.push(t) } return } k = true; var v = h.createRequest("GET", f(), true); if (v) { var r = function () { k = false; l = null; if (typeof t === "function") { t() } m(c, null) }; var s = function () { k = false; var w = {}; try { w = JSON.parse(v.responseText); l = w; if (typeof u === "function") { u(w) } m(n, l) } catch (x) { l = null; if (typeof t === "function") { t() } m(c, null) } }; v.onload = s; v.onerror = r; v.send() } } function a(t, s, r, q) { p.setSessionDone(function () { o(function (u) { if (u && u.abTestResults && u.abTestResults[t]) { s({ treatment: u.abTestResults[t], abtestName: t }) } else { if (typeof r === "function") { r() } } }, r, q) }) } function f() { return g.WIDGET_ENDPOINT + j + "?countryOfEstablishment=" + g.COE + "&ledgerCurrency=" + g.LEDGER_CURRENCY + "&isSandbox=" + g.IS_SANDBOX } i.exports = { load: o, loadWithName: a } }, { "./CORS": 11, "./Config": 16, "./SessionStabilizer": 33 }], 38: [function (c, g, f) { var b = c("./jquery"); var j = c("./Utilities"); var i = c("./Constants"); var h = c("./Mediator").instance; var a = c("./EventTypes"); var d = c("../widgets/MetricsCollector"); function k(m) { this.collector = new d.Collector(); var l = i.constants.WIDGETID_PREFIX + h.generateUniqWidgetID(); this.getID = function () { return l }; this.getWidgetCount = function () { return h.getNumWidgetCount() }; h.register(this); b(this).bind(a.DOCUMENT_READY, this, this.documentReadyEventHandler); if (j.isEmptyOrUndefined(m.sellerId)) { m.sellerId = m.merchantId } this.getSellerId = function () { if (j.isEmptyOrUndefined(m.sellerId)) { return "" } return m.sellerId }; this.getMarketplaceSellerId = function () { if (j.isEmptyOrUndefined(m.marketplaceSellerId)) { return "" } return m.marketplaceSellerId } } k.prototype.renderImpl = function () { this.renderElements(); if (this.type === i.others.WidgetTypes.Button) { this.bindClickHandler(this) } }; k.prototype.removeEventListener = k.prototype.detachEvent = function () { }; k.prototype.bind = function (l) { var m = j.isValidDocInclusion(); if (m) { this.locationID = l; this.renderRequested = true; if (typeof this.design !== "undefined" && this.design.designMode !== null && this.design.designMode !== undefined) { if ((this.design.designMode === "smartphoneCollapsible" || this.design.designMode === "smartphoneNonCollapsible") && (b("#" + l).width() !== null)) { this.design.width = b("#" + l).width() } } if (this.type !== i.others.WidgetTypes.Button) { this.renderImpl() } else { if (b("#" + this.locationID).length > 0) { this.renderImpl(); b(this).unbind(a.DOCUMENT_READY, this.documentReadyEventHandler) } } } return this }; k.prototype.renderElements = function () { return "" }; k.prototype.bindClickHandler = function () { return "" }; k.prototype.documentReadyEventHandler = function (m, l) { if (this.renderRequested) { l.renderImpl() } }; k.prototype.getLocation = function () { return this.locationID }; k.prototype.getWidgetType = function () { return this.type }; k.prototype.encodeShippingRestrictions = function () { var l = JSON.stringify(this.shippingRestrictions); var m = l.replace(/\"/g, "&quot;"); return m }; g.exports = k }, { "../widgets/MetricsCollector": 51, "./Constants": 19, "./EventTypes": 21, "./Mediator": 28, "./Utilities": 35, "./jquery": 41 }], 39: [function (c, f, d) { var h = c("./InlineWidgetError"); var i = c("./Utilities"); var g = c("./Constants"); var b = c("./ABTestingNewWidgets"); var j = { RESPONSIVE: "responsive", SMART_PHONE_COLLAPSIBLE: "smartphoneCollapsible", SMART_PHONE_NON_COLLAPSIBLE: "smartphoneNonCollapsible" }; function a(k, l) { if (typeof (k) !== "undefined") { this.checkWidth = true; this.checkHeight = true; this.name = k.name; this.colorTheme = k.colorTheme; if (k.size !== null && k.size !== undefined) { this.width = k.size.width; this.height = k.size.height } if (k.designMode !== null && k.designMode !== undefined) { if (k.designMode === j.SMART_PHONE_COLLAPSIBLE || k.designMode === j.SMART_PHONE_NON_COLLAPSIBLE || k.designMode === j.RESPONSIVE) { this.designMode = k.designMode; h.SetErrorIfParameterExists("design.width", this.width, null, l, "smartphone"); this.width = document.body.clientWidth; this.checkWidth = false; if (k.padding !== null && k.padding !== undefined) { if (i.isValidSizeValue(k.padding)) { this.padding = parseFloat(k.padding) } else { h.RaiseOnError(g.constants.INVALID_PARAMETER_VALUE_MSG, i.buildParamNameValueMap("design.padding", k.padding), l) } } } else { l.error = new h(g.constants.INVALID_PARAMETER_VALUE, null, "design.designMode", k.designMode) } if (k.designMode === j.SMART_PHONE_COLLAPSIBLE) { this.height = 135; if (i.readCookie(b.cookie_name) === "true") { this.height = 228 } this.checkHeight = false } else { if (k.designMode === j.RESPONSIVE) { this.height = "100%"; this.width = "100%"; this.checkHeight = false; this.checkWidth = false } } } else { this.designMode = ""; h.SetErrorIfParameterExists("design.padding", k.padding, null, l, "nonSmartphone") } } else { h.RaiseOnErrorIfUndefined(k, g.constants.INVALID_PARAMETER_VALUE_MSG, i.buildParamNameValueMap("design", ""), l) } } f.exports = a }, { "./ABTestingNewWidgets": 3, "./Constants": 19, "./InlineWidgetError": 25, "./Utilities": 35 }], 40: [function (b, a, c) { a.exports = function () { if (window.OffAmazonPayments) { return window.OffAmazonPayments.ZERO_TIME } else { return 0 } } }, {}], 41: [function (b, a, c) { (function (d) { var f = (typeof window !== "undefined" ? window["$"] : typeof d !== "undefined" ? d["$"] : null); var g = f.noConflict(true); a.exports = g }).call(this, typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {}) }, {}], 42: [function (b, f, c) { var j = b("../PubSub"); var a = b("../jquery"); var d = b("../../widgets/MetricsCollector").Collector; var m = b("../CoinMetricsHelper"); var g = {}; var n = { address: "address_render_time", wallet: "wallet_render_time" }; var l = { address: "spaAddressWidget", wallet: "spaWalletWidget" }; var k = { address: "spaAddressWidgetRender", wallet: "spaWalletWidgetRender" }; function i(o) { return function (p) { g[o + ";" + p] = (new Date()).getTime() } } function h(o) { return function (s, v, t) { var r = (new Date()).getTime(); var x = o + ";" + s; var u = g[x]; var w; if (u) { w = new d(v); w.addInfoOrEntry("sub-page-type", l[o], "info"); w.addInfoOrEntry("page-action", k[o], "info"); w.addInfoOrEntry("merchant-id", v, "info"); w.addTiming(n[o], u, r, []); var q = a("#" + t); var p = "wd:" + q.width() + "|ht:" + q.height(); q = a("#" + s); p += "|s_ow:" + q.outerWidth() + "|s_oh:" + q.outerHeight(); p += "|s_wd:" + q.width() + "|s_ht:" + q.height(); p += "|w_wd:" + a(window).width() + "|w_ht:" + a(window).height(); w.addInfoOrEntry("additional-request-data", p, "info"); w.publish(); delete g[x]; if (o === "wallet") { m.publish(v, "walletwidgetrender") } } } } f.exports = function () { j.subscribe("ADDRESS_RENDER_START", i("address")); j.subscribe("ADDRESS_RENDER_COMPLETE", h("address")); j.subscribe("WALLET_RENDER_START", i("wallet")); j.subscribe("WALLET_RENDER_COMPLETE", h("wallet")) } }, { "../../widgets/MetricsCollector": 51, "../CoinMetricsHelper": 15, "../PubSub": 30, "../jquery": 41 }], 43: [function (b, a, c) { var d = { Widgets: {} }; d.Widgets.Cookie = function () { }; d.Widgets.Cookie.eraseCookie = function (f) { d.Widgets.Cookie.createCookie(f, "", -1) }; d.Widgets.Cookie.createCookie = function (h, j, f) { var i = ""; if (f) { var g = new Date(); g.setTime(g.getTime() + (f * 60 * 60 * 1000)); i = "; expires=" + g.toGMTString() } document.cookie = h + "=" + j + i + "; path=/" }; d.Widgets.Cookie.readCookie = function (k) { if (document.cookie && document.cookie !== "") { var h = document.cookie.split(";"); for (var g = 0; g < h.length; g++) { var l = h[g]; var j = l.split("="); var f = j[0].replace(/ /, ""); if (f.indexOf(k) === 0) { return j[1] } } } return null }; d.Widgets.Cookie.isCookiePresent = function (g) { var f = d.Widgets.Cookie.readCookie(g); if (undefined !== f && null !== f) { return true } else { return false } }; a.exports = d.Widgets.Cookie }, {}], 44: [function (b, a, c) { function d(h, g, f) { if (g.addEventListener) { g.addEventListener(h, f, false) } else { if (g.attachEvent) { g.attachEvent("on" + h, f) } } } a.exports = { bindEvent: d } }, {}], 45: [function (c, b, d) { var a = {}; a.constants = {}; a.constants.LOCALSTORAGEUTILS_EPS_METRICS_PREFIX = "amz-eps-metrics-"; a.doesLocalStorageExist = function () { if (typeof localStorage === undefined) { return false } else { return true } }; a.insertEntry = function (i, h) { var f = a.constants.LOCALSTORAGEUTILS_EPS_METRICS_PREFIX + i; try { localStorage.setItem(f, h) } catch (g) { return false } return true }; a.filterAndProcessMetrics = function () { var g = ""; var f = ""; var h = []; if (!a.doesLocalStorageExist()) { return } else { for (g in localStorage) { if (g.indexOf(a.constants.LOCALSTORAGEUTILS_EPS_METRICS_PREFIX) === 0) { f = g.replace(a.constants.LOCALSTORAGEUTILS_EPS_METRICS_PREFIX, ""); h.push({ metricsData: localStorage.getItem(g), id: f }); localStorage.removeItem(g) } } } return h }; b.exports = { LocalStorageUtils: a, filterAndProcessMetricss: a.filterAndProcessMetrics, insertEntry: a.insertEntry, doesLocalStorageExist: a.doesLocalStorageExist } }, {}], 46: [function (b, a, c) { var d = { MetricsStore: {} }; d.MetricsStore = d.MetricsStore || {}; d.MetricsStore.toExecute = []; d.MetricsStore.onAdd = function (f) { d.MetricsStore.toExecute.push(f) }; d.MetricsStore.add = function (f) { for (var h = 0; h < d.MetricsStore.toExecute.length; h++) { var g = d.MetricsStore.toExecute[h]; g(f) } }; a.exports = { MetricsStore: d.MetricsStore, onAdd: d.MetricsStore.onAdd, add: d.MetricsStore.add } }, {}], 47: [function (c, j, d) { var o = c("../Utilities"); var i = c("../ButtonCallbacks"); var h = c("../HighResButtons"); var k = c("../DynamicConfig"); var m = c("../Constants"); var q = "BUTTON_REBRANDING"; function b(t, r, s) { i.before_publish_click_metric_callbacks.push(function (u) { u.addInfoOrEntry("weblab-name", r.abtestName, "info"); u.addInfoOrEntry("weblab-treatment", r.treatment, "info") }); t.addInfoOrEntry("weblab-name", r.abtestName, "info"); t.addInfoOrEntry("weblab-treatment", r.treatment, "info"); t.addInfoOrEntry("merchant-id", s, "info"); t.addCounter("lpa-buttonrender-metric") } function p(s) { var r = k.get(m.dynamic_config_keys.BUTTON_ABTESTING_BLACKLIST); return ((r !== null) && (r.indexOf(s) >= 0)) } function a(t, s, v, u, r) { if (s) { n(t); s.src = v; h.useRetinaImage(s, r, u) } } var f = "amazonpay-button-image-tmp-styles"; function l(s, r) { var t = document.createElement("style"); t.setAttribute("class", f); t.innerHTML = ["#", r.id, ".", m.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS, "{opacity:0;}"].join(""); s.appendChild(t) } function n(r) { var s = r.querySelector("." + f); while (s && s.parentNode) { s.parentNode.removeChild(s); s = r.querySelector("." + f) } } function g(u, s, y, r, x, w) { if (!k.valueForKeyIsTrue(m.dynamic_config_keys.ENABLE_BUTTON_ABTESTING)) { a(u, s, x, y, r); return } if (p(r)) { a(u, s, x, y, r); return } l(u, s); var v = function (z) { b(w, z, r); var B = z.treatment; if (B === "C") { a(u, s, x, y, r); return } var A = o.getRebrandedButtonPath(y, B); if (A !== null) { a(u, s, A, y, r) } else { a(u, s, x, y, r) } }; var t = function () { a(u, s, x, y, r) }; o.callWebLab(r, v, t, q) } j.exports = { performButtonWeblab: g } }, { "../ButtonCallbacks": 8, "../Constants": 19, "../DynamicConfig": 20, "../HighResButtons": 22, "../Utilities": 35 }], 48: [function (d, i, f) { var j = d("../DynamicConfig"); var b = d("../Constants"); var m = d("../Utilities"); var n = "CONNECTED_AUTH"; var g = 0; var l = b.others.ConnectedAuthTreatmentMap; var p = b.others.ConnectedAuthCookieValues.LWA_GENERAL; var k = function (q) { var r = q.treatment; var s = p; if (r in l) { s = l[r] } h(s); return }; var a = function () { h(p); return }; function c(q) { return j.valueInArray(b.dynamic_config_keys.CONNECTED_AUTH_MERCHANT_BLACKLIST, q) } function h(q) { m.createCookie(b.constants.CONNECTED_AUTH_COOKIE_NAME, q, g) } function o(q) { if (!j.valueForKeyIsTrue(b.dynamic_config_keys.CONNECTED_AUTH_ENABLED)) { h(p); return } if (c(q)) { h(p); return } m.callWebLab(q, k, a, n) } i.exports = { createConnectedAuthCookie: o } }, { "../Constants": 19, "../DynamicConfig": 20, "../Utilities": 35 }], 49: [function (d, m, g) { var c = d("../core/jquery"); var q = d("../core/Utilities"); var p = d("../core/Constants"); var k = d("../core/ButtonCallbacks"); var l = d("../core/Config"); var o = d("../widgets/MetricsCollector"); var j = d("../core/HighResButtons"); var n = d("../core/DynamicConfig"); var r = d("../core/Weblab"); var a = {}; a.Utilities = {}; a.Constants = {}; a.Constants.IMG_PATH_PREFIX = "ABTesting"; a.Constants.TREATMENT_C = "C"; a.Constants.TREATMENT_T1 = "T1"; a.Constants.TREATMENT_T2 = "T2"; a.Constants.TREATMENT_T3 = "T3"; a.Constants.TREATMENT_T4 = "T4"; a.Constants.TREATMENT_T5 = "T5"; a.Constants.TREATMENT_T6 = "T6"; a.Constants.TREATMENT_T7 = "T7"; a.Constants.TREATMENT_T8 = "T8"; a.Constants.TREATMENT_T9 = "T9"; a.Constants.TREATMENT_T10 = "T10"; a.Constants.COOKIE_TIME_TO_LIVE = 24; var h = "amazon-button-rebranding-temp-css"; function b(u) { var t = document.getElementById(u); var s = document.createElement("style"); s.setAttribute("class", h); s.innerHTML = "#" + u + " > ." + p.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS + " { display: none; }"; if (t) { if (t.childNodes.length > 0) { t.insertBefore(s, t.childNodes[0]) } else { t.appendChild(s) } } } function i(u) { var t = document.getElementById(u), s; if (t) { s = t.querySelector("." + h); while (s !== null) { t.removeChild(s); s = t.querySelector("." + h) } } } a.Utilities.appendButtonImageHiddingStyleEle = b; a.Utilities.removeButtonImageHiddingStyleEle = i; a.Utilities.createCookieForABTest = function (t, s) { if (t != undefined && s != undefined) { q.createCookie(s, t, a.Constants.COOKIE_TIME_TO_LIVE) } }; a.Utilities.buildQueryParamMap = function (u, t, v) { var s = u || {}; s[t] = v; return s }; a.Utilities.ajaxCallForJSONPResponse = function (u, t, s) { q.jsonp({ url: u, success: t, error: s }) }; var f = "weblabOverrides"; a.Utilities.getExperimentValueAndCallback = function (z, w, y, G) { var x = (new Date()).getTime(); var C = a.Constants.TREATMENT_C; if (w && w.defaultTreatment) { C = w.defaultTreatment } var s = "merchantId", u = "abtestName", H = "treatment"; function B(J) { var K = new Array(u, H); if (!q.isEmptyOrUndefined(J)) { for (var L = 0; L < K.length; L++) { if (!J.hasOwnProperty(K[L])) { return false } } if (J.abtestName === w.testName) { return true } } return false } function D(J) { if (B(J)) { C = J.treatment; F(J) } if (typeof y === "function") { y(C) } } function F(J) { var K = (new Date()).getTime(); var L = new o.Collector(z); k.before_publish_click_metric_callbacks.push(function (M) { M.addInfoOrEntry("weblab-name", J.abtestName, "info"); M.addInfoOrEntry("weblab-treatment", J.treatment, "info") }); L.addInfoOrEntry("weblab-name", J.abtestName, "info"); L.addInfoOrEntry("weblab-treatment", J.treatment, "info"); L.addInfoOrEntry("merchant-id", z, "info"); L.addCounter("lpa-buttonrender-metric"); L.addTiming("amazon-pay-js-abtesting", x, K, [J.abtestName]); L.publish() } function t() { if (typeof y === "function") { y(C) } } if (q.isEmptyOrUndefined(w) || q.isEmptyOrUndefined(z)) { t() } else { var E, A; E = a.Utilities.buildQueryParamMap(E, s, z); E = a.Utilities.buildQueryParamMap(E, u, w.testName); A = l.WIDGET_ENDPOINT + l.ABTEST_URL_PATH + q.createQueryString(E); var v = n.get(f), I = w.testName; if (v && v[I] && typeof v[I] === "string") { D({ treatment: v[I], abtestName: I, merchantId: z }) } else { if (n.valueForKeyIsTrue("enableABTestV2")) { r.loadWithName(w.testName, D, t) } else { a.Utilities.ajaxCallForJSONPResponse(A, D, t) } } } }; a.Utilities.getExperimentValueForABTestDefault = function (s) { if (q.imageInDOM(s)) { return a.Constants.TREATMENT_C } else { return a.Constants.TREATMENT_T1 } }; a.Utilities.getButtonPath = function (s, t) { var v = l.WIDGET_ENDPOINT + p.constants.BUTTON_URI; var u = "?sellerId=" + p.constants.CartOwnerId + "&size=" + t + "&color=" + s; return v + u }; a.Utilities.bindButtonOnloadActions = function (s) { var t = false; if (!s.complete) { c(s).load(function () { if (!t) { t = true; a.Utilities.buttonOnloadActions(s) } }) } else { if (!t && (s.height > 0 || s.width > 0)) { t = true; a.Utilities.buttonOnloadActions(s) } } }; a.Utilities.buttonOnloadActions = function (s) { a.Utilities.createCookieForABTest(a.Utilities.getExperimentValueForABTestDefault(s), a.Tests.Default.cookieName) }; a.Utilities.getSellersForABTest = function (s) { if (!q.isEmptyOrUndefined(s) && !q.isEmptyOrUndefined(s.sellersInTest)) { return q.stringToArray(s.sellersInTest) } return [] }; a.Utilities.isSellerInABTest = function (t, s) { if (n.valueForKeyIsTrue(p.dynamic_config_keys.ENABLE_REBRANDING_BUTTON)) { return false } if (!q.isEmptyOrUndefined(s)) { var u = a.Utilities.getSellersForABTest(s); if (!q.isEmptyOrUndefined(u)) { return q.isElementInArray(t, u) } } return false }; a.Utilities.isAllowedTreatmentforABTest = function (s, u) { var t = q.stringToArray(u); return q.isElementInArray(s, t) }; a.Utilities.isRebrandingABTest = function (u, s) { if (n.valueForKeyIsTrue(p.dynamic_config_keys.ENABLE_REBRANDING_BUTTON)) { return false } var t = a.Tests[u].testName; return ((t === "BUTTON_REBRANDING") && (a.Utilities.isSellerInRebrandingBlacklist(s) === false)) }; a.Utilities.isSellerInRebrandingBlacklist = function (t) { var s = q.getRebrandingBlacklistedMerchants(); return ((s !== null) && (s.indexOf(t) >= 0)) }; a.Utilities._abTestAfter = function (u, s, t) { for (var w in a.Tests) { var v = a.Tests[w]; if (!v.ignoreCheckWhiteList) { if (a.Utilities.isSellerInABTest(u, v) || a.Utilities.isRebrandingABTest(w, u)) { a.Utilities.getExperimentValueAndCallback(u, v, v.callback(s, t, u), t) } } } }; a.Utilities._abTestBefore = function (t, s) { for (var v in a.Tests) { var u = a.Tests[v]; if (!u.ignoreCheckWhiteList) { if (a.Utilities.isSellerInABTest(t, u) || a.Utilities.isRebrandingABTest(v, t)) { b(s) } else { if (q.isCookiePresent(u.cookieName)) { q.eraseCookie(u.cookieName) } } } } }; a.Utilities._MULTI_BUTTONS_AbTestCallback = function (s) { return function (u) { function w(y) { return y.length === 2 } function t(A) { var y = A.getElementsByTagName("img"); for (var z = 0; z < y.length; z++) { imgEle = y[z]; imgSrc = imgEle.getAttribute("src"); if (q.isAmazonPaymentsButtonImage(imgSrc)) { v(imgSrc) } } } function v(A) { var B = "offAmazonPayments"; var z = A.split(B); if (w(z)) { var y = z[0] + B + "/" + a.Constants.IMG_PATH_PREFIX + "/" + a.Tests.MULTI_BUTTONS.testName + "/" + u + z[1]; imgEle.setAttribute("src", y) } } if (a.Utilities.isAllowedTreatmentforABTest(u, a.Tests.MULTI_BUTTONS.allowedTreatments)) { var x = document.getElementById(s); t(x) } i(s) } }; a.Utilities.styleButtonOnHover = function (C, u, z) { var x = { small: "0px 3px 6px rgba(0,0,0,0.5)", medium: "0px 4px 8px rgba(0,0,0,0.5)", large: "0px 5px 10px rgba(0,0,0,0.5)", "x-large": "0px 6px 12px rgba(0,0,0,0.5)" }; var y = { darkgray: "brightness(110%) contrast(110%) saturate(200%)", lightgray: "brightness(95%) contrast(120%)", gold: "brightness(105%) contrast(95%)" }; var D = "amazon-button-2017-hover-id"; function E() { var G = document.getElementById(D); if (G) { G.parentNode.removeChild(G) } } var t; var w; var s = "." + p.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS + ":hover {"; if (u) { var F = q.getValueBasedOnInput(p.constants.BUTTON_LWA_SIZE_SET, C.size, p.constants.BUTTON_DEFAULT_SIZE_LWA); t = "box-shadow: " + x[F] + ";"; s += t } if (z) { var B = q.getValueBasedOnInput(p.constants.BUTTON_LWA_COLOR_SET, C.color, p.constants.BUTTON_DEFAULT_COLOR_LWA); w = "filter: " + y[B] + ";-webkit-filter: " + y[B] + ";-moz-filter: " + y[B] + ";-o-filter: " + y[B] + ";-ms-filter: " + y[B] + ";"; s += w } s += "}"; E(); var v = document.createElement("style"); v.type = "text/css"; v.innerHTML = s; v.id = D; var A = document.head || document.getElementsByTagName("head")[0]; A.appendChild(v) }; a.Utilities._BUTTON_REBRANDING_Callback = function (s, t, u) { return function (w) { function x(D, z, C) { var A = D.getElementsByTagName("img"); for (var B = 0; B < A.length; B++) { imgEle = A[B]; imgSrc = imgEle.getAttribute("src"); if ((imgSrc !== null) && z.type && q.isAmazonPaymentsButtonImage(imgSrc) && w !== a.Constants.TREATMENT_C) { v(z, C) } } } function v(A, B) { var D = q.getRebrandedButtonPath(A, w); if (D !== null) { imgEle.setAttribute("data-metric-name", "amazon-pay-button-load"); imgEle.setAttribute("data-abtest", "true"); imgEle.setAttribute("src", D); var F = false, C = false; var E = a.Tests.BUTTON_REBRANDING.treatmentsWithColorChangeOnHover; if (q.isElementInArray(w, E)) { C = true } var z = a.Tests.BUTTON_REBRANDING.treatmentsWithShadowOnHover; if (q.isElementInArray(w, z)) { F = true } if (C || F) { a.Utilities.styleButtonOnHover({ size: A.size, color: A.color }, F, C) } j.useRetinaImage(imgEle, B, A) } } if (a.Utilities.isAllowedTreatmentforABTest(w, a.Tests.BUTTON_REBRANDING.allowedTreatments)) { var y = document.getElementById(s); x(y, t, u) } i(s) } }; k.before_callbacks.push(a.Utilities._abTestBefore); k.after_callbacks.push(a.Utilities._abTestAfter); a.Tests = { Default: { testName: "DEFAULT", cookieName: "amz_abtest_default", sellersInTest: l.DEFAULT_ABTEST_MERCHANTS, callback: "" }, BUTTON_REBRANDING: { testName: "BUTTON_REBRANDING", cookieName: "", allowedTreatments: "C,T1,T2,T3,T4,T5,T6,T7,T8,T9,T10", sellersInTest: "ALLMERCHANTS", ignoreCheckWhiteList: false, callback: a.Utilities._BUTTON_REBRANDING_Callback, defaultTreatment: "T1", treatmentsWithShadowOnHover: [], treatmentsWithColorChangeOnHover: [], treatmentsWithText: ["T5", "T6", "T8", "T9", "T10"] } }; m.exports = { ABTest: a } }, { "../core/ButtonCallbacks": 8, "../core/Config": 16, "../core/Constants": 19, "../core/DynamicConfig": 20, "../core/HighResButtons": 22, "../core/Utilities": 35, "../core/Weblab": 37, "../core/jquery": 41, "../widgets/MetricsCollector": 51 }], 50: [function (b, g, d) { if (!c || typeof (c) === "undefined") { var c = {} } var h = b("../core/jquery"); var i = b("../core/Constants"); var a = b("../core/LPAMetricsHelper"); var f = b("../core/Config"); c.DynamicButton = c.DynamicButton || {}; c.DynamicButton.Utilities = c.DynamicButton.Utilities || {}; c.DynamicButton.Constants = { BUTTON_SCRIPT_BASE_PATH: "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/live/prod/js/", USER_REQUESTED_DEFAULT_SIZE_PX: 0, DEFAULT_SMILEY_WIDTH_PX: 20.2, DEFAULT_SMILEY_HEIGHT_PX: 21.21, DEFAULT_SANDBOX_WATERMARK_HEIGHT_PX: 21, SMILEY_VERTICAL_POSITION_PCT: 17.67, TEXT_VERTICAL_POSITION_PCT: 33, SANDBOX_WATERMARK_VERTICAL_POSITION_PCT: 66, CONSTRAINT_MIN_HEIGHT_PX: 34, MANDATORY_BUFFER_PX: 2, WIDTH_INDEX: 0, HEIGHT_INDEX: 1, BGCOLOR_START_INDEX: 0, BGCOLOR_END_INDEX: 1, BGCOLOR_BORDER_INDEX: 2, STANDARD_SPACING_DIVIDER: 4, SPACING_TUNER_MULTIPLIER: 0.85, DEFAULT_BACKGROUND_COLOR: "Gold", DEFAULT_SIZE: "medium", DEFAULT_TYPE: "LwA", TEXT_INDEX_FOR_ONLY_SMILEY_BUTTON: 7, RATIO_INDEX: 0, SCALEX_INDEX: 1, SCALEY_INDEX: 2 }; var j = { GOLD: "gold", LIGHTGREY: "lightgray", DARKGREY: "darkgray" }; c.DynamicButton.Constants.ButtonCount = 0; c.DynamicButton.Constants.BGCOLOR_ARRAY = [["#FAE69B", "#EFC332", "#AA8426"], ["#FEFEFE", "#E2E2E2", "#BBBBBB"], ["#7F8891", "#434B57", "#313142"]]; c.DynamicButton.Utilities.getButtonSize = function (l, k) { var o = i.constants.BUTTON_SVG_TEXT_SET; var p = i.constants.BUTTON_LWA_SIZE_SET; var m = (l && o.indexOf(l.toLowerCase()) !== -1) ? o.indexOf(l.toLowerCase()) : 3; var n = (k && p.indexOf(k.toLowerCase()) !== -1) ? p.indexOf(k.toLowerCase()) : 1; return c.DynamicButton.Constants.BUTTON_SIZE_WxH_ARRAY[m][n] }; c.DynamicButton.Constants.BUTTON_SIZE_WxH_ARRAY = [[[76, 32], [101, 46], [152, 64], [202, 92]], [[156, 32], [174, 41], [312, 64], [390, 92]], [[72, 30], [90, 45], [144, 60], [180, 90]], [[148, 30], [200, 45], [296, 60], [400, 90]], [[120, 35], [150, 50], [240, 70], [300, 100]], [[168, 30], [253, 45], [338, 60], [505, 90]], [[134, 22], [150, 30], [270, 44], [300, 60]], [[32, 32], [46, 46], [64, 64], [92, 92]]]; c.DynamicButton.Constants.BUTTON_ASPECT_RATIO_DESKTOP = [[0.421, 0.205, 0.416, 0.2027, 0.35, 0.178, 0.262, 1], [0.421, 0.205, 0.3, 0.2027, 0.35, 0.21, 0.163, 1], [0.2, 0.125, 0.35, 0.2027, 0.23, 0.135, 0.23, 1], [0.3, 0.165, 0.35, 0.202, 0.3, 0.165, 0.175, 1], [0.38, 0.205, 0.38, 0.2027, 0.35, 0.18, 0.22, 1], [0.421, 0.157, 0.416, 0.155, 0.35, 0.178, 0.262, 1]]; c.DynamicButton.Constants.BUTTON_ASPECT_RATIO_TOUCH = [[0.455, 0.234, 0.5, 0.225, 0.33, 0.178, 0.272, 1], [0.455, 0.235, 0.326, 0.215, 0.33, 0.178, 0.2, 1], [0.2, 0.125, 0.35, 0.2027, 0.23, 0.135, 0.23, 1], [0.3, 0.165, 0.35, 0.202, 0.3, 0.165, 0.175, 1], [0.38, 0.205, 0.38, 0.2027, 0.35, 0.18, 0.22, 1], [0.455, 0.162, 0.5, 0.155, 0.33, 0.178, 0.272, 1]]; c.DynamicButton.Constants.TEXT_SIZE_WxH_ARRAY = [[[149, 58], [503, 58], [104, 58], [545, 58], [196, 49], [550, 49], [60, 10], [0, 0]], [[149, 58], [474, 58], [246, 49], [572, 57], [238, 59], [567, 60], [120, 12], [0, 0]], [[428, 43], [800, 45], [155, 53], [523, 53], [322, 44], [693, 42], [337, 43], [0, 0]], [[180, 42], [528, 43], [181, 53], [523, 53], [185, 44], [528, 42], [508, 45], [0, 0]], [[140, 53], [490, 53], [152, 53], [493, 53], [160, 45], [499, 45], [355, 45], [0, 0]], [[149, 58], [825, 58], [104, 58], [870, 58], [196, 49], [550, 49], [60, 10], [0, 0]]]; c.DynamicButton.Constants.TEXT_PATH_ADJUSTMENT = [[[1.1, 0, -29], [1, 0, -30], [1.2, 0, -12], [1.15, 0, -12], [1, 0, -28], [1, 0, -28], [1.1, -61, -73], [0, 0, 0]], [[1.1, 0, -29], [1, 0, -30], [1, 0, -30], [1, 0, -30], [1, 0, -28], [1, 0, -28], [1.1, -91, -497], [0, 0, 0]], [[1, -838, -758], [1, -837, -331], [1, -838, -548], [1, -853, -162], [1, -970, -1405], [1, -969, -1576], [1, -965, -1790], [0, 0, 0]], [[1, -2168, -759], [1, -2169, -332], [1, -2174, -548], [1, -2161, -162], [1, -2050, -1417], [1, -2048, -1587], [1, -2044, -1802], [0, 0, 0]], [[1, -3630, -759], [1, -3630, -332], [1, -3629, -548], [1, -3630, -162], [1, -2969, -1417], [1, -2973, -1587], [1, -2965, -1802], [0, 0, 0]], [[1.1, 0, -29], [2.505, 0, -1.054], [1.2, 0, -12], [2.48, 0, -0.0831], [1, 0, -28], [1, 0, -28], [1.1, -61, -73], [0, 0, 0]]]; c.DynamicButton.Constants.FILEPATH_FOR_TEXT_SVG = [["buttons_en/text_svg_login_en.js", "buttons_en/text_svg_loginwithamazon_en.js", "buttons_en/text_svg_pay_en.js", "buttons_en/text_svg_paywithamazon_en.js", "buttons_en/text_svg_donate_en.js", "buttons_en/text_svg_donatewithamazon_en.js", "buttons_en/text_svg_editorupdate_en.js"], ["buttons_de/text_svg_login_de.js", "buttons_de/text_svg_loginwithamazon_de.js", "buttons_de/text_svg_pay_de.js", "buttons_de/text_svg_paywithamazon_de.js", "buttons_de/text_svg_donate_de.js", "buttons_de/text_svg_donatewithamazon_de.js", "buttons_de/text_svg_editorupdate_de.js"], ["buttons_fr/text_svg_login_fr.js", "buttons_fr/text_svg_loginwithamazon_fr.js", "buttons_fr/text_svg_pay_fr.js", "buttons_fr/text_svg_paywithamazon_fr.js", "buttons_fr/text_svg_donate_fr.js", "buttons_fr/text_svg_donatewithamazon_fr.js", "buttons_fr/text_svg_editorupdate_fr.js"], ["buttons_it/text_svg_login_it.js", "buttons_it/text_svg_loginwithamazon_it.js", "buttons_it/text_svg_pay_it.js", "buttons_it/text_svg_paywithamazon_it.js", "buttons_it/text_svg_donate_it.js", "buttons_it/text_svg_donatewithamazon_it.js", "buttons_it/text_svg_editorupdate_it.js"], ["buttons_es/text_svg_login_es.js", "buttons_es/text_svg_loginwithamazon_es.js", "buttons_es/text_svg_pay_es.js", "buttons_es/text_svg_paywithamazon_es.js", "buttons_es/text_svg_donate_es.js", "buttons_es/text_svg_donatewithamazon_es.js", "buttons_es/text_svg_editorupdate_es.js"], ["buttons_jp/text_svg_login_jp.js", "buttons_jp/text_svg_loginwithamazon_jp.js", "buttons_jp/text_svg_pay_jp.js", "buttons_jp/text_svg_paywithamazon_jp.js", "buttons_jp/text_svg_donate_jp.js", "buttons_jp/text_svg_donatewithamazon_jp.js", "buttons_jp/text_svg_editorupdate_jp.js"]]; c.DynamicButton.Constants.A_WITH_SMILEY_SVG = "<g id='a-smile-22x23-svgtest' sketch:type='MSLayerGroup'><g id='Fill-1-+-Fill-2-+-Fill-3' sketch:type='MSShapeGroup'><g id='largearrowtest'><path d='M18.0205355,17.7001083 C15.8375936,19.8531453 12.6735141,21 9.94880581,21 C6.12995073,21 2.69159865,19.1113744 0.0889082165,15.9706025 C-0.116327928,15.7235978 0.0655393031,15.3870055 0.312161615,15.578006 C3.1200882,17.7621669 6.59251251,19.0772232 10.1775893,19.0772232 C12.5973421,19.0772232 15.2564034,18.408201 17.7033605,17.0179364 C18.072625,16.8084885 18.3826645,17.344974 18.0205355,17.7001083' id='Fill-1'></path><path d='M19.2496138,16.3784711 C18.9033645,15.9727011 16.9612157,16.1863688 16.0881456,16.2816746 C15.8241916,16.3108924 15.7817937,16.1004048 16.0208525,15.9472597 C17.5704405,14.9519654 20.1097472,15.2385783 20.4054452,15.5724963 C20.7027739,15.9076069 20.3271722,18.2354925 18.874447,19.3461675 C18.6516951,19.5173005 18.439597,19.425473 18.5380905,19.1997802 C18.8650977,18.4552225 19.5965154,16.7842411 19.2496138,16.3784711' id='Fill-2'></path><path d='M14.9183645,15.2944706 C14.7291152,15.4566817 14.4559166,15.4672362 14.2454983,15.3577113 C13.2961629,14.6084259 13.1284461,14.261251 12.6083058,13.5473493 C11.042979,15.066337 9.93455785,15.5217391 7.90660145,15.5217391 C5.50487092,15.5217391 3.63636364,14.1115843 3.63636364,11.2887656 C3.63636364,9.08373326 4.89160514,7.58542207 6.6784345,6.85084385 C8.2262265,6.20277819 10.388102,6.08486156 12.0416482,5.90976012 L12.0416482,5.55713489 C12.0416482,4.90950179 12.0957065,4.14542278 11.6958572,3.58534041 C11.3486125,3.08728755 10.681561,2.88095507 10.0940069,2.88095507 C9.00648229,2.88095507 8.03906686,3.41214225 7.80166486,4.51128444 C7.75251275,4.7567206 7.56453543,4.99878277 7.30541927,5.01124058 L4.54190736,4.72557607 C4.3087755,4.67695601 4.0475697,4.49709638 4.11561949,4.15865921 C4.75187139,0.964182585 7.78058669,0 10.4944014,0 C11.8819266,0 13.696103,0.35219267 14.789079,1.35297007 C16.1767859,2.58707187 16.0450473,4.23383863 16.0450473,6.02655209 L16.0450473,10.2582279 C16.0450473,11.5314334 16.6008932,12.0892664 17.1210335,12.7749651 C17.3050132,13.0219584 17.3438988,13.3169663 17.1124023,13.4967394 C16.5289367,13.9615715 15.4932898,14.8178729 14.9259054,15.3003535 L14.9183645,15.2944706 Z M12.1816051,8.78803298 C12.1816051,9.81572532 12.2100293,10.6702186 11.6098116,11.5833964 C11.1248483,12.3268174 10.351652,12.7826087 9.49542198,12.7826087 C8.32185346,12.7826087 7.63636329,12.0114826 7.63636329,10.8712907 C7.63636329,8.62558019 9.97220853,8.2173913 12.1816051,8.2173913 L12.1816051,8.78803298 Z' id='Fill-3'></path></g></g></g>"; c.DynamicButton.Constants.SANDBOX_WATERMARK_SVG = "<g id='sandbox-wrapper' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'><g id='Sandbox-watermark' sketch:type='MSLayerGroup'><rect id='Rectangle-31' stroke='#F30B08' fill='#FFFFFF' sketch:type='MSShapeGroup' x='1' y='1' width='19' height='19' rx='4'></rect><text id='S' sketch:type='MSTextLayer' font-size='17' font-weight='620' letter-spacing='0.70' fill='#FF0000'><tspan x='5.5' y='16'>S</tspan></text></g></g></g></svg>"; c.DynamicButton.Utilities.ButtonSpecification = function (p, q, o, m, n, l, r, k) { this.text = p; this.size = q; this.language = l; this.bgColor = r; this.textColor = k; this.heightRequested = o; this.widthRequested = m; this.isAspectRatioToBeMaintained = n; this.smileyHorizontalPositionInPercentage = 0; this.textHorizontalPositionInPercentage = 0; this.smileyVerticalPositionInPercentage = c.DynamicButton.Constants.SMILEY_VERTICAL_POSITION_PCT; this.textVerticalPositionInPercentage = c.DynamicButton.Constants.TEXT_VERTICAL_POSITION_PCT; this.textHeightInPx = 0; this.textWidthInPx = 0; if (this.size % 2 === 0) { this.aspectRatio = c.DynamicButton.Constants.BUTTON_ASPECT_RATIO_DESKTOP[this.language][this.text] } else { this.aspectRatio = c.DynamicButton.Constants.BUTTON_ASPECT_RATIO_TOUCH[this.language][this.text] } if (!(this.heightRequested === 0 && this.widthRequested === 0)) { this.aspectRatio = c.DynamicButton.Constants.BUTTON_ASPECT_RATIO_DESKTOP[this.language][this.text] } if (this.text === c.DynamicButton.Constants.TEXT_INDEX_FOR_ONLY_SMILEY_BUTTON) { this.isTextOnButton = false } else { this.isTextOnButton = true } this.smileyTransformationRatio = 0; this.buttonHeightInPx = 0; this.buttonWidthInPx = 0; this.input = {}; this.sellerId; c.DynamicButton.Constants.ButtonCount += 1; this.buttonCount = c.DynamicButton.Constants.ButtonCount }; c.DynamicButton.Utilities.calculateSpacingWithText = function (p) { p.textWidthInPx = (c.DynamicButton.Constants.TEXT_SIZE_WxH_ARRAY[p.language][p.text][c.DynamicButton.Constants.WIDTH_INDEX] / c.DynamicButton.Constants.TEXT_SIZE_WxH_ARRAY[p.language][p.text][c.DynamicButton.Constants.HEIGHT_INDEX]) * p.textHeightInPx; var l = c.DynamicButton.Utilities.getSmileyTextSpacingInPx(p.buttonHeightInPx); var k = c.DynamicButton.Constants.DEFAULT_SMILEY_WIDTH_PX * p.smileyTransformationRatio; var o = c.DynamicButton.Utilities.getButtonPaddingInPx(l); var m = k + l + p.textWidthInPx + o * 2; var n = p.buttonWidthInPx / 2 - m / 2; p.smileyHorizontalPositionInPercentage = (n + o / 2) / p.buttonWidthInPx * 100; p.textHorizontalPositionInPercentage = (n + o / 2 + k + l) / p.buttonWidthInPx * 100; return p }; c.DynamicButton.Utilities.calculateSpacingWithoutText = function (m) { var l = m.buttonHeightInPx - c.DynamicButton.Utilities.getSmileyVerticalSpacingInPx(m) * 2; m.smileyTransformationRatio = l / c.DynamicButton.Constants.DEFAULT_SMILEY_HEIGHT_PX; var k = c.DynamicButton.Constants.DEFAULT_SMILEY_WIDTH_PX * m.smileyTransformationRatio; m.smileyHorizontalPositionInPercentage = ((m.buttonWidthInPx - k) / 2) / m.buttonWidthInPx * 100; m.textHorizontalPositionInPercentage = 0; return m }; c.DynamicButton.Utilities.precomputeValues = function (k) { k = c.DynamicButton.Utilities.computeDimensions(k); k = c.DynamicButton.Utilities.calculateSmileyTransformation(k); k = c.DynamicButton.Utilities.calculateTextTransformation(k); if (!k.isTextOnButton) { k = c.DynamicButton.Utilities.calculateSpacingWithoutText(k) } else { k = c.DynamicButton.Utilities.calculateSpacingWithText(k) } return k }; c.DynamicButton.Utilities.computeDimensions = function (p) { var l = p.widthRequested; var k = p.heightRequested; var n; if (k === 0 && l === 0) { l = c.DynamicButton.Constants.BUTTON_SIZE_WxH_ARRAY[p.text][p.size][c.DynamicButton.Constants.WIDTH_INDEX]; k = c.DynamicButton.Constants.BUTTON_SIZE_WxH_ARRAY[p.text][p.size][c.DynamicButton.Constants.HEIGHT_INDEX] } else { if (k === 0) { n = c.DynamicButton.Constants.CONSTRAINT_MIN_HEIGHT_PX / p.aspectRatio; l = (l > n) ? l : n; k = l * p.aspectRatio } else { if (l === 0) { k = (k > c.DynamicButton.Constants.CONSTRAINT_MIN_HEIGHT_PX) ? k : c.DynamicButton.Constants.CONSTRAINT_MIN_HEIGHT_PX; l = k / p.aspectRatio } else { k = (k > c.DynamicButton.Constants.CONSTRAINT_MIN_HEIGHT_PX) ? k : c.DynamicButton.Constants.CONSTRAINT_MIN_HEIGHT_PX; n = k / p.aspectRatio; l = (l > n) ? l : n } } } var o = k / p.aspectRatio; var m = l * p.aspectRatio; if (p.isAspectRatioToBeMaintained) { p.buttonWidthInPx = ((l > o) ? o : l); p.buttonHeightInPx = ((k > m) ? m : k) } else { p.buttonWidthInPx = ((l > o) ? l : o); p.buttonHeightInPx = k } return p }; c.DynamicButton.Utilities.calculateSmileyTransformation = function (l) { var k = l.buttonHeightInPx - c.DynamicButton.Utilities.getSmileyVerticalSpacingInPx(l) * 2; l.smileyTransformationRatio = k / c.DynamicButton.Constants.DEFAULT_SMILEY_HEIGHT_PX; return l }; c.DynamicButton.Utilities.calculateTextTransformation = function (k) { k.textHeightInPx = k.buttonHeightInPx - c.DynamicButton.Utilities.getTextVerticalSpacingInPx(k) * 2; return k }; c.DynamicButton.Utilities.getSmileyVerticalSpacingInPx = function (k) { return k.buttonHeightInPx / (100 / k.smileyVerticalPositionInPercentage) }; c.DynamicButton.Utilities.getTextVerticalSpacingInPx = function (k) { return k.buttonHeightInPx / (100 / k.textVerticalPositionInPercentage) }; c.DynamicButton.Utilities.getButtonPaddingInPx = function (k) { return k / c.DynamicButton.Constants.STANDARD_SPACING_DIVIDER }; c.DynamicButton.Utilities.getSmileyTextSpacingInPx = function (k) { return (k / c.DynamicButton.Constants.STANDARD_SPACING_DIVIDER) * c.DynamicButton.Constants.SPACING_TUNER_MULTIPLIER }; c.DynamicButton.Utilities.createBackgroundSVG = function (s) { var m = "0 0 " + (s.buttonWidthInPx + 2).toFixed(2) + " " + s.buttonHeightInPx.toFixed(2); var q = "<svg width='" + s.buttonWidthInPx.toFixed(2) + "px' height='" + s.buttonHeightInPx.toFixed(2) + "px' viewBox='" + m + "' version='1.1'><defs><linearGradient x1='50%' y1='0%' x2='50%' y2='100%' id='LPABtnBgLinearGradient-" + s.buttonCount + "'>"; var p = c.DynamicButton.Constants.BGCOLOR_ARRAY[s.bgColor][c.DynamicButton.Constants.BGCOLOR_START_INDEX]; var n = c.DynamicButton.Constants.BGCOLOR_ARRAY[s.bgColor][c.DynamicButton.Constants.BGCOLOR_END_INDEX]; var k = c.DynamicButton.Constants.BGCOLOR_ARRAY[s.bgColor][c.DynamicButton.Constants.BGCOLOR_BORDER_INDEX]; var r = "<stop stop-color='" + p + "' offset='0%'></stop><stop stop-color='" + n + "' offset='100%'></stop></linearGradient></defs><g id='Page-5' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' sketch:type='MSPage'>"; var o = "<g id='Artboard' sketch:type='MSArtboardGroup' stroke='" + k + "' stroke-width='1' fill='url(#LPABtnBgLinearGradient-" + s.buttonCount + ")'><rect id='Rectangle-16' sketch:type='MSShapeGroup' x='1' y='1' width='" + (s.buttonWidthInPx - c.DynamicButton.Constants.MANDATORY_BUFFER_PX).toFixed(2) + "' height='" + (s.buttonHeightInPx - c.DynamicButton.Constants.MANDATORY_BUFFER_PX).toFixed(2) + "' rx='2'>"; var l = "</rect></g></g></svg>"; return q + r + o + l }; c.DynamicButton.Utilities.createASmileySVG = function (o) { var m = o.textColor; var n = "<svg x='" + o.smileyHorizontalPositionInPercentage.toFixed(2) + "%' y='" + o.smileyVerticalPositionInPercentage.toFixed(2) + "%'><g id='Page-5' stroke='none' stroke-width='1' fill-rule='evenodd' sketch:type='MSPage' transform='scale(" + o.smileyTransformationRatio + ")' fill='" + m + "'>"; var l = "</g></svg>"; var k = c.DynamicButton.Constants.A_WITH_SMILEY_SVG; return n + k + l }; c.DynamicButton.Utilities.getSandboxWatermarkSign = function (p) { var l = (p.buttonHeightInPx * (100 - c.DynamicButton.Constants.SANDBOX_WATERMARK_VERTICAL_POSITION_PCT) / 100).toFixed(2); var n = (((p.buttonWidthInPx - l - c.DynamicButton.Constants.MANDATORY_BUFFER_PX) / p.buttonWidthInPx) * 100).toFixed(2); var o = c.DynamicButton.Constants.SANDBOX_WATERMARK_VERTICAL_POSITION_PCT; var m = (l / c.DynamicButton.Constants.DEFAULT_SANDBOX_WATERMARK_HEIGHT_PX).toFixed(2); var k = "<svg x='" + n + "%' y='" + o + "%'><svg width='" + l + "px' height='" + l + "px' viewBox='0 0 " + l + " " + l + "' version='1.1'><g transform='scale(" + m + ")'> " + c.DynamicButton.Constants.SANDBOX_WATERMARK_SVG; return k }; c.DynamicButton.Utilities.createTextWrapperSVG = function (o, x, y) { var t = c.DynamicButton.Constants.TEXT_SIZE_WxH_ARRAY[y.language][y.text][c.DynamicButton.Constants.WIDTH_INDEX]; var m = c.DynamicButton.Constants.TEXT_SIZE_WxH_ARRAY[y.language][y.text][c.DynamicButton.Constants.HEIGHT_INDEX]; var s = c.DynamicButton.Constants.TEXT_PATH_ADJUSTMENT[y.language][y.text][c.DynamicButton.Constants.RATIO_INDEX]; var l = c.DynamicButton.Constants.TEXT_PATH_ADJUSTMENT[y.language][y.text][c.DynamicButton.Constants.SCALEX_INDEX]; var k = c.DynamicButton.Constants.TEXT_PATH_ADJUSTMENT[y.language][y.text][c.DynamicButton.Constants.SCALEY_INDEX]; var v = s * y.textWidthInPx / t; var r = (t * v).toFixed(2); var w = (m * v).toFixed(2); var z = l * v; var A = k * v; var q = "<svg width='" + r + "px' height='" + w + "px' viewBox='0 0 " + r + " " + w + "' version='1.1'><g id='Page-5' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' sketch:type='MSPage'><g id='Artboard' sketch:type='MSArtboardGroup' transform='translate(" + z + ", " + A + ") scale(" + v + ")' fill='" + y.textColor + "'>"; var n = "</g></g></svg>"; var p; if (f.IS_SANDBOX === "true") { p = c.DynamicButton.Utilities.getSandboxWatermarkSign(y) } else { p = "" } var u = c.DynamicButton.Constants.BUTTON_SCRIPT_BASE_PATH + c.DynamicButton.Constants.FILEPATH_FOR_TEXT_SVG[y.language][y.text]; h.ajaxSetup({ cache: true }); h.getScript(u, function () { var B = q + c.DynamicButton.Utilities.getTextSVG() + n; var C = "<svg x='" + y.textHorizontalPositionInPercentage.toFixed(2) + "%' y='" + y.textVerticalPositionInPercentage.toFixed(2) + "%'>" + B + "</svg>"; h("#" + x + " div").html(o + C + p + "</svg>"); a.publishMetricsForLPAButton(y.input, x, y.sellerId, true) }); return y }; c.DynamicButton.Utilities.mapSelectionBasedOnInput = function (q, l) { var s = q.color || c.DynamicButton.Constants.DEFAULT_BACKGROUND_COLOR; var t = q.size || c.DynamicButton.Constants.DEFAULT_SIZE; var m = q.type || c.DynamicButton.Constants.DEFAULT_TYPE; switch (l) { case "US": languageSelected = 0; break; case "DE": languageSelected = 1; break; case "FR": languageSelected = 2; break; case "IT": languageSelected = 3; break; case "ES": languageSelected = 4; break; case "JP": languageSelected = 5; break; default: languageSelected = 0 }switch (s.toLowerCase()) { case j.GOLD: bgcolorSelected = 0; textColor = "#000000"; break; case j.LIGHTGREY: bgcolorSelected = 1; textColor = "#000000"; break; case j.DARKGREY: bgcolorSelected = 2; textColor = "#FFFFFF"; break; default: bgcolorSelected = 0; textColor = "#000000" }var k = i.constants.BUTTON_LWA_SIZE_SET; if (k.indexOf(t.toLowerCase()) > -1) { sizeSelected = k.indexOf(t.toLowerCase()) } else { sizeSelected = k.indexOf(c.DynamicButton.Constants.DEFAULT_SIZE.toLowerCase()) } var p = i.constants.BUTTON_SVG_TEXT_SET; if (p.indexOf(m.toLowerCase()) > -1) { textSelected = p.indexOf(m.toLowerCase()) } else { textSelected = p.indexOf(c.DynamicButton.Constants.DEFAULT_TYPE.toLowerCase()) } var r = (typeof (q.height) === "number") ? q.height : c.DynamicButton.Constants.USER_REQUESTED_DEFAULT_SIZE_PX; var o = (typeof (q.width) === "number") ? q.width : c.DynamicButton.Constants.USER_REQUESTED_DEFAULT_SIZE_PX; var n = (typeof (q.aspectRatio) === "boolean") ? q.aspectRatio : true; return new c.DynamicButton.Utilities.ButtonSpecification(textSelected, sizeSelected, r, o, n, languageSelected, bgcolorSelected, textColor) }; c.DynamicButton.Utilities.getNontextSVGComponent = function (n) { var l = "<svg xmlns='https://www.w3.org/2000/svg' xmlns:xlink='https://www.w3.org/1999/xlink' width='" + n.buttonWidthInPx.toFixed(2) + "px' height='" + n.buttonHeightInPx.toFixed(2) + "px'>"; var k = c.DynamicButton.Utilities.createBackgroundSVG(n); var m = c.DynamicButton.Utilities.createASmileySVG(n); return (l + k + m) }; c.DynamicButton.Utilities.createDynamicButton = function (l, n, k, m) { var p = new c.DynamicButton.Utilities.mapSelectionBasedOnInput(l, n); p.input = l; p.sellerId = m; p = c.DynamicButton.Utilities.precomputeValues(p); var o = c.DynamicButton.Utilities.getNontextSVGComponent(p); if (!p.isTextOnButton) { document.getElementById(k).innerHTML = o + "</svg>" } else { c.DynamicButton.Utilities.createTextWrapperSVG(o, k, p) } return p }; g.exports = c.DynamicButton }, { "../core/Config": 16, "../core/Constants": 19, "../core/LPAMetricsHelper": 26, "../core/jquery": 41 }], 51: [function (d, n, g) { var o = d("../core/Utilities"); var k = d("../core/Config"); var p = d("../core/utilities/MetricsStore"); var q = d("../core/utilities/LocalStorageUtils").LocalStorageUtils; var c = d("../core/QueryString"); var m = d("../core/CORS"); var i = d("../core/DynamicConfig"); var l = d("../core/Constants").dynamic_config_keys; var f = { Metrics: {} }; var j = {}; f.Metrics.QueryLogInfoKeys = { SUB_PAGE_TYPE: "sub-page-type", PAGE_ACTION: "page-action", PAGE_TYPE_ID: "page-type-id", SELLER_ID: "merchant-id", WEBLAB_NAME: "weblab-name", WEBLAB_TREATMENT: "weblab-treatment", ADDITIONAL_REQUEST_DATA: "additional-request-data" }; f.Metrics.PageActions = { BUTTON_RENDER: "buttonrender", BUTTON_CLICK: "buttonclick" }; f.Metrics.ProductTypes = { APA: "apa", LPA: "lpa" }; f.Metrics.MetricKeys = { INFO: "info", ENTRIES: "entries" }; f.Metrics.Tags = { DYNAMIC: "dynamic" }; var b = "newCSMApplicationMetrics"; f.Metrics.Collector = function (r) { f.Metrics.Collector.prototype.constructor = f.Metrics.Collector; this.sellerId = r; this.metrics = {}; this.metrics.counters = []; this.metrics.timings = []; this.metrics.info = []; this.metrics.entries = []; this.id = (new Date()).getTime(); this.published = false }; f.Metrics.Collector.prototype.addTiming = function (t, r, u, s) { if (!o.isEmptyOrUndefined(t) && r !== null && u !== null) { this.metrics.timings.push(this.createTiming(t, r, u, s)) } }; f.Metrics.Collector.prototype.createTiming = function (u, s, v, t) { var r = {}; r.name = u; r.time = Math.ceil(v - s); r.tags = t || []; return r }; f.Metrics.Collector.prototype.addCounter = function (s, r) { if (!o.isEmptyOrUndefined(s)) { this.metrics.counters.push(this.createCounter(s, r)) } }; f.Metrics.Collector.prototype.createCounter = function (t, s) { var r = {}; r.name = t; r.tags = s || []; return r }; f.Metrics.Collector.prototype.addInfoOrEntry = function (r, t, s) { if (!o.isEmptyOrUndefined(r) && !o.isEmptyOrUndefined(t)) { if (r === f.Metrics.QueryLogInfoKeys.ADDITIONAL_REQUEST_DATA && s === f.Metrics.MetricKeys.INFO) { this.addUpdateAdditionalRequestData(t); return } this.metrics[s].push(this.createInfo(r, t)) } }; f.Metrics.Collector.prototype.addUpdateAdditionalRequestData = function (u) { var r = f.Metrics.QueryLogInfoKeys.ADDITIONAL_REQUEST_DATA; var t = this.metrics[f.Metrics.MetricKeys.INFO]; if (!o.isEmptyOrUndefined(t)) { for (var s = 0; s < t.length; s++) { if (!o.isEmptyOrUndefined(t[s]) && t[s].name === r) { t[s].value = t[s].value + u.toLowerCase(); return } } } this.metrics[f.Metrics.MetricKeys.INFO].push(this.createInfo(r, u)) }; f.Metrics.Collector.prototype.createInfo = function (r, s) { var t = {}; t.name = r; t.value = s; if (r !== f.Metrics.QueryLogInfoKeys.SELLER_ID) { t.value = t.value.toLowerCase() } return t }; function a() { return k.WIDGET_ENDPOINT + k.NEW_CSM_URL_PATH } function h(r) { for (var s = 0; s < r.info.length; s++) { var u = r.info[s].name; var t = r.info[s].value; if (u === "page-action" && (i.valueInArray(b, t))) { return true } } return false } f.Metrics.Collector.prototype.createUrl = function (r) { if (typeof (r) === "undefined") { r = this.createMetricsData() } r = c.toParam(r); return k.WIDGET_ENDPOINT + k.CSM_URL_PATH + "?" + r }; f.Metrics.Collector.prototype.canPublishToUCUI = function () { return (i.valueForKeyIsTrue(l.ENABLE_PUBLISH_METRICS_TO_UCUI) && k.ENV === "LIVE") }; f.Metrics.Collector.prototype.canPublishToNewCSMApplication = function () { return (i.valueForKeyIsTrue(l.ENABLE_PUBLISH_METRICS_TO_NEW_CSM) && k.ENV === "LIVE") }; f.Metrics.Collector.prototype.publish = function () { this.published = true; if (h(this.metrics)) { if (this.canPublishToNewCSMApplication()) { var r = this.createMetricsData(); this.publishToNewCSMApplication(r) } if (this.canPublishToUCUI()) { this.publishToUCUI() } } else { this.publishToUCUI() } }; f.Metrics.Collector.prototype.publishToUCUI = function (r) { var s = this.createUrl(r); o.jsonp({ url: s, id: this.id }) }; f.Metrics.Collector.prototype.publishToNewCSMApplication = function (r) { var s = a(); var t = m.createRequest("POST", s, true); t.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); t.setRequestHeader("Accept", "application/json"); if (t) { t.send(c.toParam(r)) } }; f.Metrics.Collector.prototype.createMetricsData = function () { var r = { sellerId: this.sellerId, data: this.toJSON() }; if (h(this.metrics)) { r.countryOfEstablishment = k.COE; r.ledgerCurrency = k.LEDGER_CURRENCY } return r }; f.Metrics.Collector.prototype.safePublish = function () { if (q.doesLocalStorageExist()) { var r = this.createMetricsData(); r.publishtoNewCSM = (h(this.metrics) && this.canPublishToNewCSMApplication()); r.publishToUCUI = (this.canPublishToUCUI()); q.insertEntry(this.id, JSON.stringify(r)) } else { this.publish() } }; f.Metrics.Collector.prototype.publishPendingMetrics = function () { var u = q.filterAndProcessMetrics(); for (var s = 0; s < u.length; s++) { var v = JSON.parse(u[s].metricsData); var r = v.publishtoNewCSM; var t = v.publishToUCUI; delete v.publishtoNewCSM; delete v.publishToUCUI; if (r) { this.publishToNewCSMApplication(v); if (t) { this.publishToUCUI(v) } } else { this.publishToUCUI(v) } } }; f.Metrics.Collector.prototype.publishAndInvokeEvent = function (z) { var v = z.param; var y = z.method; var u = this.id; var r = this.createUrl(); var t = false; if (typeof (u) !== "undefined" && u !== null && typeof (r) !== "undefined" && r !== null) { var w = document.getElementById(u); if (w === null || typeof (w) === "undefined" || w.length === 0) { var A = document.createElement("script"); A.type = "text/javascript"; A.src = r; A.async = false; o.addLoadEventHandler({ element: A, method: y, params: v }); var x = document.body; if (x !== null && typeof (x) !== "undefined") { x.appendChild(A); t = true } } } if (!t) { y(v) } }; f.Metrics.Collector.prototype.toJSON = function () { return JSON.stringify(this.metrics).replace(/"/g, "'") }; f.Metrics.Collector.prototype.addButtonInfoData = function (u, s, r, t) { this.addInfoOrEntry(f.Metrics.QueryLogInfoKeys.SUB_PAGE_TYPE, u, f.Metrics.MetricKeys.INFO); this.addInfoOrEntry(f.Metrics.QueryLogInfoKeys.PAGE_ACTION, s, f.Metrics.MetricKeys.INFO); this.addInfoOrEntry(f.Metrics.QueryLogInfoKeys.PAGE_TYPE_ID, r, f.Metrics.MetricKeys.INFO); this.addInfoOrEntry(f.Metrics.QueryLogInfoKeys.SELLER_ID, t, f.Metrics.MetricKeys.INFO) }; f.Metrics.Collector.time = function (s, r) { j[s] = { startTime: (new Date()).getTime(), tags: r || [] } }; f.Metrics.Collector.timeEnd = function (t, s) { var r = j[t]; var u; if (r !== undefined && r !== null) { u = new f.Metrics.Collector(); r.endTime = (new Date()).getTime(); r.tags = r.tags.concat(s || []); u.addTiming(t, r.startTime, r.endTime, s); u.publish(); delete j[t] } return u }; f.Metrics.Collector.collect = function (s) { var r = new f.Metrics.Collector(); r.addTiming(s.name, s.startTime, s.endTime, []); r.publish() }; p.onAdd(f.Metrics.Collector.collect); n.exports = f.Metrics }, { "../core/CORS": 11, "../core/Config": 16, "../core/Constants": 19, "../core/DynamicConfig": 20, "../core/QueryString": 31, "../core/Utilities": 35, "../core/utilities/LocalStorageUtils": 45, "../core/utilities/MetricsStore": 46 }], 52: [function (i, k, m) { var f = i("./ABTest").ABTest; var q = i("./DynamicButtons"); var w = i("../core/Utilities"); var D = i("../core/LPAMetricsHelper"); var l = i("../core/Constants"); var j = i("../core/EventTypes"); var z = i("../core/BridgeHelper"); var a = i("../core/LwaLogin"); var h = i("../core/CheckoutWidget"); var C = i("../core/HostedPayments"); var s = i("../core/ButtonCallbacks"); var p = i("../core/Config"); var B = i("../core/ZeroTime"); var t = i("../core/BrowserSupport"); var y = i("../core/DynamicConfig"); var v = i("../core/utilities/DOM"); var A = i("../core/weblab/ABTestingButton"); var g = i("../core/weblab/ConnectedAuth"); var o = i("../core/CoinMetricsHelper"); var n = "never"; var d = "donation"; if (!c || typeof (c) === "undefined") { var c = {} } c.Metrics = i("./MetricsCollector"); function r(E, G, F) { return (w.isSellerAllowed(G, F) && w.isSVGSupported() && !w.isSellerAllowedForMultiLanguage(G, F) && !w.isSellerHidingButton(E) && !C.isHostedPaymentsInput(F.type)) } function u() { try { var E = window.performance.now(); return E } catch (F) { return null } } if (!c.Widgets || typeof (c.Widgets) === "undefined") { c.Widgets = {}; c.jQuery = i("../core/jquery"); var b = i("../core/Mediator").instance; c.Button = function (M, W, R) { l.constants.CartOwnerId = W; var ac = w.getLanguageForSeller(W, R); var I = (new Date()).getTime(); var J = u(); var G = new c.Metrics.Collector(W); w.createCookie(l.constants.SELLER_LANGUAGE, ac, p.SELLER_LANGUAGE_COOKIE_HOURS); l.constants.IS_DYNAMIC_BUTTON_USED = r(M, W, R); var T = document.getElementById(M); var ab; if (typeof W === "undefined") { ab = w.buildParamNameValueMap("sellerId", "undefined") } if (!C.isHostedPaymentsInput(R.type) && typeof R.authorization !== "function") { ab = w.buildParamNameValueMap("authorization", "undefined") } if (C.isHostedPaymentsInput(R.type) && typeof R.hostedParametersProvider !== "function") { ab = w.buildParamNameValueMap("hostedParametersProvider", "undefined") } var P = function () { if (W === "A1KEVIKEL7VN1E") { return } var an = (new Date()).getTime(); var aj = u(); var ao = D.getLpaButtonType(R); var ak = l.constants.IS_DYNAMIC_BUTTON_USED ? [c.Metrics.Tags.DYNAMIC, ao] : [ao]; var ai = this.getAttribute("data-metric-tags"); var am = ai ? ai.split(",") : ["lowres"]; if (am.indexOf("highres") >= 0) { return } if (G.published) { G = new c.Metrics.Collector(W) } var ap = this.getAttribute("data-metric-name") || "lpa-button-loading"; am.push(this.getAttribute("data-abtest") === "true" ? "abtest" : "nonabtest"); if (aj && J) { G.addTiming(ap, J, aj, ak.concat(am)) } else { G.addTiming(ap, I, an, ak.concat(am)) } G.addTiming("lwa-button-clickable", B(), an, ak.concat(am)); w.addLpaButtonAttributesToMetrics(M, R, x); if (typeof (a().Login.Metrics) !== "undefined") { for (var al = 0; al < a().Login.Metrics.length; al++) { G.addCounter(a().Login.Metrics[al]) } } G.publish() }; var ah; var F = T.getElementsByTagName("img"); var L; for (var aa = 0; aa < F.length; aa++) { L = F[aa]; Q = L.getAttribute("src"); if (Q.indexOf(p.WIDGET_ENDPOINT + l.constants.BUTTON_URI) === 0 || Q.indexOf(l.constants.BUTTON_BASE_PATH) === 0 || Q.indexOf(l.constants.REBRANDED_BUTTON_IMAGE_BASE_PATH_PREFIX) === 0) { ah = L; ah.className += " " + l.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS; break } } var Z = l.constants.WIDGETID_PREFIX + b.generateUniqWidgetID(); if (typeof ah === "undefined") { var Q = w.getLWAButtonPath(R, ac, C.isHostedDonation(R.type)); if (y.valueForKeyIsTrue(l.dynamic_config_keys.ENABLE_REBRANDING_BUTTON) && !f.Utilities.isSellerInRebrandingBlacklist(W)) { var X = w.getRebrandedButtonPath(R, null, W); if (X !== null) { Q = X } } var V = w.getMeasureLatencyFlag(); if (V) { Q = w.overrideUsingCloudFrontImage(Q, W, R) } if (l.constants.IS_DYNAMIC_BUTTON_USED) { var K = document.createElement("img"); K.setAttribute("style", "height: 1px; width: 1px; display:none;"); K.onclick = function () { E(); if (C.isHostedPaymentsInput(R.type)) { S() } else { U(K) } }; T.appendChild(K); ah = document.createElement("div"); ah.setAttribute("style", "cursor:pointer; display: inline-block;"); ah.setAttribute("alt", "AmazonPay"); v.bindEvent("load", ah, P); T.appendChild(ah); var O = w.getLanguageCountryForSeller(W, R); q.Utilities.createDynamicButton(R, O, M, W); var H = new c.Metrics.Collector(W); H.addCounter("lpa-buttonrender-metric", ["svgbutton"]); H.publish() } else { ah = document.createElement("img"); ah.className += " " + l.constants.AMAZON_CREATED_BUTTON_IMAGE_CSS_CLASS; var af = q.Utilities.getButtonSize(R.type, R.size); var ag = af[1]; ah.setAttribute("style", "cursor:pointer; max-height:" + ag + "px;"); ah.setAttribute("alt", "AmazonPay"); var ae = Q.replace(/\.svg/, ".png").replace(/svg/, w.getValueBasedOnInput(l.constants.BUTTON_LWA_SIZE_SET, R.size, l.constants.BUTTON_DEFAULT_SIZE_LWA)); ah.id = Z; A.performButtonWeblab(T, ah, R, W, ae, G); g.createConnectedAuthCookie(W); v.bindEvent("load", ah, P); T.appendChild(ah) } } ah.id = Z; ah.onErrorCallback = R.onError; ah.getID = function () { return this.id }; b.register(ah); c.Button.bindOnError(ah); var N; var Y; if (typeof ab !== "undefined") { N = l.constants.INVALID_PARAMETER_VALUE; Y = w.formatMsg(l.constants.INVALID_PARAMETER_VALUE_MSG, ab); w.sendOnErrorCallbackMessage(N, Y, Z) } var ad = function (al) { var ak = al.data; c.jQuery(ak).unbind(j.EXPRESS_CHK_ONAUTHORIZE, ak.onSignInEventHandler); var aj = ak.eventValue; var am = {}; var ai = function () { var ao = function () { return aj }; var an = R.agreementType === "BillingAgreement" ? "getAmazonBillingAgreementId" : "getAmazonOrderReferenceId"; am[an] = ao; am.getAmazonContractId = ao; return am }(); R.onSignIn(ai) }; var E = function () { var al = new c.Metrics.Collector(W); al.addButtonInfoData(c.Metrics.ProductTypes.LPA, c.Metrics.PageActions.BUTTON_CLICK, R.type, W); var ak = D.getLpaButtonType(R); var aj = l.constants.IS_DYNAMIC_BUTTON_USED ? [c.Metrics.Tags.DYNAMIC, ak] : [ak]; al.addCounter("lpa-buttonclick", aj); al.addInfoOrEntry(c.Metrics.QueryLogInfoKeys.ADDITIONAL_REQUEST_DATA, "|language:" + ac, c.Metrics.MetricKeys.INFO); w.addLpaButtonAttributesToMetrics(M, R, al); for (var ai = 0; ai < s.before_publish_click_metric_callbacks.length; ai++) { s.before_publish_click_metric_callbacks[ai].call(null, al, M) } al.safePublish(); D.publishButtonMetricsForNewWidgets(W, "lpa-buttonclick", true); D.publishButtonMetricsForNewWidgets(W, "lpa-buttonclick", false); D.publishButtonMetricsForLoginConsentABTest(W, "lpa-buttonclick", true); D.publishButtonMetricsForLoginConsentABTest(W, "lpa-buttonclick", false); o.publish(W, "buttonclick") }; var S = function () { var ai = l.constants.HOSTED_INTERFACE_TYPE_KEY; var aj = l.constants.HOSTED_EXPERIENCE_TYPE_KEY; l.constants.HOSTED_PAYMENTS_WIDGET_ID = Z; R.hostedParametersProvider(function (ak) { ak[aj] = C.inputTypeToExperienceTypeMap[R.type]; if (ak[ai] !== l.constants.HOSTED_HTML_INTERFACE) { ak[ai] = l.constants.HOSTED_JAVASCRIPT_INTERFACE } C.done(ak) }) }; var U = function (ai) { w.setLanguage(W, R); w.setLwaSandboxMode(); w.setLoginDomain(W); w.setWebflowParams(p.COE, p.LEDGER_CURRENCY, p.ENV); R.authorization(); if (typeof R.onSignIn === "function") { if (typeof R.useAmazonAddressBook === "undefined") { R.useAmazonAddressBook = true } c.jQuery(ai).bind(j.EXPRESS_CHK_ONAUTHORIZE, ai, ad); a().Login.authorize({ scope: "payments:widget", interactive: n }, function (aj) { var ak; if (aj.error) { } else { ak = { action: "connect-lwa", access_token: aj.access_token, cartOwnerId: W, clientId: w.getClientId(), referringUrl: window.location, useAmazonAddressBook: R.useAmazonAddressBook, coe: p.COE, env: p.ENV, ledgerCurrency: p.LEDGER_CURRENCY }; ak = w.Timezone.appendTimezoneDetails(ak); if (typeof R.language !== "undefined" && R.language.toLowerCase() in l.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP) { ak.language = l.constants.BUTTON_LWA_LANGUAGE_TO_REALM_MAP[R.language.toLowerCase()] } if (!w.isEmptyOrUndefined(R.agreementType)) { ak.agreementType = R.agreementType } w.performContractAction(ak, M) } }) } }; if (!l.constants.IS_DYNAMIC_BUTTON_USED) { D.publishMetricsForLPAButton(R, M, W, false, G) } ah.onclick = function () { z.createBridgeIfNotExist(); var ai = C.isHostedPaymentsInput(R.type); if (!t.isSupportedBrowser()) { t.notSupportedBrowserHandler(W, w.getLanguageCountryForSeller(W, R).toLowerCase())() } else { E(); if (ai) { S() } else { U(ah) } } }; if (R.type && ["login", "lwa"].indexOf(R.type.toLowerCase()) < 0) { setTimeout(function () { i("../core/ButtonStatus")(W, T, ah, w.getLanguageCountryForSeller(W, R).toLowerCase()) }, 0) } D.queueOrPublishMetrics(W, "lpa-buttonrender-metric"); o.publish(W, "buttonrender") }; c.Button.after_callbacks = []; c.Button.before_callbacks = []; c.Button.bindOnError = function (F) { var E = function (G) { if (typeof F.onErrorCallback !== "undefined") { F.onErrorCallback(G.data.error) } }; c.jQuery(F).bind(j.ON_ERROR, F, E) }; c.Widgets.Button = function (E) { this.BUTTON_START_TIME = (new Date()).getTime(); for (var F = 0; F < s.APA_before_callbacks.length; F++) { s.APA_before_callbacks[F].call(null, this) } h.call(this, E); if (!f.Utilities.isSellerInABTest(w.getCartOwnerId(), f.Tests.Default) && w.isCookiePresent(f.Tests.Default.cookieName)) { w.eraseCookie(f.Tests.Default.cookieName) } var G; this.useAmazonAddressBook = l.constants.DEFAULT_ADDRESSBOOK_PREF; this.hasError = false; this.onSignIn = E.onSignIn; this.onOpen = E.onOpen; this.onErrorCallback = E.onError; this.authorizationToken = E.authorizationToken; this.agreementType = (!w.isEmptyOrUndefined(E.agreementType)) ? E.agreementType : ""; this.type = l.others.WidgetTypes.Button; this.buttonType = l.others.ButtonTypes.BIG_FISH_CHECKOUT; this.getContractId = function () { return G }; this.setContractId = function (H) { G = H }; this.validateAndSetUseAmazonAddressBookField = function (H) { if (H !== undefined) { if (typeof H === "boolean") { this.useAmazonAddressBook = H } else { w.sendOnErrorCallbackMessage(l.constants.INVALID_PARAMETER_VALUE, l.constants.INVALID_VALUE_FOR_USE_AMAZON_ADDRESSBOOK, this.getID()); this.hasError = true } } }; this.setButtonType = function () { if (!w.isEmptyOrUndefined(E.buttonType)) { if (d === E.buttonType.toLowerCase()) { this.buttonType = l.others.ButtonTypes.DONATION } } }; this.validateSellerId = function (H) { if (w.isEmptyOrUndefined(H)) { w.sendOnErrorCallbackMessage(l.constants.MISSING_PARAMETER, l.constants.MISSING_SELLERID, this.getID()); this.hasError = true } }; c.jQuery(this).bind(j.ON_ERROR, this, h.prototype.onErrorCallbackHandler); this.getAmazonOrderReferenceId = this.getContractId; this.getAmazonBillingAgreementId = this.getContractId; this.validateAndSetUseAmazonAddressBookField(E.useAmazonAddressBook); this.validateSellerId(E.sellerId); this.setButtonType() }; c.Widgets.Button.prototype = w.createSubclass(h.prototype); c.Widgets.Button.prototype.constructor = c.Widgets.Button; c.Widgets.Button.prototype.shouldSkipPopup = function () { return (this.contractId && this.authorizationToken) }; c.Widgets.Button.prototype.onClickHandler = function (F) { z.createBridgeIfNotExist(); var E = F.data.getSellerId(); var G = new c.Metrics.Collector(E); G.addButtonInfoData(c.Metrics.ProductTypes.APA, c.Metrics.PageActions.BUTTON_CLICK, F.data.buttonType, E); G.addCounter("apa-buttonclick"); w.addApaButtonAttributesToMetrics(F.data.buttonSettings, G); G.publish(); if (F.data.shouldSkipPopup()) { if (typeof (F.data.onOpen) === "function") { F.data.onOpen(F.data) } else { F.data.submit() } } else { F.data.isMobile = false; F.data.showCashbackTermsAndConditions = false; h.prototype.onClickHandler.call(this, F) } }; c.Widgets.Button.prototype.delayedEventHandler = function (E, F) { if (F !== null && F !== undefined) { if (typeof (F.closed) === "undefined" || F.closed === true) { E.onSignIn(E) } else { setTimeout(function () { c.Widgets.Button.prototype.delayedEventHandler(E, F) }, l.constants.TIMER_INTERVAL) } } }; c.Widgets.Button.prototype.onSignInEventHandler = function (F) { var E = F.data; if (!E.shouldSkipPopup()) { E.setContractId(E.eventValue) } if (typeof (E.onSignIn) === "function") { if (w.shouldInvokeSetTimeoutOnSigninForUserAgent(navigator.userAgent)) { setTimeout(function () { c.Widgets.Button.prototype.delayedEventHandler(E, F.data.popupWindow) }, l.constants.TIMER_INTERVAL) } else { var G = new c.Metrics.Collector(E.getSellerId()); G.addCounter("onSignInTriggered-" + E.eventValue); G.publishAndInvokeEvent({ method: E.onSignIn, param: E }) } } c.jQuery(E).unbind(j.EXPRESS_CHK_ONAUTHORIZE, E.onSignInEventHandler) }; c.Widgets.Button.prototype.submit = function () { c.jQuery(this).bind(j.EXPRESS_CHK_ONAUTHORIZE, this, this.onSignInEventHandler); if (this.shouldSkipPopup()) { c.jQuery(this).trigger(j.EXPRESS_CHK_ONAUTHORIZE) } else { this.popupForm() } }; c.Widgets.Button.prototype.popupForm = function () { var H = this.getPopupWindowName(); var J = this.getID() + "Form"; var I = window.top.location; var E = p.WIDGET_ENDPOINT + p.APA_LOGIN_FORM_URL_PATH; var F = { action: "connect", referringURL: I, cartOwnerId: this.getSellerId(), useAmazonAddressBook: this.useAmazonAddressBook, agreementType: this.agreementType }; if (this.getContractId() !== undefined) { F.contractId = this.getContractId() } var G = w.createFormString(J, E, H, F); c.jQuery("#" + J).remove(); c.jQuery("#" + this.getLocation()).append(G); c.jQuery("#" + J).submit() }; if (typeof (window.postMessage) !== "undefined") { if (window.addEventListener) { window.addEventListener("message", w.handleMessage, false) } else { if (window.attachEvent) { window.attachEvent("onmessage", w.handleMessage) } } } c.jQuery(document).ready(function () { z.setup(); window.setTimeout(w.pollTaskQueue, l.constants.TIMER_INTERVAL); if (l.config.POLL_FOR_EVENTS && w.isValidDocInclusion()) { setInterval(w.pollEvents, l.constants.TIMER_INTERVAL) } }); var x = new c.Metrics.Collector(); x.publishPendingMetrics() } k.exports = { Widgets: c.Widgets, Button: c.Button, isDynamicButtonUsed: r } }, { "../core/BridgeHelper": 6, "../core/BrowserSupport": 7, "../core/ButtonCallbacks": 8, "../core/ButtonStatus": 10, "../core/CheckoutWidget": 14, "../core/CoinMetricsHelper": 15, "../core/Config": 16, "../core/Constants": 19, "../core/DynamicConfig": 20, "../core/EventTypes": 21, "../core/HostedPayments": 23, "../core/LPAMetricsHelper": 26, "../core/LwaLogin": 27, "../core/Mediator": 28, "../core/Utilities": 35, "../core/ZeroTime": 40, "../core/jquery": 41, "../core/utilities/DOM": 44, "../core/weblab/ABTestingButton": 47, "../core/weblab/ConnectedAuth": 48, "./ABTest": 49, "./DynamicButtons": 50, "./MetricsCollector": 51 }] }, {}, [1]);
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap = {}; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-seller-id"] = "sellerId"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-access-key"] = "accessKey"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-lwa-client-id"] = "lwaClientId"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-return-url"] = "returnURL"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-cancel-return-url"] = "cancelReturnURL"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-amount"] = "amount"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-currency-code"] = "currencyCode"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-note"] = "sellerNote"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-scope"] = "scope"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-signature"] = "signature"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-shipping-address-required"] = "shippingAddressRequired"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-payment-action"] = "paymentAction"; OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap["data-ap-seller-order-id"] = "sellerOrderId"; OffAmazonPayments.HostedPayments.DonationsParameterProviderFunction = function (c, b, a) { var d = {}; d.interfaceType = OffAmazonPayments.Widgets.Constants.HOSTED_HTML_INTERFACE; c.each(OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap, function (e, f) { if (b.attr(e)) { d[OffAmazonPayments.HostedPayments.htmlAttrToJsParamMap[e]] = b.attr(e) } }); a(d) }; OffAmazonPayments.HostedPayments.LoadButtonInEl = function (e, c, b) { if (b === undefined) { b = c } var d = c.attr("id"); var a = { expressPaymentButton: "hostedPayment", expressDonationButton: "hostedDonation", expressDonationWidget: "hostedDonation" }; OffAmazonPayments.Button(d, b.attr("data-ap-seller-id"), { type: a[b.attr("data-ap-widget-type")], hostedParametersProvider: function (f) { OffAmazonPayments.HostedPayments.DonationsParameterProviderFunction(e, b, f) }, onError: function (f) { console.debug(f.getErrorCode() + f.getErrorMessage()) } }) }; OffAmazonPayments.HostedPayments.HtmlButtonLoader = function (a) { a("div[data-ap-widget-type=expressPaymentButton],div[data-ap-widget-type=expressDonationButton]").each(function () { var b = a(this); if (b.attr("id") === "" || b.attr("id") === undefined || b.attr("id") === null) { b.attr("id", "ap-button-" + Math.floor((Math.random() * 1000000000) + 1).toString()) } OffAmazonPayments.HostedPayments.LoadButtonInEl(a, b) }) };
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

if (typeof OffAmazonPayments === "undefined") { OffAmazonPayments = {} } if (typeof OffAmazonPayments.HostedPayments === "undefined") { OffAmazonPayments.HostedPayments = {} } OffAmazonPayments.HostedPayments.Donations = function (e) { var f = "amazonpay-donation-css"; var d = "https://images-na.ssl-images-amazon.com/images/G/01/EP/offAmazonPayments/common/us/prod/css/donations.css"; var c = "div[data-ap-widget-type='expressDonationWidget']"; function b(h) { if (document.getElementById(f)) { h() } var g = document.createElement("link"); g.setAttribute("rel", "stylesheet"); g.setAttribute("type", "text/css"); g.setAttribute("href", d); g.setAttribute("id", f); document.getElementsByTagName("head")[0].appendChild(g); h() } function a() { var g = e(c); if (g && g.length > 0) { b(function () { g.each(function () { new OffAmazonPayments.HostedPayments.Donations.widget(e(this), e) }) }) } } a(); return { cssFileName: d, widgetSelector: c } };
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

if (typeof OffAmazonPayments === "undefined") { OffAmazonPayments = {} } if (typeof OffAmazonPayments.HostedPayments === "undefined") { OffAmazonPayments.HostedPayments = {} } if (typeof OffAmazonPayments.HostedPayments.Donations === "undefined") { OffAmazonPayments.HostedPayments.Donations = {} } OffAmazonPayments.HostedPayments.Donations.widget = function (N, A) { var L, p, G, M, E = N, f, c, s, i, r, h, d = { "ap-light": true, "ap-dark": true }; function J() { l(); g(); a(); w(); m(); y() } function y() { if (L.preSelectedAmountsList) { h = A(".ap-dw-selected", E); p = t(h.html()) } else { h = A(i, E); p = t(h.val()) } G = false; k(); q() } function H(O) { O = parseInt(O); if (isNaN(O) || O < 0 || O > 3) { return 1 } return O } function m() { if (c) { c.find(".ap-dw-list-item-link").click(n) } i.blur(C); i.focus(v) } function k() { i.val(B(p)) } function u(O) { if (O) { h.removeClass("ap-dw-selected"); h = O } h.addClass("ap-dw-selected"); p = t(h.html()); r.removeClass("ap-dw-selected ap-dw-value-set"); K(); k(); q() } function I(O) { s.addClass("ap-dw-error-active").html(O); r.addClass("ap-dw-error-active"); f.addClass("ap-dw-error-active"); G = true } function K() { s.removeClass("ap-dw-error-active"); r.removeClass("ap-dw-error-active"); f.removeClass("ap-dw-error-active"); G = false } function q() { E.attr("data-ap-amount", p) } function D() { return p } function t(O) { O = Number(O.replace(/[\$,]/g, "")); return (Math.round(O * 100) / 100) } function n(O) { if (h.hasClass("ap-dw-selected") && h.get(0) === O.currentTarget) { return } u(A(O.currentTarget)) } function v() { if (i.val() === L.strings.defaultInputAmount || G) { i.val("$") } r.addClass("ap-dw-selected"); h.removeClass("ap-dw-selected") } function C() { if (e()) { p = t(i.val()); i.val(B(p)); r.addClass("ap-dw-value-set"); q() } } function o(O) { if (G) { O.preventDefault(); O.stopPropagation(); return false } M(O); return true } function B(O) { if (typeof O !== "string") { O = O.toString() } O = O.replace(/[,\$]/g, ""); O = "$" + O.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,"); return O } function w() { var O = A("img", f); M = O.get(0).onclick; O.get(0).onclick = null; O.bind("click", o) } function j(O) { if (isNaN(O) || O < 0) { I(L.errors.invalid); return false } else { if (O < L.minValue) { I(L.errors.minValue); return false } else { if (O > L.maxValue) { I(L.errors.maxValue); return false } } } K(); return true } function e() { var O = t(i.val()); if (i.val() === "") { i.val(L.strings.defaultInputAmount); return true } return j(O) } function a() { OffAmazonPayments.HostedPayments.LoadButtonInEl(A, f, E) } function l() { var P = E.attr("data-ap-widget-amount-presets"), O = E.attr("data-ap-widget-default-amount"), Q = E.attr("data-ap-widget-theme"); L = { minValue: 5, maxValue: 150000, cssTheme: (Q && d[Q]) ? Q : "ap-light", strings: { defaultInputAmount: "$0", defaultAmountOther: "other", donate: "Donate", otherOptions: "Other Options" }, errors: { minValue: "The amount you entered is less than the minimum value", maxValue: "The amount you entered is more than the maximum amount", invalid: "You entered an invalid amount" } }; if (P) { L.preSelectedAmount = H(O); L.preSelectedAmountsList = P.split(",") } else { if (O === L.strings.defaultAmountOther) { L.preSelectedAmount = O } } } function g() { var S = E.get(0), R = document.createElement("div"), Q = document.createElement("span"), P = document.createElement("div"), O; S.className = "ap-dw-container " + L.cssTheme; R.className = "ap-dw-main"; Q.className = "ap-dw-error"; P.className = "ap-dw-button"; P.id = "ap-button-" + Math.floor((Math.random() * 1000000000) + 1).toString(); if (L.preSelectedAmountsList) { O = F(R); b(O); z(O); R.appendChild(O) } else { x(R, true) } R.appendChild(Q); s = A(Q); R.appendChild(P); f = A(P); S.appendChild(R) } function F(Q) { var O = document.createElement("h3"), P = document.createElement("div"); O.className = "ap-dw-main-heading"; O.innerHTML = L.strings.donate; Q.appendChild(O); P.className = "ap-dw-content-container ap-dw-cf"; return P } function b(S) { var R = document.createElement("ul"), O, P; R.className = "ap-dw-list ap-dw-cf"; for (var Q = 0; Q < 4; Q++) { O = document.createElement("li"); P = document.createElement("a"); O.className = "ap-dw-list-item"; if (Q === L.preSelectedAmount) { P.className = "ap-dw-list-item-link ap-dw-selected" } else { P.className = "ap-dw-list-item-link" } P.innerHTML = "$" + L.preSelectedAmountsList[Q]; O.appendChild(P); R.appendChild(O) } S.appendChild(R); c = A(R) } function z(R) { var S = document.createElement("div"), Q = document.createElement("div"), P = document.createElement("div"), O = document.createElement("h4"); S.className = "ap-dw-optional ap-dw-cf"; Q.className = "ap-dw-optional-container"; P.className = "ap-dw-optional-container"; O.className = "ap-dw-optional-heading"; O.innerHTML = L.strings.otherOptions; x(P, false); Q.appendChild(O); S.appendChild(Q); S.appendChild(P); R.appendChild(S) } function x(R, Q) { var P = document.createElement("div"), O = document.createElement("input"); Q = Q ? " ap-dw-input-only ap-dw-selected" : ""; P.className = "ap-dw-optional-input-container" + Q; O.className = "ap-dw-optional-input"; O.type = "text"; O.value = L.strings.defaultInputAmount; P.appendChild(O); R.appendChild(P); r = A(P); i = A(O) } J(); return { applyInputFormatRules: B, getAmount: D, getNumberValue: t, handleButtonClick: o } };
/**
* Version: _V1536691827_
* Copyright 2011 Amazon.com, Inc., or its Affiliates.
**/

var LOGIN_STATE = { LOADED: "loaded", COMPLETE: "complete" }; if (typeof OffAmazonPayments === "undefined") { OffAmazonPayments = {} } if (OffAmazonPayments.HostedPayments === undefined) { OffAmazonPayments.HostedPayments = {} } OffAmazonPayments.Loader.LOGINJS_NAME = "OffAmazonPaymentsLoginJS"; OffAmazonPayments.Loader.CanLoadChildScriptsAsynchronously = function () { if (document.currentScript) { return document.currentScript.async } return a(); function b(c) { var d = c.getAttribute("src"); return (d !== null && d.indexOf("OffAmazonPayments") !== -1 && d.indexOf("Widgets.js") !== -1) } function a() { var c = document.getElementsByTagName("script"); var e; var d; var f; for (d = 0; d < c.length; d++) { e = c[d]; if (b(e)) { f = e.getAttribute("async"); return f !== null && f !== undefined && f !== false } } return false } }; OffAmazonPayments.Loader.AddLwaScriptIfMissingAndPerformCallback = function (e, d, c, g) { var b = f(c); var a = f(g); if (typeof d !== "undefined" && d.Login !== undefined) { OffAmazonPayments.Loader.SetScriptLoadMetrics(); b(); e(document).ready(a) } else { OffAmazonPayments.Loader.ReplaceLoginReadyCallback(); OffAmazonPayments.Loader.LoadLoginJS(e, b, a) } function f(h) { var i; return function () { if (h && h.length > 0) { for (var j = 0; j < h.length; j++) { i = h[j]; if (typeof i === "function") { i(e) } } } } } }; OffAmazonPayments.Loader.SetScriptLoadMetrics = function () { OffAmazonPayments.WIDGET_CORE_EXECUTION_END_TIME = (new Date()).getTime() }; OffAmazonPayments.Loader.ReplaceLoginReadyCallback = function () { var a = window.onAmazonLoginReady || function () { }; window.onAmazonLoginReady = function () { OffAmazonPayments.Loader.SetScriptLoadMetrics(); a() } }; OffAmazonPayments.Loader.LoadLoginJS = function (g, k, h) { if (!OffAmazonPayments.Loader.loginJsUrl()) { d(); return } var c = window.__apay_bundled_loginjs; if (typeof c === "function") { if (OffAmazonPayments.Loader.CanLoadChildScriptsAsynchronously()) { setTimeout(function () { c(); d() }, 0) } else { c(); d() } return } if (OffAmazonPayments.Loader.CanLoadChildScriptsAsynchronously()) { a() } else { try { document.write("<script type='text/javascript' src='" + OffAmazonPayments.Loader.loginJsUrl() + "' id= '" + OffAmazonPayments.Loader.LOGINJS_NAME + "'><\/script>") } catch (i) { var j = new OffAmazonPayments.Metrics.Collector(); j.addCounter("chrome-browser-cross-origin-script-block"); j.publish() } var b = document.getElementById(OffAmazonPayments.Loader.LOGINJS_NAME); if (b) { f(b, d) } else { a() } } function d() { k(); g(document).ready(h) } function f(e, l) { if (e.readyState) { e.onreadystatechange = function () { if (e.readyState === LOGIN_STATE.LOADED || e.readyState === LOGIN_STATE.COMPLETE) { l() } } } else { e.onload = l } } function a() { var e = document.createElement("script"); e.setAttribute("src", OffAmazonPayments.Loader.loginJsUrl()); f(e, d); document.getElementsByTagName("script")[0].parentNode.appendChild(e) } }; OffAmazonPayments.Loader.WrappedInUserErrorMetrics = function (a) { return function () { try { a() } catch (c) { var b = new OffAmazonPayments.Metrics.Collector(); b.addCounter("js-user-error", window.location.host); b.publish(); throw c } } }; OffAmazonPayments.DynamicConfig = {
    "rebrandingMerchantBlackList": ["A1LUP9T9ADZJTX", "A2QF570IEOEZL4", "A1NP6GS0UOGPC5", "A2XQ64JWDMR8FN", "A3IWUTOTQMSZYA", "A31F7GFAOMRQJZ", "AE7CKJHBFKJ4G", "A1Q369M2C7ILUR", "ALQZB4PI0YCVW", "A1JAOSGACL7V1G", "AUDJ2SVBGV53F", "A27K2SMVAN0TJ9", "A175LKWYQ1WBIB", "A1218JTXPK1FDN", "A3IW95BME9LBP0", "A2641W6IJ9WIK7", "A3AV9JKRW5J0K", "AJHX273HXBPMZ", "A1AHMSQ5FMXMZ7", "A25ONLSFRR6XYS", "A2FQQKG3CEY2ZW", "A3X9FZ21LLIWX", "A2TR52CLDGPEGK", "A140IDPMFIKDRV", "A25IMQNBV4DDWX", "A3TJ28DDZ2EIMA", "A2LFGGIK3BYQKR", "A1BM4DYZ9G3UHR", "A2ZQ2XSI9KJ373", "AD7S3RZ40K7BL", "A109XUG209E1SR", "A130Y5AF6Z7KAK", "A13JGR0DTTEDV1", "A1NGKO3BKQ6B6P", "A1SZT82RBRDU5P", "A1X70XMSJQOUIF", "A24TQFDAVMWH10", "A273N2L4YG88HY", "A2AFBKAH5YQYG4", "A2CT8SVRB9WXL1", "A2F4YRU4SELH9", "A2NZE4UHGV8S7W", "A2Q3QSPE2HOG4T", "A2ZZZWWR5QQD3V", "A38GKEMPD30549", "A39KYKHKR6MA05", "A39V1VMT78QSH7", "A3EX1KZ6EDBQNX", "A4ES1HE89DCB", "A4U8QO4UBSRDW", "AHO3AJUTRCU1T", "AIOVQ9IKNMTSG", "AJSCF15KSKNAG", "AS0HR1AXA0P2K", "AW0ZJDK3ARB0N", "AXN8FH7STRIFO", "A30FVL0735QRBJ", "A35EOB5ZMYRXSI", "A2BFDVYNBQ89Q", "A2TPIY28J6VK2X"],
    "enableAccountStatusChecking": true,
    "newWidgetsABTestingEnabled": true,
    "abtestingNewWidgetsForAll": true,
    "useStaticBridge": true,
    "staticBridgeHost": "static-na.payments-amazon.com",
    "weblabOverrides": {
        "LWA_LOGIN_CONSENT_CUSTOMIZATION": "C",
        "LWA_AUI_MIGRATION": "C"
    },
    "alwaysShowNewWidgetsForMerchants": ["A2G0C0T3SES3S2", "AWI4K9L2YJ20C"],
    "alwaysShowOldWidgetsForMerchants": ["A3A0774067UYF7", "A13GBIVO2FMSLL"],
    "useStaticBridgeNewWidgets": false,
    "staticBridgeHostNewWidgets": "static-na.payments-amazon.com",
    "serveButtonsFromCloudFront": true,
    "enableButtonABTesting": false,
    "enableABTestV2": false,
    "highResButtonImageUseSrcset": true,
    "enableCheckCoinStatus": true,
    "enablePublishingMetricsToUCUI": true,
    "enablePublishingMetricsToNewCSM": false,
    "newCSMApplicationMetrics": ["buttonclick", "buttonrender"]
}
    ; (function (c) { var e; if (typeof amazon !== "undefined") { e = amazon } var b = OffAmazonPayments.Loader.WrappedInUserErrorMetrics; var f = b(window.onAmazonPaymentsReady || function () { }); var d = b(window.AmazonPaymentReady || function () { }); b(function () { if (typeof window._saved_onAmazonLoginReady === "function") { if (typeof window.amazon !== "undefined" && typeof window.amazon.Login !== "undefined") { window._saved_onAmazonLoginReady() } window.onAmazonLoginReady = window._saved_onAmazonLoginReady; delete window._saved_onAmazonLoginReady } })(); var a = [f, d]; var g = [OffAmazonPayments.HostedPayments.HtmlButtonLoader, OffAmazonPayments.HostedPayments.Donations]; OffAmazonPayments.Loader.AddLwaScriptIfMissingAndPerformCallback(c, e, a, g) }(OffAmazonPayments.jQuery));
